import{_ as s,c as n,o as a,a as l}from"./app.a1d4ca27.js";const p="/assets/1.66a96192.png",o="/assets/2.0d5062be.png",e="/assets/3.ffc3f7f2.png",d=JSON.parse('{"title":"React18+\u65B0\u7279\u6027","description":"","frontmatter":{"outline":"deep"},"headers":[{"level":2,"title":"\u7EDF\u8BA1react18+ \u7528\u6CD5","slug":"\u7EDF\u8BA1react18-\u7528\u6CD5","link":"#\u7EDF\u8BA1react18-\u7528\u6CD5","children":[]},{"level":2,"title":"1\u3001setState\u81EA\u52A8\u6279\u5904\u7406","slug":"_1\u3001setstate\u81EA\u52A8\u6279\u5904\u7406","link":"#_1\u3001setstate\u81EA\u52A8\u6279\u5904\u7406","children":[]},{"level":2,"title":"2\u3001\u6B63\u5F0F\u652F\u6301Concurrent","slug":"_2\u3001\u6B63\u5F0F\u652F\u6301concurrent","link":"#_2\u3001\u6B63\u5F0F\u652F\u6301concurrent","children":[]},{"level":2,"title":"3\u3001createRoot \u53D6\u4EE3\u4EE5\u524D\u7684 ReactDOM.render","slug":"_3\u3001createroot-\u53D6\u4EE3\u4EE5\u524D\u7684-reactdom-render","link":"#_3\u3001createroot-\u53D6\u4EE3\u4EE5\u524D\u7684-reactdom-render","children":[]},{"level":2,"title":"4\u3001ssr \u4E2D\u7684 ReactDOM.hydrate \u4E5F\u6362\u6210\u4E86\u65B0\u7684 hydrateRoot","slug":"_4\u3001ssr-\u4E2D\u7684-reactdom-hydrate-\u4E5F\u6362\u6210\u4E86\u65B0\u7684-hydrateroot","link":"#_4\u3001ssr-\u4E2D\u7684-reactdom-hydrate-\u4E5F\u6362\u6210\u4E86\u65B0\u7684-hydrateroot","children":[]},{"level":2,"title":"5\u3001Suspense","slug":"_5\u3001suspense","link":"#_5\u3001suspense","children":[]},{"level":2,"title":"6\u3001SuspenseList","slug":"_6\u3001suspenselist","link":"#_6\u3001suspenselist","children":[]},{"level":2,"title":"7\u3001transition","slug":"_7\u3001transition","link":"#_7\u3001transition","children":[]},{"level":2,"title":"8\u3001\u65B0\u7684Hooks","slug":"_8\u3001\u65B0\u7684hooks","link":"#_8\u3001\u65B0\u7684hooks","children":[]}],"relativePath":"Framework/React/React18+\u65B0\u7279\u6027.md"}'),t={name:"Framework/React/React18+\u65B0\u7279\u6027.md"},c=l('<h1 id="react18-\u65B0\u7279\u6027" tabindex="-1">React18+\u65B0\u7279\u6027 <a class="header-anchor" href="#react18-\u65B0\u7279\u6027" aria-hidden="true">#</a></h1><p><a href="https://juejin.cn/post/7182382408807743548" target="_blank" rel="noreferrer">\u8BE6\u7EC6\u65B0\u7279\u6027\u53C2\u8003</a></p><h2 id="\u7EDF\u8BA1react18-\u7528\u6CD5" tabindex="-1">\u7EDF\u8BA1react18+ \u7528\u6CD5 <a class="header-anchor" href="#\u7EDF\u8BA1react18-\u7528\u6CD5" aria-hidden="true">#</a></h2><ul><li>15\u4E2A hook\uFF08<code>useMemo</code>|<code>useCallback</code>\u3001<code>useReducer</code>|<code>useState</code>\u3001<code>useRef</code>\u3001<code>useEffect</code>\u3001<code>useContext</code>\u3001<code>useTransition</code>|<code>useDeferredValue</code>\u3001<code>useDebugValue</code>\u3001<code>useId</code>\u3001<code>useImperativeHandle</code>\u3001<code>useInsertionEffect</code>\u3001<code>useLayoutEffect</code>\u3001<code>useSyncExternalStore</code>\uFF09</li><li>4\u4E2A component\uFF08<code>&lt;Fragment&gt;</code>\u3001<code>&lt;Profiler&gt;</code>\u3001<code>&lt;StrictMode&gt;</code>\u3001<code>&lt;Suspense&gt;</code>\uFF09</li><li>5\u4E2A API\uFF08<code>createContext(defaultValue)</code>\u3001<code>forwardRef(render)</code>\u3001<code>lazy(load)</code>\u3001<code>memo(SomeComponent, arePropsEqual?)</code>\u3001<code>startTransition(scope)</code>\uFF09</li></ul><h2 id="_1\u3001setstate\u81EA\u52A8\u6279\u5904\u7406" tabindex="-1">1\u3001setState\u81EA\u52A8\u6279\u5904\u7406 <a class="header-anchor" href="#_1\u3001setstate\u81EA\u52A8\u6279\u5904\u7406" aria-hidden="true">#</a></h2><p>\u5728react17\u4E2D\uFF0C\u53EA\u6709react\u4E8B\u4EF6\u4F1A\u8FDB\u884C\u6279\u5904\u7406\uFF0C\u539F\u751Fjs\u4E8B\u4EF6\u3001promise\uFF0CsetTimeout\u3001setInterval\u4E0D\u4F1A</p><p>react18\uFF0C\u5C06\u6240\u6709\u4E8B\u4EF6\u90FD\u8FDB\u884C\u6279\u5904\u7406\uFF0C\u5373\u591A\u6B21setState\u4F1A\u88AB\u5408\u5E76\u4E3A1\u6B21\u6267\u884C\uFF0C\u63D0\u9AD8\u4E86\u6027\u80FD\uFF0C\u5728\u6570\u636E\u5C42\uFF0C\u5C06\u591A\u4E2A\u72B6\u6001\u66F4\u65B0\u5408\u5E76\u6210\u4E00\u6B21\u5904\u7406\uFF08\u5728\u89C6\u56FE\u5C42\uFF0C\u5C06\u591A\u6B21\u6E32\u67D3\u5408\u5E76\u6210\u4E00\u6B21\u6E32\u67D3\uFF09</p><h2 id="_2\u3001\u6B63\u5F0F\u652F\u6301concurrent" tabindex="-1">2\u3001\u6B63\u5F0F\u652F\u6301Concurrent <a class="header-anchor" href="#_2\u3001\u6B63\u5F0F\u652F\u6301concurrent" aria-hidden="true">#</a></h2><p>Concurrent\u6700\u4E3B\u8981\u7684\u7279\u70B9\u5C31\u662F\u6E32\u67D3\u662F\u53EF\u4E2D\u65AD\u7684\u3002\u4EE5\u524D\u662F\u4E0D\u53EF\u4E2D\u65AD\u7684\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C\u4EE5\u524DReact\u4E2D\u7684update\u662F\u540C\u6B65\u6E32\u67D3\uFF0C\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u4E00\u65E6update\u5F00\u542F\uFF0C\u5728\u4EFB\u52A1\u5B8C\u6210\u524D\uFF0C\u90FD\u4E0D\u53EF\u4E2D\u65AD\u3002</p><ul><li>\u53EF\u4E2D\u65AD\uFF08\u5982\uFF1A\u6E32\u67D3\uFF09: \u5BF9\u4E8EReact\u6765\u8BF4\uFF0C\u4EFB\u52A1\u53EF\u80FD\u5F88\u591A\uFF0C\u9700\u8981\u533A\u5206\u4F18\u5148\u7EA7\uFF0C\u9AD8\u4F18\u5148\u7EA7\u4EFB\u52A1\u53EF\u4EE5\u4E2D\u65AD\u4F4E\u4F18\u5148\u7EA7\u4EFB\u52A1\uFF08\u57FA\u4E8Efiber\u672C\u8EAB\u94FE\u8868\u7ED3\u6784\uFF0C\u53EF\u4EE5\u8BB0\u5F55\u4EFB\u52A1\u7684\u6267\u884C\u60C5\u51B5\uFF0C\u4FBF\u4E8E\u6062\u590D\uFF09</li><li>\uFF08\u4EFB\u52A1\uFF09\u88AB\u9057\u5F03\uFF1AReact \u53EF\u80FD\u4F1A\u628A\u4E00\u4E9B\u66F4\u65B0\u6807\u8BB0\u4E3A\u4F4E\u4F18\u5148\u7EA7\uFF0C\u4EE5\u907F\u514D\u963B\u585E\u9AD8\u4F18\u5148\u7EA7\u66F4\u65B0\u7684\u6E32\u67D3\uFF0C\u4ECE\u800C\u63D0\u9AD8\u7528\u6237\u4F53\u9A8C\u3002\u8FD9\u610F\u5473\u7740\u67D0\u4E9B\u4F4E\u4F18\u5148\u7EA7\u66F4\u65B0\u53EF\u80FD\u4F1A\u88AB\u6682\u505C\u3001\u4E2D\u6B62\u6216\u5B8C\u5168\u4E22\u5F03\uFF0C\u56E0\u4E3A\u5B83\u4EEC\u5728\u540E\u7EED\u66F4\u65B0\u5230\u8FBE\u4E4B\u524D\u5DF2\u7ECF\u8FC7\u65F6\u3002 \u5982\uFF1A\u5728\u73B0\u5728React18\u4E2D\uFF0C\u8FD9\u4E2A\u6A21\u7CCA\u67E5\u8BE2\u76F8\u5173\u7684UI\u53EF\u4EE5\u88AB\u5F53\u505Atransition\u3002</li><li>\u652F\u6301\u72B6\u6001\u7684\u590D\u7528\uFF1A\u67D0\u4E9B\u60C5\u51B5\u4E0B\uFF0C\u6BD4\u5982\u7528\u6237\u8D70\u4E86\uFF0C\u53C8\u56DE\u6765\uFF0C\u90A3\u4E48\u4E0A\u4E00\u6B21\u7684\u9875\u9762\u72B6\u6001\u5E94\u5F53\u88AB\u4FDD\u5B58\u4E0B\u6765\uFF0C\u800C\u4E0D\u662F\u5B8C\u5168\u4ECE\u5934\u518D\u6765\u3002\u5F53\u7136\u5B9E\u9645\u60C5\u51B5\u4E0B\u4E0D\u80FD\u7F13\u5B58\u6240\u6709\u7684\u9875\u9762\uFF0C\u4E0D\u7136\u5185\u5B58\u4E0D\u5F97\u7206\u70B8\uFF0C\u6240\u4EE5\u8FD8\u5F97\u505A\u6210\u53EF\u9009\u7684\u3002\u76EE\u524D\uFF0CReact\u6B63\u5728\u7528Offscreen\u7EC4\u4EF6\u6765\u5B9E\u73B0\u8FD9\u4E2A\u529F\u80FD\u3002\u55EF\uFF0C\u4E5F\u5C31\u662F\u8FD9\u5173\u4E8E\u8FD9\u4E2A\u72B6\u6001\u590D\u7528\uFF0C\u5176\u5B9E\u8FD8\u6CA1\u5B8C\u6210\u5462\u3002\u4E0D\u8FC7\u6E90\u7801\u4E2D\u5DF2\u7ECF\u5728\u505A\u4E86\uFF1A <img src="'+p+`" alt="1.png"> \u53E6\u5916\uFF0C\u4F7F\u7528OffScreen\uFF0C\u9664\u4E86\u53EF\u4EE5\u590D\u7528\u539F\u5148\u7684\u72B6\u6001\uFF0C\u6211\u4EEC\u4E5F\u53EF\u4EE5\u4F7F\u7528\u5B83\u6765\u5F53\u505A\u65B0UI\u7684\u7F13\u5B58\u51C6\u5907\uFF0C\u5C31\u662F\u867D\u7136\u65B0UI\u8FD8\u6CA1\u767B\u573A\uFF0C\u4F46\u662F\u53EF\u4EE5\u5148\u5728\u540E\u53F0\u51C6\u5907\u7740\u561B\uFF0C\u8FD9\u6837\u4E00\u65E6\u8F6E\u5230\u5B83\uFF0C\u5C31\u53EF\u4EE5\u7ACB\u9A6C\u5FEB\u901F\u5730\u6E32\u67D3\u51FA\u6765\u3002</li></ul><p>\u603B\u7ED3\u4E00\u4E0B\uFF1AConcurrent\u5E76\u4E0D\u662FAPI\u4E4B\u7C7B\u7684\u65B0\u7279\u6027\uFF0C\u4F46\u662F\u5462\uFF0C\u5B83\u5F88\u91CD\u8981\uFF0C\u56E0\u4E3A\u5B83\u662FReact18\u5927\u90E8\u5206\u65B0\u7279\u6027\u7684\u5B9E\u73B0\u57FA\u7840\uFF0C\u5305\u62ECSuspense\u3001transitions\u3001\u6D41\u5F0F\u670D\u52A1\u7AEF\u6E32\u67D3\u7B49\u3002</p><h2 id="_3\u3001createroot-\u53D6\u4EE3\u4EE5\u524D\u7684-reactdom-render" tabindex="-1">3\u3001createRoot \u53D6\u4EE3\u4EE5\u524D\u7684 ReactDOM.render <a class="header-anchor" href="#_3\u3001createroot-\u53D6\u4EE3\u4EE5\u524D\u7684-reactdom-render" aria-hidden="true">#</a></h2><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">//React 17</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">React</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">react</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ReactDOM</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">react-dom</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">App</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">./App</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">root</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">document</span><span style="color:#666666;">.</span><span style="color:#80A665;">getElementById</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">root</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#BD976A;">ReactDOM</span><span style="color:#666666;">.</span><span style="color:#80A665;">render</span><span style="color:#666666;">(&lt;</span><span style="color:#B8A965;">App</span><span style="color:#666666;">/&gt;,</span><span style="color:#BD976A;">root</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// \u5378\u8F7D\u7EC4\u4EF6</span></span>
<span class="line"><span style="color:#BD976A;">ReactDOM</span><span style="color:#666666;">.</span><span style="color:#80A665;">unmountComponentAtNode</span><span style="color:#666666;">(</span><span style="color:#BD976A;">root</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// React 18</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">React</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">react</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ReactDOM</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">react-dom/client</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">App</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">./App</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Demo</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">./Demo</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">root</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ReactDOM</span><span style="color:#666666;">.</span><span style="color:#80A665;">createRoot</span><span style="color:#666666;">(</span><span style="color:#BD976A;">document</span><span style="color:#666666;">.</span><span style="color:#80A665;">getElementById</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">root</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">))</span></span>
<span class="line"><span style="color:#758575DD;">// \u5E76\u53D1\u6A21\u5F0F\u7684\u6E32\u67D3</span></span>
<span class="line"><span style="color:#BD976A;">root</span><span style="color:#666666;">.</span><span style="color:#80A665;">render</span><span style="color:#666666;">(&lt;</span><span style="color:#B8A965;">App</span><span style="color:#666666;">/&gt;)</span></span>
<span class="line"><span style="color:#BD976A;">root</span><span style="color:#666666;">.</span><span style="color:#80A665;">render</span><span style="color:#666666;">(&lt;</span><span style="color:#B8A965;">Demo</span><span style="color:#666666;">/&gt;)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// \u5378\u8F7D\u7EC4\u4EF6</span></span>
<span class="line"><span style="color:#BD976A;">root</span><span style="color:#666666;">.</span><span style="color:#80A665;">unmount</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;">  </span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">//React 17</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">React</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">react</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ReactDOM</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">react-dom</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">App</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">./App</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">root</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">document</span><span style="color:#999999;">.</span><span style="color:#59873A;">getElementById</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">root</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#B07D48;">ReactDOM</span><span style="color:#999999;">.</span><span style="color:#59873A;">render</span><span style="color:#999999;">(&lt;</span><span style="color:#998418;">App</span><span style="color:#999999;">/&gt;,</span><span style="color:#B07D48;">root</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// \u5378\u8F7D\u7EC4\u4EF6</span></span>
<span class="line"><span style="color:#B07D48;">ReactDOM</span><span style="color:#999999;">.</span><span style="color:#59873A;">unmountComponentAtNode</span><span style="color:#999999;">(</span><span style="color:#B07D48;">root</span><span style="color:#999999;">)</span><span style="color:#393A34;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// React 18</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">React</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">react</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ReactDOM</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">react-dom/client</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">App</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">./App</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Demo</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">./Demo</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">root</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ReactDOM</span><span style="color:#999999;">.</span><span style="color:#59873A;">createRoot</span><span style="color:#999999;">(</span><span style="color:#B07D48;">document</span><span style="color:#999999;">.</span><span style="color:#59873A;">getElementById</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">root</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">))</span></span>
<span class="line"><span style="color:#A0ADA0;">// \u5E76\u53D1\u6A21\u5F0F\u7684\u6E32\u67D3</span></span>
<span class="line"><span style="color:#B07D48;">root</span><span style="color:#999999;">.</span><span style="color:#59873A;">render</span><span style="color:#999999;">(&lt;</span><span style="color:#998418;">App</span><span style="color:#999999;">/&gt;)</span></span>
<span class="line"><span style="color:#B07D48;">root</span><span style="color:#999999;">.</span><span style="color:#59873A;">render</span><span style="color:#999999;">(&lt;</span><span style="color:#998418;">Demo</span><span style="color:#999999;">/&gt;)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// \u5378\u8F7D\u7EC4\u4EF6</span></span>
<span class="line"><span style="color:#B07D48;">root</span><span style="color:#999999;">.</span><span style="color:#59873A;">unmount</span><span style="color:#999999;">()</span><span style="color:#393A34;">  </span></span>
<span class="line"></span></code></pre></div><p>\u4EE5\u524D root \u5BF9\u8C61 \u53EA\u5B58\u5728\u4E8EReact\u5185\u90E8\uFF0C\u73B0\u5728\u7528\u6237\u4E5F\u53EF\u4EE5\u590D\u7528 root \u5BF9\u8C61\u4E86\u3002</p><p>\u4EE5\u524DReactDOM.render\u7B2C\u4E09\u4E2A\u53C2\u6570\u662F\u5728\u66F4\u65B0\u5B8C\u6210\u6267\u884C\u7684callback\uFF0C\u800C\u5728React18\u4E2D\uFF0C\u8FD9\u6837\u7684callback\u4F1A\u5EFA\u8BAE\u653E\u5728useEffect\u4E2D\uFF1A</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">root</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">createRoot</span><span style="color:#666666;">(</span><span style="color:#BD976A;">document</span><span style="color:#666666;">.</span><span style="color:#80A665;">getElementById</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">root</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">AppWithCallbackAfterRender</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">useEffect</span><span style="color:#666666;">(()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">rendered</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">jsx</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BD976A;">root</span><span style="color:#666666;">.</span><span style="color:#80A665;">render</span><span style="color:#666666;">(&lt;</span><span style="color:#B8A965;">AppWithCallbackAfterRender</span><span style="color:#666666;">/&gt;);</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">root</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">createRoot</span><span style="color:#999999;">(</span><span style="color:#B07D48;">document</span><span style="color:#999999;">.</span><span style="color:#59873A;">getElementById</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">root</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">AppWithCallbackAfterRender</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">useEffect</span><span style="color:#999999;">(()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">rendered</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">jsx</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B07D48;">root</span><span style="color:#999999;">.</span><span style="color:#59873A;">render</span><span style="color:#999999;">(&lt;</span><span style="color:#998418;">AppWithCallbackAfterRender</span><span style="color:#999999;">/&gt;);</span></span>
<span class="line"></span></code></pre></div><h2 id="_4\u3001ssr-\u4E2D\u7684-reactdom-hydrate-\u4E5F\u6362\u6210\u4E86\u65B0\u7684-hydrateroot" tabindex="-1">4\u3001ssr \u4E2D\u7684 ReactDOM.hydrate \u4E5F\u6362\u6210\u4E86\u65B0\u7684 hydrateRoot <a class="header-anchor" href="#_4\u3001ssr-\u4E2D\u7684-reactdom-hydrate-\u4E5F\u6362\u6210\u4E86\u65B0\u7684-hydrateroot" aria-hidden="true">#</a></h2><p>\u4EE5\u4E0A\u4E24\u4E2AAPI\u76EE\u524D\u4F9D\u7136\u652F\u6301\uFF0C\u53EA\u662F\u5DF2\u7ECF\u79FB\u5165legacy\u6A21\u5F0F\uFF0C\u5F00\u53D1\u73AF\u5883\u4E0B\u4F1A\u62A5warning\u3002 <img src="`+o+`" alt="2.png"></p><h2 id="_5\u3001suspense" tabindex="-1">5\u3001Suspense <a class="header-anchor" href="#_5\u3001suspense" aria-hidden="true">#</a></h2><p>\u53EF\u4EE5\u201C\u7B49\u5F85\u201D\u76EE\u6807UI\u52A0\u8F7D\uFF0C\u5E76\u4E14\u53EF\u4EE5\u76F4\u63A5\u6307\u5B9A\u4E00\u4E2A\u52A0\u8F7D\u7684\u754C\u9762\uFF08\u50CF\u662F\u4E2A spinner\uFF09\uFF0C\u8BA9\u5B83\u5728\u7528\u6237\u7B49\u5F85\u7684\u65F6\u5019\u663E\u793A\u3002</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Suspense</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fallback</span><span style="color:#666666;">={&lt;</span><span style="color:#B8A965;">Spinner</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Comments</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">Suspense</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#999999;">&lt;</span><span style="color:#998418;">Suspense</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fallback</span><span style="color:#999999;">={&lt;</span><span style="color:#998418;">Spinner</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;}&gt;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Comments</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#998418;">Suspense</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>\u5176\u5B9ESuspense\u4E5F\u65E9\u5C31\u51FA\u73B0\u5728React\u4E2D\u4E86\uFF0C\u53EA\u4E0D\u8FC7\u4E4B\u524D\u529F\u80FD\u6709\u9650\u3002\u5728React18\u4E2D\uFF0C\u80CC\u9760Concurrent\u6A21\u5F0F\uFF0CSuspense\u7EC8\u4E8E\u7206\u53D1\u4E86\u81EA\u5DF1\u7684\u5149\u5F69\u3002</p><p>\u5728\u6982\u5FF5\u4E0A\uFF0CSuspense\u6709\u70B9\u50CFcatch\uFF0C\u53EA\u4E0D\u8FC7Suspense\u6355\u83B7\u7684\u4E0D\u662F\u5F02\u5E38\uFF0C\u800C\u662F\u7EC4\u4EF6\u7684suspending\u72B6\u6001\uFF0C\u5373\u6302\u8F7D\u4E2D\u3002</p><h4 id="\u663E\u793A-loading" tabindex="-1">\u663E\u793A loading <a class="header-anchor" href="#\u663E\u793A-loading" aria-hidden="true">#</a></h4><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#BD976A;">useState</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Suspense</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">react</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">User</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../components/User</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Num</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../components/Num</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#BD976A;">fetchData</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../utils</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ErrorBoundaryPage</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">./ErrorBoundaryPage</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">initialResource</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">fetchData</span><span style="color:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">SuspensePage</span><span style="color:#666666;">(</span><span style="color:#BD976A;">props</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#BD976A;">resource</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">setResource</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useState</span><span style="color:#666666;">(</span><span style="color:#BD976A;">initialResource</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">h3</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">SuspensePage</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h3</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">{</span><span style="color:#758575DD;">/* \u6355\u83B7\u5F02\u5E38 */</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">ErrorBoundaryPage</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fallback</span><span style="color:#666666;">={&lt;</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">\u7F51\u7EDC\u51FA\u9519\u4E86</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Suspense</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fallback</span><span style="color:#666666;">={&lt;</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">loading - user</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">          </span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">User</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resource</span><span style="color:#666666;">={</span><span style="color:#BD976A;">resource</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">Suspense</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">ErrorBoundaryPage</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">{</span><span style="color:#758575DD;">/* \u663E\u793A loading */</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Suspense</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fallback</span><span style="color:#666666;">={&lt;</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">loading-num</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Num</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resource</span><span style="color:#666666;">={</span><span style="color:#BD976A;">resource</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">Suspense</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">button</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">onClick</span><span style="color:#666666;">={()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">setResource</span><span style="color:#666666;">(</span><span style="color:#80A665;">fetchData</span><span style="color:#666666;">())}&gt;</span><span style="color:#DBD7CAEE;">refresh</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">button</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#B07D48;">useState</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Suspense</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">react</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">User</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../components/User</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Num</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../components/Num</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#B07D48;">fetchData</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../utils</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ErrorBoundaryPage</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">./ErrorBoundaryPage</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">initialResource</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">fetchData</span><span style="color:#999999;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">SuspensePage</span><span style="color:#999999;">(</span><span style="color:#B07D48;">props</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B07D48;">resource</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">setResource</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useState</span><span style="color:#999999;">(</span><span style="color:#B07D48;">initialResource</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">h3</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">SuspensePage</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h3</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">{</span><span style="color:#A0ADA0;">/* \u6355\u83B7\u5F02\u5E38 */</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">&lt;</span><span style="color:#998418;">ErrorBoundaryPage</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fallback</span><span style="color:#999999;">={&lt;</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">\u7F51\u7EDC\u51FA\u9519\u4E86</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Suspense</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fallback</span><span style="color:#999999;">={&lt;</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">loading - user</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#999999;">&lt;</span><span style="color:#998418;">User</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resource</span><span style="color:#999999;">={</span><span style="color:#B07D48;">resource</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;/</span><span style="color:#998418;">Suspense</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">&lt;/</span><span style="color:#998418;">ErrorBoundaryPage</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">{</span><span style="color:#A0ADA0;">/* \u663E\u793A loading */</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Suspense</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fallback</span><span style="color:#999999;">={&lt;</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">loading-num</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Num</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resource</span><span style="color:#999999;">={</span><span style="color:#B07D48;">resource</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">&lt;/</span><span style="color:#998418;">Suspense</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">button</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">onClick</span><span style="color:#999999;">={()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#59873A;">setResource</span><span style="color:#999999;">(</span><span style="color:#59873A;">fetchData</span><span style="color:#999999;">())}&gt;</span><span style="color:#393A34;">refresh</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">button</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><h4 id="\u9519\u8BEF\u5904\u7406" tabindex="-1">\u9519\u8BEF\u5904\u7406 <a class="header-anchor" href="#\u9519\u8BEF\u5904\u7406" aria-hidden="true">#</a></h4><p>\u6BCF\u5F53\u4F7F\u7528 Promises\uFF0C\u5927\u6982\u7387\u6211\u4EEC\u4F1A\u7528 catch() \u6765\u505A\u9519\u8BEF\u5904\u7406\u3002\u4F46\u5F53\u6211\u4EEC\u7528 Suspense \u65F6\uFF0C\u6211\u4EEC\u4E0D\u7B49\u5F85 Promises \u5C31\u76F4\u63A5\u5F00\u59CB\u6E32\u67D3\uFF0C\u8FD9\u65F6 catch() \u5C31\u4E0D\u9002\u7528\u4E86\u3002\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u9519\u8BEF\u5904\u7406\u8BE5\u600E\u4E48\u8FDB\u884C\u5462\uFF1F</p><p>\u5728 Suspense \u4E2D\uFF0C\u83B7\u53D6\u6570\u636E\u65F6\u629B\u51FA\u7684\u9519\u8BEF\u548C\u7EC4\u4EF6\u6E32\u67D3\u65F6\u7684\u62A5\u9519\u5904\u7406\u65B9\u5F0F\u4E00\u6837\u2014\u2014\u4F60\u53EF\u4EE5\u5728\u9700\u8981\u7684\u5C42\u7EA7\u6E32\u67D3\u4E00\u4E2A\u9519\u8BEF\u8FB9\u754C\u7EC4\u4EF6\u6765\u201C\u6355\u6349\u201D\u5C42\u7EA7\u4E0B\u9762\u7684\u6240\u6709\u7684\u62A5\u9519\u4FE1\u606F\u3002</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Component</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../whichReact</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">class</span><span style="color:#DBD7CAEE;"> </span><span style="color:#5DA9A7;">ErrorBoundaryPage</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">extends</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">Component</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">state</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">hasError</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">error</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">null</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#666666;">  </span><span style="color:#758575DD;">// \u6B64\u751F\u547D\u5468\u671F\u4F1A\u5728\u540E\u4EE3\u7EC4\u4EF6\u629B\u51FA\u9519\u8BEF\u540E\u88AB\u8C03\u7528\u3002 \u5B83\u5C06\u629B\u51FA\u7684\u9519\u8BEF\u4F5C\u4E3A\u53C2\u6570\uFF0C\u5E76\u8FD4\u56DE\u4E00\u4E2A\u503C\u4EE5\u66F4\u65B0 state</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#CB7676;">static</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">getDerivedStateFromError</span><span style="color:#666666;">(</span><span style="color:#BD976A;">error</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#B8A965;">hasError</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#BD976A;">error</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">render</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">state</span><span style="color:#666666;">.</span><span style="color:#BD976A;">hasError</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">props</span><span style="color:#666666;">.</span><span style="color:#BD976A;">fallback</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">props</span><span style="color:#666666;">.</span><span style="color:#BD976A;">children</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Component</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../whichReact</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">class</span><span style="color:#393A34;"> </span><span style="color:#2E808F;">ErrorBoundaryPage</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">extends</span><span style="color:#393A34;"> </span><span style="color:#59873A;">Component</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">state</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#998418;">hasError</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#998418;">error</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">null</span><span style="color:#393A34;"> </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#999999;">  </span><span style="color:#A0ADA0;">// \u6B64\u751F\u547D\u5468\u671F\u4F1A\u5728\u540E\u4EE3\u7EC4\u4EF6\u629B\u51FA\u9519\u8BEF\u540E\u88AB\u8C03\u7528\u3002 \u5B83\u5C06\u629B\u51FA\u7684\u9519\u8BEF\u4F5C\u4E3A\u53C2\u6570\uFF0C\u5E76\u8FD4\u56DE\u4E00\u4E2A\u503C\u4EE5\u66F4\u65B0 state</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">static</span><span style="color:#393A34;"> </span><span style="color:#59873A;">getDerivedStateFromError</span><span style="color:#999999;">(</span><span style="color:#B07D48;">error</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#998418;">hasError</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B07D48;">error</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">render</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">state</span><span style="color:#999999;">.</span><span style="color:#B07D48;">hasError</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">props</span><span style="color:#999999;">.</span><span style="color:#B07D48;">fallback</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">props</span><span style="color:#999999;">.</span><span style="color:#B07D48;">children</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="_6\u3001suspenselist" tabindex="-1">6\u3001SuspenseList <a class="header-anchor" href="#_6\u3001suspenselist" aria-hidden="true">#</a></h2><p>SuspenseList\u5728<a href="https://github.com/bubucuo/DebugReact" target="_blank" rel="noreferrer">DebugReact</a>\u4E2D\u53EF\u7528\uFF0C\u4E5F\u5C31\u662F <strong>DEV \u73AF\u5883\u4E0B\u53EF\u4EE5\u7528</strong>\u3002\u76EE\u524D\u8FD8\u672A\u5B8C\u6210\uFF0C\u9884\u8BA118.X\u4F1A\u6B63\u5F0F\u652F\u6301\uFF0C\u4EE5\u4E0B\u4F8B\u5B50\u5F53\u505A\u53C2\u8003\uFF0C\u4EE5\u540E\u4E5F\u8BB8\u4F1A\u6539\u53D8\u3002</p><p>\u7528\u4E8E\u63A7\u5236Suspense\u7EC4\u4EF6\u7684\u663E\u793A\u987A\u5E8F\u3002</p><h4 id="revealorder-\u5C5E\u6027" tabindex="-1">revealOrder \u5C5E\u6027 <a class="header-anchor" href="#revealorder-\u5C5E\u6027" aria-hidden="true">#</a></h4><p>Suspense \u52A0\u8F7D\u987A\u5E8F</p><ul><li>together\uFF1A \u6240\u6709Suspense\u4E00\u8D77\u663E\u793A\uFF0C\u4E5F\u5C31\u662F\u6700\u540E\u4E00\u4E2A\u52A0\u8F7D\u5B8C\u4E86\u624D\u4E00\u8D77\u663E\u793A\u5168\u90E8</li><li>forwards\uFF1A \u6309\u7167\u987A\u5E8F\u663E\u793ASuspense</li><li>backwards\uFF1A \u53CD\u5E8F\u663E\u793ASuspense</li></ul><h4 id="tail-\u5C5E\u6027" tabindex="-1">tail \u5C5E\u6027 <a class="header-anchor" href="#tail-\u5C5E\u6027" aria-hidden="true">#</a></h4><p>\u662F\u5426\u663E\u793Afallback\uFF0C\u53EA\u5728 revealOrder \u4E3A forwards \u6216\u8005 backwards \u65F6\u5019\u6709\u6548</p><ul><li>hidden \u4E0D\u663E\u793A</li><li>collapsed \u8F6E\u5230\u81EA\u5DF1\u518D\u663E\u793A</li></ul><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#BD976A;">useState</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Suspense</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">SuspenseList</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">react</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">User</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../components/User</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Num</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../components/Num</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#BD976A;">fetchData</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../utils</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ErrorBoundaryPage</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">./ErrorBoundaryPage</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">initialResource</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">fetchData</span><span style="color:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">SuspenseListPage</span><span style="color:#666666;">(</span><span style="color:#BD976A;">props</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#BD976A;">resource</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">setResource</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useState</span><span style="color:#666666;">(</span><span style="color:#BD976A;">initialResource</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">h3</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">SuspenseListPage</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h3</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">SuspenseList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">tail</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">collapsed</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">ErrorBoundaryPage</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fallback</span><span style="color:#666666;">={&lt;</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">\u7F51\u7EDC\u51FA\u9519\u4E86</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Suspense</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fallback</span><span style="color:#666666;">={&lt;</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">loading - user</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">User</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resource</span><span style="color:#666666;">={</span><span style="color:#BD976A;">resource</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">Suspense</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">ErrorBoundaryPage</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Suspense</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fallback</span><span style="color:#666666;">={&lt;</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">loading-num</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Num</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resource</span><span style="color:#666666;">={</span><span style="color:#BD976A;">resource</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">Suspense</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">SuspenseList</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">button</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">onClick</span><span style="color:#666666;">={()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">setResource</span><span style="color:#666666;">(</span><span style="color:#80A665;">fetchData</span><span style="color:#666666;">())}&gt;</span><span style="color:#DBD7CAEE;">refresh</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">button</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#B07D48;">useState</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Suspense</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">SuspenseList</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">react</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">User</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../components/User</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Num</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../components/Num</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#B07D48;">fetchData</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../utils</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ErrorBoundaryPage</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">./ErrorBoundaryPage</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">initialResource</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">fetchData</span><span style="color:#999999;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">SuspenseListPage</span><span style="color:#999999;">(</span><span style="color:#B07D48;">props</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B07D48;">resource</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">setResource</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useState</span><span style="color:#999999;">(</span><span style="color:#B07D48;">initialResource</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">h3</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">SuspenseListPage</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h3</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">SuspenseList</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">tail</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">collapsed</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">ErrorBoundaryPage</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fallback</span><span style="color:#999999;">={&lt;</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">\u7F51\u7EDC\u51FA\u9519\u4E86</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Suspense</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fallback</span><span style="color:#999999;">={&lt;</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">loading - user</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">User</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resource</span><span style="color:#999999;">={</span><span style="color:#B07D48;">resource</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#998418;">Suspense</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#998418;">ErrorBoundaryPage</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Suspense</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fallback</span><span style="color:#999999;">={&lt;</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">loading-num</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Num</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resource</span><span style="color:#999999;">={</span><span style="color:#B07D48;">resource</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#998418;">Suspense</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#998418;">SuspenseList</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">button</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">onClick</span><span style="color:#999999;">={()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#59873A;">setResource</span><span style="color:#999999;">(</span><span style="color:#59873A;">fetchData</span><span style="color:#999999;">())}&gt;</span><span style="color:#393A34;">refresh</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">button</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="_7\u3001transition" tabindex="-1">7\u3001transition <a class="header-anchor" href="#_7\u3001transition" aria-hidden="true">#</a></h2><p>React\u628Aupdate\u5206\u6210\u4E24\u79CD\uFF1A</p><ul><li>Urgent updates \u7D27\u6025\u66F4\u65B0\uFF0C\u6307\u76F4\u63A5\u4EA4\u4E92\uFF0C\u901A\u5E38\u6307\u7684\u7528\u6237\u4EA4\u4E92\u3002\u5982\u70B9\u51FB\u3001\u8F93\u5165\u7B49\u3002\u8FD9\u79CD\u66F4\u65B0\u4E00\u65E6\u4E0D\u53CA\u65F6\uFF0C\u7528\u6237\u5C31\u4F1A\u89C9\u5F97\u54EA\u91CC\u4E0D\u5BF9\u3002</li><li>Transition updates \u8FC7\u6E21\u66F4\u65B0\uFF0C\u5982UI\u4ECE\u4E00\u4E2A\u89C6\u56FE\u5411\u53E6\u4E00\u4E2A\u89C6\u56FE\u7684\u66F4\u65B0\u3002\u901A\u5E38\u8FD9\u79CD\u66F4\u65B0\u7528\u6237\u5E76\u4E0D\u7740\u6025\u770B\u5230(\u4E0D\u4E2D\u65AD\u4EA4\u4E92)\u3002</li></ul><h4 id="starttransition" tabindex="-1">startTransition <a class="header-anchor" href="#starttransition" aria-hidden="true">#</a></h4><p>startTransition \u53EF\u4EE5\u7528\u5728\u4EFB\u4F55\u4F60\u60F3\u66F4\u65B0\u7684\u65F6\u5019\u3002\u4F46\u662F\u4ECE\u5B9E\u9645\u6765\u8BF4\uFF0C\u4EE5\u4E0B\u662F\u4E24\u79CD\u5178\u578B\u9002\u7528\u573A\u666F\uFF1A</p><ul><li>\u6E32\u67D3\u6162\uFF1A\u5982\u679C\u4F60\u6709\u5F88\u591A\u6CA1\u90A3\u4E48\u7740\u6025\u7684\u5185\u5BB9\u8981\u6E32\u67D3\u66F4\u65B0\u3002</li><li>\u7F51\u7EDC\u6162\uFF1A\u5982\u679C\u4F60\u7684\u66F4\u65B0\u9700\u8981\u82B1\u8F83\u591A\u65F6\u95F4\u4ECE\u670D\u52A1\u7AEF\u83B7\u53D6\u3002\u8FD9\u4E2A\u65F6\u5019\u4E5F\u53EF\u4EE5\u518D\u7ED3\u5408Suspense\u3002</li></ul><p>Button</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#758575DD;">//startTransition,</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#BD976A;">useTransition</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">react</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">Button</span><span style="color:#666666;">({</span><span style="color:#BD976A;">refresh</span><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#BD976A;">isPending</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">startTransition</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useTransition</span><span style="color:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">div</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">className</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">border</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">h3</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">Button</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h3</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">button</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#BD976A;">onClick</span><span style="color:#666666;">={()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#80A665;">startTransition</span><span style="color:#666666;">(()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#80A665;">refresh</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0  </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0  </span><span style="color:#666666;">}}</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#BD976A;">disabled</span><span style="color:#666666;">={</span><span style="color:#BD976A;">isPending</span><span style="color:#666666;">}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0  \u70B9\u51FB\u5237\u65B0\u6570\u636E</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">button</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0  </span><span style="color:#666666;">{</span><span style="color:#BD976A;">isPending</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">?</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">loading...</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">null</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#A0ADA0;">//startTransition,</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#B07D48;">useTransition</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">react</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">Button</span><span style="color:#999999;">({</span><span style="color:#B07D48;">refresh</span><span style="color:#999999;">})</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B07D48;">isPending</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">startTransition</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useTransition</span><span style="color:#999999;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">div</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">className</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">border</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">h3</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">Button</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h3</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">button</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#B07D48;">onClick</span><span style="color:#999999;">={()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#59873A;">startTransition</span><span style="color:#999999;">(()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#59873A;">refresh</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0  </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0  </span><span style="color:#999999;">}}</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#B07D48;">disabled</span><span style="color:#999999;">={</span><span style="color:#B07D48;">isPending</span><span style="color:#999999;">}&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0  \u70B9\u51FB\u5237\u65B0\u6570\u636E</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">button</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0  </span><span style="color:#999999;">{</span><span style="color:#B07D48;">isPending</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">?</span><span style="color:#393A34;"> </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">loading...</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">null</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#BD976A;">useEffect</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">useState</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Suspense</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">react</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Button</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../components/Button</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">User</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../components/User</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Num</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../components/Num</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#BD976A;">fetchData</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../utils</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">initialResource</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">fetchData</span><span style="color:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">TransitionPage</span><span style="color:#666666;">(</span><span style="color:#BD976A;">props</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#BD976A;">resource</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">setResource</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useState</span><span style="color:#666666;">(</span><span style="color:#BD976A;">initialResource</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#758575DD;">// useEffect(() =&gt; {</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#758575DD;">// \xA0 console.log(&quot;resource&quot;, resource); //sy-log</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#758575DD;">// }, [resource]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">h3</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">TransitionPage</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h3</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Suspense</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fallback</span><span style="color:#666666;">={&lt;</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">loading - user</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">User</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resource</span><span style="color:#666666;">={</span><span style="color:#BD976A;">resource</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">Suspense</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Suspense</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fallback</span><span style="color:#666666;">={&lt;</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">loading-num</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h1</span><span style="color:#666666;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Num</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resource</span><span style="color:#666666;">={</span><span style="color:#BD976A;">resource</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">Suspense</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Button</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#BD976A;">refresh</span><span style="color:#666666;">={()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#80A665;">setResource</span><span style="color:#666666;">(</span><span style="color:#80A665;">fetchData</span><span style="color:#666666;">());</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0  </span><span style="color:#666666;">}}</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#B07D48;">useEffect</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">useState</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Suspense</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">react</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Button</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../components/Button</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">User</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../components/User</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Num</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../components/Num</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#B07D48;">fetchData</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../utils</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">initialResource</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">fetchData</span><span style="color:#999999;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">TransitionPage</span><span style="color:#999999;">(</span><span style="color:#B07D48;">props</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B07D48;">resource</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">setResource</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useState</span><span style="color:#999999;">(</span><span style="color:#B07D48;">initialResource</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#A0ADA0;">// useEffect(() =&gt; {</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#A0ADA0;">// \xA0 console.log(&quot;resource&quot;, resource); //sy-log</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#A0ADA0;">// }, [resource]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">h3</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">TransitionPage</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h3</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Suspense</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fallback</span><span style="color:#999999;">={&lt;</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">loading - user</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">User</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resource</span><span style="color:#999999;">={</span><span style="color:#B07D48;">resource</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#998418;">Suspense</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Suspense</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fallback</span><span style="color:#999999;">={&lt;</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">loading-num</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h1</span><span style="color:#999999;">&gt;}&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Num</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resource</span><span style="color:#999999;">={</span><span style="color:#B07D48;">resource</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#998418;">Suspense</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Button</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#B07D48;">refresh</span><span style="color:#999999;">={()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0 \xA0</span><span style="color:#59873A;">setResource</span><span style="color:#999999;">(</span><span style="color:#59873A;">fetchData</span><span style="color:#999999;">());</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0  </span><span style="color:#999999;">}}</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><h4 id="\u4E0Esettimeout\u5F02\u540C" tabindex="-1">\u4E0EsetTimeout\u5F02\u540C <a class="header-anchor" href="#\u4E0Esettimeout\u5F02\u540C" aria-hidden="true">#</a></h4><p>\u5728startTransition\u51FA\u73B0\u4E4B\u524D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528setTimeout\u6765\u5B9E\u73B0\u4F18\u5316\u3002\u4F46\u662F\u73B0\u5728\u5728\u5904\u7406\u4E0A\u9762\u7684\u4F18\u5316\u7684\u65F6\u5019\uFF0C\u6709\u4E86startTransition\u57FA\u672C\u4E0A\u53EF\u4EE5\u629B\u5F03setTimeout\u4E86\uFF0C\u539F\u56E0\u4E3B\u8981\u6709\u4EE5\u4E09\u70B9\uFF1A</p><ul><li>\u4E0E setTimeout \u4E0D\u540C\u7684\u662F\uFF0CstartTransition \u5E76\u4E0D\u4F1A\u5EF6\u8FDF\u8C03\u5EA6\uFF0C\u800C\u662F\u4F1A\u7ACB\u5373\u6267\u884C\uFF0C</li><li>startTransition \u63A5\u6536\u7684\u51FD\u6570\u662F\u540C\u6B65\u6267\u884C\u7684\uFF0C\u53EA\u662F\u8FD9\u4E2A update \u88AB\u52A0\u4E86\u4E00\u4E2A \u201Ctransitions&quot; \u7684\u6807\u8BB0\u3002\u800C\u8FD9\u4E2A\u6807\u8BB0\uFF0CReact \u5185\u90E8\u5904\u7406\u66F4\u65B0\u7684\u65F6\u5019\u662F\u4F1A\u4F5C\u4E3A\u53C2\u8003\u4FE1\u606F\u7684\u3002</li><li>\u76F8\u6BD4\u4E8E setTimeout\uFF0C \u628A\u4E00\u4E2A update \u4EA4\u7ED9 startTransition \u80FD\u591F\u66F4\u65E9\u5730\u88AB\u5904\u7406\u3002\u800C\u5728\u4E8E\u8F83\u5FEB\u7684\u8BBE\u5907\u4E0A\uFF0C\u8FD9\u4E2A\u8FC7\u5EA6\u662F\u7528\u6237\u611F\u77E5\u4E0D\u5230\u7684</li></ul><h4 id="usetransition" tabindex="-1">useTransition <a class="header-anchor" href="#usetransition" aria-hidden="true">#</a></h4><p>\u5728\u4F7F\u7528startTransition\u66F4\u65B0\u72B6\u6001\u7684\u65F6\u5019\uFF0C\u7528\u6237\u53EF\u80FD\u60F3\u8981\u77E5\u9053transition\u7684\u5B9E\u65F6\u60C5\u51B5\uFF0C\u8FD9\u4E2A\u65F6\u5019\u53EF\u4EE5\u4F7F\u7528React\u63D0\u4F9B\u7684hook api useTransition\u3002</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">useTransition</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">react</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#BD976A;">isPending</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">startTransition</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useTransition</span><span style="color:#666666;">();</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">useTransition</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">react</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B07D48;">isPending</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">startTransition</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useTransition</span><span style="color:#999999;">();</span></span>
<span class="line"></span></code></pre></div><p>\u5982\u679Ctransition\u672A\u5B8C\u6210\uFF0CisPending\u503C\u4E3Atrue\uFF0C\u5426\u5219\u4E3Afalse\u3002</p><h4 id="suspense\u4E0Etransitions\u7ED3\u5408" tabindex="-1">Suspense\u4E0Etransitions\u7ED3\u5408 <a class="header-anchor" href="#suspense\u4E0Etransitions\u7ED3\u5408" aria-hidden="true">#</a></h4><p>\u6240\u8C13\u63D0\u9AD8\u7528\u6237\u4F53\u9A8C\uFF0C\u4E00\u4E2A\u91CD\u8981\u7684\u51C6\u5219\u5C31\u662F\u4FDD\u8BC1UI\u7684\u8FDE\u7EED\u6027\uFF0C\u5982\u4E0B\u9762\u7684\u4F8B\u5B50\uFF0C\u5982\u679C\u6B64\u65F6\u6211\u60F3\u628Atab\u4ECE\u2018photos\u2019\u5207\u6362\u5230\u2018comments\u2019\uFF0C\u4F46\u662FComments\u53C8\u6CA1\u6CD5\u7ACB\u9A6C\u6E32\u67D3\u51FA\u6765\uFF0C\u8FD9\u4E2A\u65F6\u5019\u4E0D\u53EF\u907F\u514D\u5730\uFF0C\u5C31\u4F1APhotos\u9875\u9762\u6D88\u5931\uFF0C\u663E\u73B0Spinner\u7684loading\u9875\u9762\uFF0C\u7B49\u4E00\u4F1A\u513F\uFF0CComments\u9875\u9762\u624D\u59D7\u59D7\u6765\u8FDF\u3002</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">handleClick</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">setTab</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">comments</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Suspense</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fallback</span><span style="color:#666666;">={&lt;</span><span style="color:#B8A965;">Spinner</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">{</span><span style="color:#BD976A;">tab</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">photos</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">?</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Photos</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Comments</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;}</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">Suspense</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">handleClick</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">setTab</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">comments</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#998418;">Suspense</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fallback</span><span style="color:#999999;">={&lt;</span><span style="color:#998418;">Spinner</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;}&gt;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">{</span><span style="color:#B07D48;">tab</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">photos</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">?</span><span style="color:#393A34;"> </span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Photos</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Comments</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;}</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#998418;">Suspense</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>\u4ECEUI\u8FDE\u7EED\u6027\u4E0A\u6765\u8BF4\uFF0C\u8FD9\u4E2A\u4E2D\u95F4\u51FA\u73B0\u7684Spinner\u5C31\u5DF2\u7ECF\u7834\u574F\u4E86\u8FDE\u7EED\u6027\u3002\u800C\u5B9E\u9645\u4E0A\uFF0C\u6B63\u5E38\u4EBA\u7684\u53CD\u5E94\u5176\u5B9E\u662F\u6CA1\u6709\u90A3\u4E48\u5FEB\uFF0C\u77ED\u6682\u7684\u5EF6\u8FDF\u6211\u4EEC\u662F\u611F\u89C9\u4E0D\u5230\u7684\u3002\u6240\u4EE5\u8003\u8651\u5230UI\u7684\u8FDE\u7EED\u6027\uFF0C\u4E0A\u9762\u7684\u4F8B\u5B50\uFF0C\u4EA4\u4E92\u53EF\u4E0D\u53EF\u4EE5\u4FEE\u6539\u4E00\u4E0B\uFF0C\u628A\u4E0A\u9762\u9875\u9762\u7684\u5207\u6362\u5F53\u505Atransitions\uFF0C\u8FD9\u6837\u5373\u4F7Ftab\u5207\u6362\uFF0C\u4F46\u662F\u4F9D\u7136\u77ED\u6682\u505C\u7559\u5728Photos\uFF0C\u4E4B\u540E\u518D\u6539\u53D8\u5230Comments\u3002</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">handleClick</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">startTransition</span><span style="color:#666666;">(()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">setTab</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">comments</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">handleClick</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">startTransition</span><span style="color:#999999;">(()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">setTab</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">comments</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><p>\u4E0A\u9762\u8FD9\u4E2A\u4F8B\u5B50\u6211\u4EEC\u4F7F\u7528\u7684\u662FstartTransition\uFF0C\u5982\u679C\u9700\u8981\u77E5\u9053pending\u72B6\u6001\uFF0C\u53EF\u4EE5\u4F7F\u7528useTransition:</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#BD976A;">isPending</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">startTransition</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useTransition</span><span style="color:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">handleClick</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">startTransition</span><span style="color:#666666;">(()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">setTab</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">comments</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Suspense</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fallback</span><span style="color:#666666;">={&lt;</span><span style="color:#B8A965;">Spinner</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">div</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">style</span><span style="color:#666666;">={{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">opacity</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">isPending</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">?</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0.8</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">{</span><span style="color:#BD976A;">tab</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">photos</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">?</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Photos</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">Comments</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">Suspense</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B07D48;">isPending</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">startTransition</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useTransition</span><span style="color:#999999;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">handleClick</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">startTransition</span><span style="color:#999999;">(()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">setTab</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">comments</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#998418;">Suspense</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fallback</span><span style="color:#999999;">={&lt;</span><span style="color:#998418;">Spinner</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;}&gt;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">div</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">style</span><span style="color:#999999;">={{</span><span style="color:#393A34;"> </span><span style="color:#998418;">opacity</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">isPending</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">?</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0.8</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#393A34;"> </span><span style="color:#999999;">}}&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">{</span><span style="color:#B07D48;">tab</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">photos</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">?</span><span style="color:#393A34;"> </span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Photos</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">&lt;</span><span style="color:#998418;">Comments</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;}</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#998418;">Suspense</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><h4 id="usedeferredvalue" tabindex="-1">useDeferredValue <a class="header-anchor" href="#usedeferredvalue" aria-hidden="true">#</a></h4><p>\u4F7F\u5F97\u6211\u4EEC\u53EF\u4EE5\u5EF6\u8FDF\u66F4\u65B0\u67D0\u4E2A\u4E0D\u90A3\u4E48\u91CD\u8981\u7684\u90E8\u5206</p><p>\u76F8\u5F53\u4E8E\u53C2\u6570\u7248\u7684transitions\u3002</p><p>\u4E3E\u4F8B\uFF1A\u5982\u4E0B\u56FE\uFF0C\u5F53\u7528\u6237\u5728\u8F93\u5165\u6846\u8F93\u5165\u201C\u4E66\u201D\u7684\u65F6\u5019\uFF0C\u7528\u6237\u5E94\u8BE5\u7ACB\u9A6C\u770B\u5230\u8F93\u5165\u6846\u7684\u53CD\u5E94\uFF0C\u800C\u76F8\u6BD4\u4E4B\u4E0B\uFF0C\u4E0B\u9762\u7684\u6A21\u7CCA\u67E5\u8BE2\u6846\u5982\u679C\u5EF6\u8FDF\u51FA\u73B0\u4E00\u4F1A\u513F\u5176\u5B9E\u662F\u5B8C\u5168\u53EF\u4EE5\u63A5\u53D7\u7684\uFF0C\u56E0\u4E3A\u7528\u6237\u53EF\u80FD\u4F1A\u7EE7\u7EED\u4FEE\u6539\u8F93\u5165\u6846\u5185\u5BB9\uFF0C\u8FD9\u4E2A\u8FC7\u7A0B\u4E2D\u6A21\u7CCA\u67E5\u8BE2\u7ED3\u679C\u8FD8\u662F\u4F1A\u53D8\u5316\uFF0C\u4F46\u662F\u8FD9\u4E2A\u53D8\u5316\u5BF9\u7528\u6237\u6765\u8BF4\u76F8\u5BF9\u6CA1\u90A3\u4E48\u91CD\u8981\uFF0C\u7528\u6237\u6700\u5173\u5FC3\u7684\u662F\u770B\u5230\u6700\u540E\u7684\u5339\u914D\u7ED3\u679C\u3002</p><p><img src="`+e+`" alt="3.png"></p><p>\u7528\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#BD976A;">useDeferredValue</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">useState</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">react</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">MySlowList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../components/MySlowList</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">UseDeferredValuePage</span><span style="color:#666666;">(</span><span style="color:#BD976A;">props</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#BD976A;">text</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">setText</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useState</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">hello</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">deferredText</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useDeferredValue</span><span style="color:#666666;">(</span><span style="color:#BD976A;">text</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">handleChange</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">e</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0</span><span style="color:#80A665;">setText</span><span style="color:#666666;">(</span><span style="color:#BD976A;">e</span><span style="color:#666666;">.</span><span style="color:#BD976A;">target</span><span style="color:#666666;">.</span><span style="color:#BD976A;">value</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">h3</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">UseDeferredValuePage</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h3</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0  </span><span style="color:#666666;">{</span><span style="color:#758575DD;">/* \u4FDD\u6301\u5C06\u5F53\u524D\u6587\u672C\u4F20\u9012\u7ED9 input */</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">input</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">value</span><span style="color:#666666;">={</span><span style="color:#BD976A;">text</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">onChange</span><span style="color:#666666;">={</span><span style="color:#BD976A;">handleChange</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0  </span><span style="color:#666666;">{</span><span style="color:#758575DD;">/* \u4F46\u5728\u5FC5\u8981\u65F6\u53EF\u4EE5\u5C06\u5217\u8868\u201C\u5EF6\u540E\u201D */</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">p</span><span style="color:#666666;">&gt;{</span><span style="color:#BD976A;">deferredText</span><span style="color:#666666;">}&lt;/</span><span style="color:#4D9375;">p</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">MySlowList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">text</span><span style="color:#666666;">={</span><span style="color:#BD976A;">deferredText</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#B07D48;">useDeferredValue</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">useState</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">react</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">MySlowList</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../components/MySlowList</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">UseDeferredValuePage</span><span style="color:#999999;">(</span><span style="color:#B07D48;">props</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B07D48;">text</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">setText</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useState</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">hello</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">deferredText</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useDeferredValue</span><span style="color:#999999;">(</span><span style="color:#B07D48;">text</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#59873A;">handleChange</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">e</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0</span><span style="color:#59873A;">setText</span><span style="color:#999999;">(</span><span style="color:#B07D48;">e</span><span style="color:#999999;">.</span><span style="color:#B07D48;">target</span><span style="color:#999999;">.</span><span style="color:#B07D48;">value</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">h3</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">UseDeferredValuePage</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h3</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0  </span><span style="color:#999999;">{</span><span style="color:#A0ADA0;">/* \u4FDD\u6301\u5C06\u5F53\u524D\u6587\u672C\u4F20\u9012\u7ED9 input */</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">input</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">value</span><span style="color:#999999;">={</span><span style="color:#B07D48;">text</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">onChange</span><span style="color:#999999;">={</span><span style="color:#B07D48;">handleChange</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0  </span><span style="color:#999999;">{</span><span style="color:#A0ADA0;">/* \u4F46\u5728\u5FC5\u8981\u65F6\u53EF\u4EE5\u5C06\u5217\u8868\u201C\u5EF6\u540E\u201D */</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">p</span><span style="color:#999999;">&gt;{</span><span style="color:#B07D48;">deferredText</span><span style="color:#999999;">}&lt;/</span><span style="color:#1E754F;">p</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">MySlowList</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">text</span><span style="color:#999999;">={</span><span style="color:#B07D48;">deferredText</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><p>MySlowList:</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">React</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#BD976A;">memo</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">react</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">ListItem</span><span style="color:#666666;">({</span><span style="color:#BD976A;">children</span><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">now</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">performance</span><span style="color:#666666;">.</span><span style="color:#80A665;">now</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#4D9375;">while</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">performance</span><span style="color:#666666;">.</span><span style="color:#80A665;">now</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">-</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">now</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">3</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{}</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">div</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">className</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">ListItem</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;{</span><span style="color:#BD976A;">children</span><span style="color:#666666;">}&lt;/</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">memo</span><span style="color:#666666;">(</span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">MySlowList</span><span style="color:#666666;">({</span><span style="color:#BD976A;">text</span><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">items</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[];</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">i</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">i</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">80</span><span style="color:#666666;">;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">i</span><span style="color:#CB7676;">++</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0</span><span style="color:#BD976A;">items</span><span style="color:#666666;">.</span><span style="color:#80A665;">push</span><span style="color:#666666;">(</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">ListItem</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">key</span><span style="color:#666666;">={</span><span style="color:#BD976A;">i</span><span style="color:#666666;">}&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0  Result #</span><span style="color:#666666;">{</span><span style="color:#BD976A;">i</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> for &quot;</span><span style="color:#666666;">{</span><span style="color:#BD976A;">text</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">ListItem</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0  </span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0</span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">div</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">className</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">border</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">p</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">b</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">Results for &quot;</span><span style="color:#666666;">{</span><span style="color:#BD976A;">text</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;">&quot;:</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">b</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">p</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0 \xA0</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">ul</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">className</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">List</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;{</span><span style="color:#BD976A;">items</span><span style="color:#666666;">}&lt;/</span><span style="color:#4D9375;">ul</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> \xA0 \xA0</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">React</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#B07D48;">memo</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">react</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">ListItem</span><span style="color:#999999;">({</span><span style="color:#B07D48;">children</span><span style="color:#999999;">})</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">now</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">performance</span><span style="color:#999999;">.</span><span style="color:#59873A;">now</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#1E754F;">while</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">performance</span><span style="color:#999999;">.</span><span style="color:#59873A;">now</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">-</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">now</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">3</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{}</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">div</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">className</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">ListItem</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;{</span><span style="color:#B07D48;">children</span><span style="color:#999999;">}&lt;/</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#59873A;">memo</span><span style="color:#999999;">(</span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">MySlowList</span><span style="color:#999999;">({</span><span style="color:#B07D48;">text</span><span style="color:#999999;">})</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">items</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[];</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">i</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">i</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">80</span><span style="color:#999999;">;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">i</span><span style="color:#AB5959;">++</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0</span><span style="color:#B07D48;">items</span><span style="color:#999999;">.</span><span style="color:#59873A;">push</span><span style="color:#999999;">(</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">ListItem</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">key</span><span style="color:#999999;">={</span><span style="color:#B07D48;">i</span><span style="color:#999999;">}&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0  Result #</span><span style="color:#999999;">{</span><span style="color:#B07D48;">i</span><span style="color:#999999;">}</span><span style="color:#393A34;"> for &quot;</span><span style="color:#999999;">{</span><span style="color:#B07D48;">text</span><span style="color:#999999;">}</span><span style="color:#393A34;">&quot;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#998418;">ListItem</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0  </span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;"> \xA0</span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">div</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">className</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">border</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">p</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">b</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">Results for &quot;</span><span style="color:#999999;">{</span><span style="color:#B07D48;">text</span><span style="color:#999999;">}</span><span style="color:#393A34;">&quot;:</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">b</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">p</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0 \xA0</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">ul</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">className</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">List</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;{</span><span style="color:#B07D48;">items</span><span style="color:#999999;">}&lt;/</span><span style="color:#1E754F;">ul</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;"> \xA0 \xA0</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span></code></pre></div><h2 id="_8\u3001\u65B0\u7684hooks" tabindex="-1">8\u3001\u65B0\u7684Hooks <a class="header-anchor" href="#_8\u3001\u65B0\u7684hooks" aria-hidden="true">#</a></h2><p>\u5173\u4E8EuseTransition\u4E0EuseDeferredValue\u4E0A\u9762\u5DF2\u7ECF\u4ECB\u7ECD\u8FC7\u4E86\uFF0C\u63A5\u4E0B\u6765\u8BF4\u4E0BReact18\u5176\u5B83\u7684\u65B0Hooks\uFF0C\u5176\u4E2DuseSyncExternalStore\u4E0EuseInsertionEffect\u5C5E\u4E8ELibrary Hooks\u3002\u4E5F\u5C31\u662F\u666E\u901A\u5E94\u7528\u5F00\u53D1\u8005\u4E00\u822C\u7528\u4E0D\u5230\uFF0C\u8FD9\u4FE9\u4E3B\u8981\u7528\u4E8E\u90A3\u4E9B\u9700\u8981\u6DF1\u5EA6\u878D\u5408React\u6A21\u578B\u7684\u5E93\u5F00\u53D1\uFF0C\u6BD4\u5982Recoil\u7B49\u3002</p><h4 id="useid" tabindex="-1">useId <a class="header-anchor" href="#useid" aria-hidden="true">#</a></h4><p>\u7528\u4E8E\u4EA7\u751F\u4E00\u4E2A\u5728\u670D\u52A1\u7AEF\u4E0EWeb\u7AEF\u90FD\u7A33\u5B9A\u4E14\u552F\u4E00\u7684ID\uFF0C\u4E5F\u652F\u6301\u52A0\u524D\u7F00\uFF0C\u8FD9\u4E2A\u7279\u6027\u591A\u7528\u4E8E\u652F\u6301ssr\u7684\u73AF\u5883\u4E0B\uFF1A</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">NewHookApi</span><span style="color:#666666;">(</span><span style="color:#BD976A;">props</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">id</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useId</span><span style="color:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">h3</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">id</span><span style="color:#666666;">={</span><span style="color:#BD976A;">id</span><span style="color:#666666;">}&gt;</span><span style="color:#DBD7CAEE;">NewHookApi</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h3</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">NewHookApi</span><span style="color:#999999;">(</span><span style="color:#B07D48;">props</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">id</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useId</span><span style="color:#999999;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">h3</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">id</span><span style="color:#999999;">={</span><span style="color:#B07D48;">id</span><span style="color:#999999;">}&gt;</span><span style="color:#393A34;">NewHookApi</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h3</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>\u6CE8\u610F\uFF1AuseId\u4EA7\u751F\u7684ID\u4E0D\u652F\u6301css\u9009\u62E9\u5668\uFF0C\u5982querySelectorAll\u3002</p></div><h4 id="usesyncexternalstore" tabindex="-1">useSyncExternalStore <a class="header-anchor" href="#usesyncexternalstore" aria-hidden="true">#</a></h4><p><a href="https://react.dev/reference/react/useSyncExternalStore" target="_blank" rel="noreferrer">\u5B98\u65B9\u6307\u5357</a></p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">state</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useSyncExternalStore</span><span style="color:#666666;">(</span><span style="color:#BD976A;">subscribe</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">getSnapshot</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">getServerSnapshot</span><span style="color:#666666;">);</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">state</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useSyncExternalStore</span><span style="color:#999999;">(</span><span style="color:#B07D48;">subscribe</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">getSnapshot</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">getServerSnapshot</span><span style="color:#999999;">);</span></span>
<span class="line"></span></code></pre></div><p>\u6B64Hook\u7528\u4E8E\u5916\u90E8\u6570\u636E\u7684\u8BFB\u53D6\u4E0E\u8BA2\u9605\uFF0C\u53EF\u5E94\u7528Concurrent\u3002</p><p>\u57FA\u672C\u7528\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">useStore</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../store</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">useId</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">useSyncExternalStore</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">../whichReact</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">NewHookApi</span><span style="color:#666666;">(</span><span style="color:#BD976A;">props</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">store</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useStore</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">state</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useSyncExternalStore</span><span style="color:#666666;">(</span><span style="color:#BD976A;">store</span><span style="color:#666666;">.</span><span style="color:#BD976A;">subscribe</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">store</span><span style="color:#666666;">.</span><span style="color:#BD976A;">getSnapshot</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">h3</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">NewHookApi</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">h3</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">button</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">onClick</span><span style="color:#666666;">={()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">store</span><span style="color:#666666;">.</span><span style="color:#80A665;">dispatch</span><span style="color:#666666;">({</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">type</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">ADD</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">})}&gt;{</span><span style="color:#BD976A;">state</span><span style="color:#666666;">}&lt;/</span><span style="color:#4D9375;">button</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;">    </span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">useStore</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../store</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">useId</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">useSyncExternalStore</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">../whichReact</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">NewHookApi</span><span style="color:#999999;">(</span><span style="color:#B07D48;">props</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">store</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useStore</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">state</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useSyncExternalStore</span><span style="color:#999999;">(</span><span style="color:#B07D48;">store</span><span style="color:#999999;">.</span><span style="color:#B07D48;">subscribe</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">store</span><span style="color:#999999;">.</span><span style="color:#B07D48;">getSnapshot</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">h3</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">NewHookApi</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">h3</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">button</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">onClick</span><span style="color:#999999;">={()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">store</span><span style="color:#999999;">.</span><span style="color:#59873A;">dispatch</span><span style="color:#999999;">({</span><span style="color:#393A34;"> </span><span style="color:#998418;">type</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">ADD</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">})}&gt;{</span><span style="color:#B07D48;">state</span><span style="color:#999999;">}&lt;/</span><span style="color:#1E754F;">button</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">}</span><span style="color:#393A34;">    </span></span>
<span class="line"></span></code></pre></div><p>useStore\u662F\u6211\u53E6\u5916\u5B9A\u4E49\u7684\uFF0C</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useStore</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">storeRef</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useRef</span><span style="color:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#CB7676;">!</span><span style="color:#BD976A;">storeRef</span><span style="color:#666666;">.</span><span style="color:#BD976A;">current</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">storeRef</span><span style="color:#666666;">.</span><span style="color:#BD976A;">current</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">createStore</span><span style="color:#666666;">(</span><span style="color:#BD976A;">countReducer</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">storeRef</span><span style="color:#666666;">.</span><span style="color:#BD976A;">current</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">countReducer</span><span style="color:#666666;">(</span><span style="color:#BD976A;">action</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">state</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#4D9375;">switch</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">action</span><span style="color:#666666;">.</span><span style="color:#BD976A;">type</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">case</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">ADD</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">state</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">case</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">MINUS</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">state</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">-</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">default</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">state</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useStore</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">storeRef</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useRef</span><span style="color:#999999;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#AB5959;">!</span><span style="color:#B07D48;">storeRef</span><span style="color:#999999;">.</span><span style="color:#B07D48;">current</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">storeRef</span><span style="color:#999999;">.</span><span style="color:#B07D48;">current</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">createStore</span><span style="color:#999999;">(</span><span style="color:#B07D48;">countReducer</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">storeRef</span><span style="color:#999999;">.</span><span style="color:#B07D48;">current</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">countReducer</span><span style="color:#999999;">(</span><span style="color:#B07D48;">action</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">state</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#1E754F;">switch</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">action</span><span style="color:#999999;">.</span><span style="color:#B07D48;">type</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">case</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">ADD</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">state</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">case</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">MINUS</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">state</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">-</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">default</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">state</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><p>\u8FD9\u91CC\u7684createStore\u7528\u7684redux\u601D\u8DEF\uFF1A</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">createStore</span><span style="color:#666666;">(</span><span style="color:#BD976A;">reducer</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">currentState</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">listeners</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">getSnapshot</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">currentState</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">dispatch</span><span style="color:#666666;">(</span><span style="color:#BD976A;">action</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">currentState</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">reducer</span><span style="color:#666666;">(</span><span style="color:#BD976A;">action</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">currentState</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">listeners</span><span style="color:#666666;">.</span><span style="color:#80A665;">map</span><span style="color:#666666;">((</span><span style="color:#BD976A;">listener</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">listener</span><span style="color:#666666;">());</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">subscribe</span><span style="color:#666666;">(</span><span style="color:#BD976A;">listener</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">listeners</span><span style="color:#666666;">.</span><span style="color:#80A665;">push</span><span style="color:#666666;">(</span><span style="color:#BD976A;">listener</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">      </span><span style="color:#758575DD;">//   console.log(&quot;unmount&quot;, listeners);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">dispatch</span><span style="color:#666666;">({</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">type</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">TIANNA</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">getSnapshot</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">dispatch</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">subscribe</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">createStore</span><span style="color:#999999;">(</span><span style="color:#B07D48;">reducer</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">currentState</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">listeners</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">getSnapshot</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">currentState</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">dispatch</span><span style="color:#999999;">(</span><span style="color:#B07D48;">action</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">currentState</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">reducer</span><span style="color:#999999;">(</span><span style="color:#B07D48;">action</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">currentState</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">listeners</span><span style="color:#999999;">.</span><span style="color:#59873A;">map</span><span style="color:#999999;">((</span><span style="color:#B07D48;">listener</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#59873A;">listener</span><span style="color:#999999;">());</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">subscribe</span><span style="color:#999999;">(</span><span style="color:#B07D48;">listener</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">listeners</span><span style="color:#999999;">.</span><span style="color:#59873A;">push</span><span style="color:#999999;">(</span><span style="color:#B07D48;">listener</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">      </span><span style="color:#A0ADA0;">//   console.log(&quot;unmount&quot;, listeners);</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">dispatch</span><span style="color:#999999;">({</span><span style="color:#393A34;"> </span><span style="color:#998418;">type</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">TIANNA</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">getSnapshot</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">dispatch</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">subscribe</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><h4 id="useinsertioneffect" tabindex="-1">useInsertionEffect <a class="header-anchor" href="#useinsertioneffect" aria-hidden="true">#</a></h4><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#80A665;">useInsertionEffect</span><span style="color:#666666;">(</span><span style="color:#BD976A;">didUpdate</span><span style="color:#666666;">);</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#59873A;">useInsertionEffect</span><span style="color:#999999;">(</span><span style="color:#B07D48;">didUpdate</span><span style="color:#999999;">);</span></span>
<span class="line"></span></code></pre></div><p>\u51FD\u6570\u7B7E\u540D\u540CuseEffect\uFF0C\u4F46\u662F\u5B83\u662F\u5728\u6240\u6709DOM\u53D8\u66F4\u524D\u540C\u6B65\u89E6\u53D1\u3002\u4E3B\u8981\u7528\u4E8Ecss-in-js\u5E93\uFF0C\u5F80DOM\u4E2D\u52A8\u6001\u6CE8\u5165<code>&lt;style&gt;</code> \u6216\u8005 SVG <code>&lt;defs&gt;</code>\u3002\u56E0\u4E3A\u6267\u884C\u65F6\u673A\uFF0C\u56E0\u6B64\u4E0D\u53EF\u8BFB\u53D6refs\u3002</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useCSS</span><span style="color:#666666;">(</span><span style="color:#BD976A;">rule</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">useInsertionEffect</span><span style="color:#666666;">(()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#CB7676;">!</span><span style="color:#BD976A;">isInserted</span><span style="color:#666666;">.</span><span style="color:#80A665;">has</span><span style="color:#666666;">(</span><span style="color:#BD976A;">rule</span><span style="color:#666666;">))</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#BD976A;">isInserted</span><span style="color:#666666;">.</span><span style="color:#80A665;">add</span><span style="color:#666666;">(</span><span style="color:#BD976A;">rule</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#BD976A;">document</span><span style="color:#666666;">.</span><span style="color:#BD976A;">head</span><span style="color:#666666;">.</span><span style="color:#80A665;">appendChild</span><span style="color:#666666;">(</span><span style="color:#80A665;">getStyleForRule</span><span style="color:#666666;">(</span><span style="color:#BD976A;">rule</span><span style="color:#666666;">));</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">rule</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">Component</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">className</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">useCSS</span><span style="color:#666666;">(</span><span style="color:#BD976A;">rule</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">div</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">className</span><span style="color:#666666;">={</span><span style="color:#BD976A;">className</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useCSS</span><span style="color:#999999;">(</span><span style="color:#B07D48;">rule</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">useInsertionEffect</span><span style="color:#999999;">(()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#AB5959;">!</span><span style="color:#B07D48;">isInserted</span><span style="color:#999999;">.</span><span style="color:#59873A;">has</span><span style="color:#999999;">(</span><span style="color:#B07D48;">rule</span><span style="color:#999999;">))</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B07D48;">isInserted</span><span style="color:#999999;">.</span><span style="color:#59873A;">add</span><span style="color:#999999;">(</span><span style="color:#B07D48;">rule</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B07D48;">document</span><span style="color:#999999;">.</span><span style="color:#B07D48;">head</span><span style="color:#999999;">.</span><span style="color:#59873A;">appendChild</span><span style="color:#999999;">(</span><span style="color:#59873A;">getStyleForRule</span><span style="color:#999999;">(</span><span style="color:#B07D48;">rule</span><span style="color:#999999;">));</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">rule</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#59873A;">Component</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">className</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">useCSS</span><span style="color:#999999;">(</span><span style="color:#B07D48;">rule</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">div</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">className</span><span style="color:#999999;">={</span><span style="color:#B07D48;">className</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Freactwg%2Freact-18%2Fdiscussions%2F110" target="_blank" rel="noreferrer">\u8BE6\u7EC6\u6587\u7AE0</a></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>\u6CE8\u610F\uFF1Ahooks\u7684\u6267\u884C\u987A\u5E8F\u5148\u540E\u4E3A\uFF0CuseInsertionEffect \u3001useLayoutEffect\u3001useEffect \u3002</p></div>`,93),r=[c];function y(A,D,i,E,B,C){return a(),n("div",null,r)}const g=s(t,[["render",y]]);export{d as __pageData,g as default};
