<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基于 UniAPP 社区论坛项目多端开发实战 | Attraction11</title>
    <meta name="description" content="个人博客">
    <link rel="stylesheet" href="/assets/style.8a844edc.css">
    <link rel="modulepreload" href="/assets/app.417e51bc.js">
    <link rel="modulepreload" href="/assets/PanClient_UniApp_ProjectDemo.md.bbdf369d.lean.js">
    
    <link rel="icon" href="/docs-logo.png">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-04c1d245><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c9cfc3c4></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c9cfc3c4> Skip to content </a><!--]--><!----><header class="VPNav" data-v-04c1d245 data-v-ea4052b4><div class="VPNavBar has-sidebar" data-v-ea4052b4 data-v-36046f86><div class="container" data-v-36046f86><div class="VPNavBarTitle has-sidebar" data-v-36046f86 data-v-2ca9a22c><a class="title" href="/" data-v-2ca9a22c><!--[--><!--]--><!--[--><img class="VPImage logo" src="/docs-logo.png" alt data-v-265535e3><!--]--><!--[-->Attraction11<!--]--><!--[--><!--]--></a></div><div class="content" data-v-36046f86><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-36046f86 data-v-2129ae7b><span id="main-nav-aria-label" class="visually-hidden" data-v-2129ae7b>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-2129ae7b data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e95fa1e4><span class="text" data-v-e95fa1e4><!----> 前端基础 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-e95fa1e4><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><div class="items" data-v-d7943406><!--[--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/HTML&amp;CSS/" data-v-5a68840c data-v-7a3e2c60><!--[-->HTML&amp;CSS<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/Functional/" data-v-5a68840c data-v-7a3e2c60><!--[-->函数式编程<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/JSCore/" data-v-5a68840c data-v-7a3e2c60><!--[-->JS核心原理<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/Asynchronous/" data-v-5a68840c data-v-7a3e2c60><!--[-->JS异步编程<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/ESFeatures/" data-v-5a68840c data-v-7a3e2c60><!--[-->ES新特性<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/TypeScript/" data-v-5a68840c data-v-7a3e2c60><!--[-->TS语言<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/Performance/" data-v-5a68840c data-v-7a3e2c60><!--[-->性能优化<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/WebSafety/" data-v-5a68840c data-v-7a3e2c60><!--[-->网络与安全<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/Engineering/" data-v-5a68840c data-v-7a3e2c60><!--[-->项目工程化<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/Module/" data-v-5a68840c data-v-7a3e2c60><!--[-->杂记<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-2129ae7b data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e95fa1e4><span class="text" data-v-e95fa1e4><!----> 前端框架 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-e95fa1e4><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><div class="items" data-v-d7943406><!--[--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/Framework/Vue/Vue2.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Vue<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/Framework/React/React.html" data-v-5a68840c data-v-7a3e2c60><!--[-->React<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/Framework/Nuxt/ServeRender.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Nuxt<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/Framework/Next/NextJS.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Next<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/Framework/Gatsby/" data-v-5a68840c data-v-7a3e2c60><!--[-->Gatsby<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/Framework/Module/" data-v-5a68840c data-v-7a3e2c60><!--[-->杂记<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-2129ae7b data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e95fa1e4><span class="text" data-v-e95fa1e4><!----> 全栈开发 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-e95fa1e4><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><div class="items" data-v-d7943406><!--[--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/FullStack/Node/NodeBase.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Node.js<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/FullStack/DataBase/Mongodb.html" data-v-5a68840c data-v-7a3e2c60><!--[-->NoSQL数据库<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/FullStack/WebDev/Express.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Node.js开发框架<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/FullStack/GraphQL/" data-v-5a68840c data-v-7a3e2c60><!--[-->GraphQL API 开发<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/FullStack/Nginx/" data-v-5a68840c data-v-7a3e2c60><!--[-->Nginx 配置<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-2129ae7b data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e95fa1e4><span class="text" data-v-e95fa1e4><!----> 泛客户端开发 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-e95fa1e4><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><div class="items" data-v-d7943406><!--[--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/PanClient/UniApp/" data-v-5a68840c data-v-7a3e2c60><!--[-->UniApp<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/PanClient/RN/" data-v-5a68840c data-v-7a3e2c60><!--[-->React Native<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/PanClient/Flutter/WebCli.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Flutter<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/PanClient/Electron/WebCli.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Electron<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-2129ae7b data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e95fa1e4><span class="text" data-v-e95fa1e4><!----> 技术方案 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-e95fa1e4><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><div class="items" data-v-d7943406><!--[--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/ProgramTopics/MicroFrontend/WebCli.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Micro Frontend<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/ProgramTopics/TestAutomation/WebCli.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Test Automation<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/ProgramTopics/DataVisualization/WebCli.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Data Visualization<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/ProgramTopics/Serverless/WebCli.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Serverless<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/Sites.html" data-v-2129ae7b data-v-ebd9466a data-v-7a3e2c60><!--[-->宝藏网站<!--]--><!----></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-2129ae7b data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e95fa1e4><span class="text" data-v-e95fa1e4><!----> 随机文章 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-e95fa1e4><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><div class="items" data-v-d7943406><!--[--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/Git%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Git常用操作.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/Linux%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Linux基本命令.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/Nginx%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Nginx基本使用.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/RegExp%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8.html" data-v-5a68840c data-v-7a3e2c60><!--[-->RegExp介绍与使用.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/VsCode%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91.html" data-v-5a68840c data-v-7a3e2c60><!--[-->VsCode插件开发.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E5%8A%9B%E6%89%A3%E9%A2%98%E8%AE%B0%E5%BD%95.html" data-v-5a68840c data-v-7a3e2c60><!--[-->力扣题记录.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95.html" data-v-5a68840c data-v-7a3e2c60><!--[-->小程序开发记录.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE.html" data-v-5a68840c data-v-7a3e2c60><!--[-->常用快捷键.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95.html" data-v-5a68840c data-v-7a3e2c60><!--[-->排序算法.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E6%94%B6%E5%BD%95%E7%B2%BE%E9%80%89%E4%B9%A6%E7%B1%8D.html" data-v-5a68840c data-v-7a3e2c60><!--[-->收录精选书籍.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E7%BD%91%E7%BB%9C%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86.html" data-v-5a68840c data-v-7a3e2c60><!--[-->网络相关知识.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E9%9D%A2%E8%AF%95%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93.html" data-v-5a68840c data-v-7a3e2c60><!--[-->面试经验总结.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E9%9D%A2%E8%AF%95%E8%87%AA%E6%A3%80%E6%89%8B%E5%86%8C.html" data-v-5a68840c data-v-7a3e2c60><!--[-->面试自检手册.md<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-36046f86 data-v-01996bc4><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-01996bc4 data-v-aa122b2e data-v-4456f1e0><span class="check" data-v-4456f1e0><span class="icon" data-v-4456f1e0><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-aa122b2e><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-aa122b2e><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-36046f86 data-v-6fcdd6cc data-v-673831b0><!--[--><a class="VPSocialLink" href="https://github.com/attraction11" target="_blank" rel="noopener" data-v-673831b0 data-v-87c79f46><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-36046f86 data-v-4a619ef7 data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-e95fa1e4><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-e95fa1e4><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><!----><!--[--><!--[--><!----><div class="group" data-v-4a619ef7><div class="item appearance" data-v-4a619ef7><p class="label" data-v-4a619ef7>Appearance</p><div class="appearance-action" data-v-4a619ef7><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-4a619ef7 data-v-aa122b2e data-v-4456f1e0><span class="check" data-v-4456f1e0><span class="icon" data-v-4456f1e0><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-aa122b2e><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-aa122b2e><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-4a619ef7><div class="item social-links" data-v-4a619ef7><div class="VPSocialLinks social-links-list" data-v-4a619ef7 data-v-673831b0><!--[--><a class="VPSocialLink" href="https://github.com/attraction11" target="_blank" rel="noopener" data-v-673831b0 data-v-87c79f46><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-36046f86 data-v-e7032f7c><span class="container" data-v-e7032f7c><span class="top" data-v-e7032f7c></span><span class="middle" data-v-e7032f7c></span><span class="bottom" data-v-e7032f7c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-04c1d245 data-v-afebc1bf><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-afebc1bf><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-afebc1bf><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-afebc1bf>Menu</span></button><a class="top-link" href="#" data-v-afebc1bf> Return to top </a></div><aside class="VPSidebar" data-v-04c1d245 data-v-18c1c2a0><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18c1c2a0><span class="visually-hidden" id="sidebar-aria-label" data-v-18c1c2a0> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-18c1c2a0><section class="VPSidebarGroup collapsible" data-v-18c1c2a0 data-v-174c8078><div class="title" role="button" data-v-174c8078><h2 class="title-text" data-v-174c8078>UniApp</h2><div class="action" data-v-174c8078><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-174c8078><!--[--><!--[--><a class="VPLink link link" href="/PanClient/UniApp/" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>uniapp 基础</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link active" href="/PanClient/UniApp/ProjectDemo.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>uniapp 实战</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-18c1c2a0><section class="VPSidebarGroup collapsible" data-v-18c1c2a0 data-v-174c8078><div class="title" role="button" data-v-174c8078><h2 class="title-text" data-v-174c8078>React Native</h2><div class="action" data-v-174c8078><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-174c8078><!--[--><!--[--><a class="VPLink link link" href="/PanClient/RN/" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>React Native介绍</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/PanClient/RN/SetUp.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>React Native环境搭建</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/PanClient/RN/StyleSheet.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>StyleSheet 语法</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/PanClient/RN/Component.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>组件和API</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/PanClient/RN/Router&amp;Nav.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>路由与导航</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/PanClient/RN/Architecture.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>架构原理</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/PanClient/RN/ProjectDemo.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>RN 项目实践</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/PanClient/RN/RandomRecord.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>杂记</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-18c1c2a0><section class="VPSidebarGroup collapsible" data-v-18c1c2a0 data-v-174c8078><div class="title" role="button" data-v-174c8078><h2 class="title-text" data-v-174c8078>Flutter</h2><div class="action" data-v-174c8078><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-174c8078><!--[--><!--[--><a class="VPLink link link" href="/PanClient/Flutter/WebCli.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>框架设计与实现</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-18c1c2a0><section class="VPSidebarGroup collapsible" data-v-18c1c2a0 data-v-174c8078><div class="title" role="button" data-v-174c8078><h2 class="title-text" data-v-174c8078>Electron</h2><div class="action" data-v-174c8078><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-174c8078><!--[--><!--[--><a class="VPLink link link" href="/PanClient/Electron/WebCli.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>框架设计与实现</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-04c1d245 data-v-29a3e9f4><div class="VPDoc has-sidebar has-aside" data-v-29a3e9f4 data-v-97ada51d><div class="container" data-v-97ada51d><div class="aside" data-v-97ada51d><div class="aside-curtain" data-v-97ada51d></div><div class="aside-container" data-v-97ada51d><div class="aside-content" data-v-97ada51d><div class="VPDocAside" data-v-97ada51d data-v-2f38cef5><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-2f38cef5 data-v-6bc23c6e><div class="content" data-v-6bc23c6e><div class="outline-marker" data-v-6bc23c6e></div><div class="outline-title" data-v-6bc23c6e>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-6bc23c6e><span class="visually-hidden" id="doc-outline-aria-label" data-v-6bc23c6e> Table of Contents for current page </span><ul class="root" data-v-6bc23c6e data-v-7ea186a3><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-2f38cef5></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-97ada51d><div class="content-container" data-v-97ada51d><!--[--><!--]--><main class="main" data-v-97ada51d><div style="position:relative;" class="vp-doc _PanClient_UniApp_ProjectDemo" data-v-97ada51d><div><h1 id="基于-uniapp-社区论坛项目多端开发实战" tabindex="-1">基于 UniAPP 社区论坛项目多端开发实战 <a class="header-anchor" href="#基于-uniapp-社区论坛项目多端开发实战" aria-hidden="true">#</a></h1><p>学习目的：</p><blockquote><p>​ 通过学习，基于 Vue 、微信小程序、uniapp 开发框架，对标企业级「大前端」开发实践标准，从零到一构建社区论坛类客户端应用项目全流程， 输出相关 H5、微信小程序、安卓、IOS 多客户端应用。</p></blockquote><h2 id="一、项目准备" tabindex="-1">一、项目准备 <a class="header-anchor" href="#一、项目准备" aria-hidden="true">#</a></h2><h3 id="_1-1-项目业务逻辑介绍" tabindex="-1">1.1 项目业务逻辑介绍 <a class="header-anchor" href="#_1-1-项目业务逻辑介绍" aria-hidden="true">#</a></h3><p><strong>相关文档</strong></p><blockquote></blockquote><ol><li>API 接口文档，详情查阅《 ThinkSNS <a href="http://xn--zfrtn2qh81c5gc04cs6cd67c.md" target="_blank" rel="noreferrer">社区服务接口文档.md</a> 》</li><li>ThinkSNS 综合管理系统，开源代码 git 地址：<a href="https://gitee.com/joysapp/thinksns-plus" target="_blank" rel="noreferrer">https://gitee.com/joysapp/thinksns-plus</a></li><li>客户端小程序源代码 git 地址：<a href="https://gitee.com/buhehpc/jxsns.git" target="_blank" rel="noreferrer">https://gitee.com/buhehpc/jxsns.git</a></li></ol><p><strong>ThinkSNS 简介</strong></p><blockquote><p>ThinkSNS 是智士软件旗下的开源微博、社交系统，含微博、论坛、资讯、频道、商城、活动、定位、找人、直播、问答等一系列功能。</p><p>ThinkSNS 采用 PHP+MySQL 技术，核心（微博、用户系统）+ 多应用 + 多插件的产品模式，拥有 Web、H5、IOS、Android APP 以及微信、支付宝、百度等小程序多端服务场景。</p></blockquote><p><strong>ThinkSNS 服务</strong></p><blockquote><p>ThinkSNS 能够建立社交网站、微博平台、教育平台、商城系统、粉丝社区、知识社区、企业文化社区等多种互联网平台，是移动互联网创业的首选二次开发平台。</p></blockquote><p><strong>社区、论坛实践项目简介</strong></p><blockquote></blockquote><ol><li>基于 ThinkSNS 开源免费体系，搭建行业内基础 PGC、UGC 内容管理社区、论坛服务体系。</li><li>商家运营人员可以发布管理 PGC 资讯，管理用户、动态、广告等操作</li><li>客户端用户可以查阅、点赞、评论、分享相关动态资讯内容，可以自主发布、删除 UGC 内容、同步 UGC 内容审核 <blockquote><p><img src="/assets/1.7f796c4e.jpg" alt="1"></p></blockquote></li></ol><h3 id="_1-2-使用-uniapp-构建项目" tabindex="-1">1.2 使用 UniAPP 构建项目 <a class="header-anchor" href="#_1-2-使用-uniapp-构建项目" aria-hidden="true">#</a></h3><ol><li>使用 Hbuilder uni-app 默认空白模板构建项目 <code> study</code></li></ol><p><img src="/assets/2.d0537d70.jpg" alt="2"></p><ol start="2"><li>在 manifest.json 文件中配置微信小程序相关信息</li></ol><p><img src="/assets/3.8c58ed84.jpg" alt="2"></p><h3 id="_1-3-构建项目文件结构" tabindex="-1">1.3 构建项目文件结构 <a class="header-anchor" href="#_1-3-构建项目文件结构" aria-hidden="true">#</a></h3><ol><li>构建项目基础结构</li></ol><p><img src="/assets/5.bf0e48ce.jpg" alt="5"></p><ol start="2"><li>初始化基础页面及配置 <code>pages.json</code> Pages 路由</li></ol><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">pages</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;">: </span><span style="color:#666666;">[</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">//pages数组中第一项表示应用启动页，参考：https://uniapp.dcloud.io/collocation/pages</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">path</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">pages/index/index</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">style</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#758575DD;">// custorm 取消顶部的 navBar 显示</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">navigationStyle</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">custom</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">enablePullDownRefresh</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">},</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">path</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">pages/feeds/feeds</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">style</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">navigationBarTitleText</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">前端动态</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">enablePullDownRefresh</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">},</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">path</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">pages/me/me</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">style</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">navigationStyle</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">custom</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">enablePullDownRefresh</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">},</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">path</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">pages/webview/webview</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">style</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">navigationBarTitleText</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">enablePullDownRefresh</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">]</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">pages</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;">: </span><span style="color:#999999;">[</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">//pages数组中第一项表示应用启动页，参考：https://uniapp.dcloud.io/collocation/pages</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">path</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">pages/index/index</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">style</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A0ADA0;">// custorm 取消顶部的 navBar 显示</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">navigationStyle</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">custom</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">enablePullDownRefresh</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">},</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">path</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">pages/feeds/feeds</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">style</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">navigationBarTitleText</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">前端动态</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">enablePullDownRefresh</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">},</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">path</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">pages/me/me</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">style</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">navigationStyle</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">custom</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">enablePullDownRefresh</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">},</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">path</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">pages/webview/webview</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">style</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">navigationBarTitleText</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">enablePullDownRefresh</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#999999;">]</span></span>
<span class="line"></span></code></pre></div><h3 id="_1-4-配置页面-tabbar-导航" tabindex="-1">1.4 配置页面 TabBar 导航 <a class="header-anchor" href="#_1-4-配置页面-tabbar-导航" aria-hidden="true">#</a></h3><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">tabBar</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;">: </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">color</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">#000</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">selectedColor</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">#0050FF</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">list</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">iconPath</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">/static/tabbar-icons/index.png</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">selectedIconPath</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">/static/tabbar-icons/index_s.png</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">text</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">首页</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">pagePath</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">pages/index/index</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">iconPath</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">/static/tabbar-icons/feeds.png</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">selectedIconPath</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">/static/tabbar-icons/feeds_s.png</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">text</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">动态</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">pagePath</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">pages/feeds/feeds</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">iconPath</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">/static/tabbar-icons/me.png</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">selectedIconPath</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">/static/tabbar-icons/me_s.png</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">text</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">我的</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">pagePath</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">pages/me/me</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">tabBar</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;">: </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">color</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">#000</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">selectedColor</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">#0050FF</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">list</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">iconPath</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">/static/tabbar-icons/index.png</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">selectedIconPath</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">/static/tabbar-icons/index_s.png</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">text</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">首页</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">pagePath</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">pages/index/index</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">iconPath</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">/static/tabbar-icons/feeds.png</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">selectedIconPath</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">/static/tabbar-icons/feeds_s.png</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">text</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">动态</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">pagePath</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">pages/feeds/feeds</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">iconPath</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">/static/tabbar-icons/me.png</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">selectedIconPath</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">/static/tabbar-icons/me_s.png</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">text</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">我的</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">pagePath</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">pages/me/me</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="_1-5-使用-npm-引入-uview-ui-插件库" tabindex="-1">1.5 使用 npm 引入 uView UI 插件库 <a class="header-anchor" href="#_1-5-使用-npm-引入-uview-ui-插件库" aria-hidden="true">#</a></h3><ol><li>使用 HBuilder 导入插件 <a href="https://ext.dcloud.net.cn/plugin?id=1593" target="_blank" rel="noreferrer">uViewUI</a> 或者使用 npm 安装相关依赖（推荐使用 npm 安装）</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// 如果您的项目是HX创建的，根目录又没有package.json文件的话，请先执行如下命令：</span></span>
<span class="line"><span style="color:#BD976A;">npm</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">init</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">-</span><span style="color:#BD976A;">y</span></span>
<span class="line"><span style="color:#758575DD;">// 安装</span></span>
<span class="line"><span style="color:#BD976A;">npm</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">install</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">uview</span><span style="color:#CB7676;">-</span><span style="color:#BD976A;">ui</span></span>
<span class="line"><span style="color:#758575DD;">// 更新</span></span>
<span class="line"><span style="color:#BD976A;">npm</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">update</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">uview</span><span style="color:#CB7676;">-</span><span style="color:#BD976A;">ui</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// 如果您的项目是HX创建的，根目录又没有package.json文件的话，请先执行如下命令：</span></span>
<span class="line"><span style="color:#B07D48;">npm</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">init</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">-</span><span style="color:#B07D48;">y</span></span>
<span class="line"><span style="color:#A0ADA0;">// 安装</span></span>
<span class="line"><span style="color:#B07D48;">npm</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">install</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">uview</span><span style="color:#AB5959;">-</span><span style="color:#B07D48;">ui</span></span>
<span class="line"><span style="color:#A0ADA0;">// 更新</span></span>
<span class="line"><span style="color:#B07D48;">npm</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">update</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">uview</span><span style="color:#AB5959;">-</span><span style="color:#B07D48;">ui</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li><code>main.js</code>引入 uView 库</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// main.js</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">uView</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">uview-ui</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#BD976A;">Vue</span><span style="color:#666666;">.</span><span style="color:#80A665;">use</span><span style="color:#666666;">(</span><span style="color:#BD976A;">uView</span><span style="color:#666666;">);</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// main.js</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">uView</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">uview-ui</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#B07D48;">Vue</span><span style="color:#999999;">.</span><span style="color:#59873A;">use</span><span style="color:#999999;">(</span><span style="color:#B07D48;">uView</span><span style="color:#999999;">);</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>编辑器安装相关依赖 工具 — 插件安装 — scss 编译支持</li></ol><p><img src="/assets/4.bfd9025d.jpg" alt="3"></p><ol start="4"><li><code>App.vue</code>引入基础样式</li></ol><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">/* App.vue */</span></span>
<span class="line"><span style="color:#DBD7CAEE;">&lt;</span><span style="color:#4D9375;">style</span><span style="color:#DBD7CAEE;"> lang=&quot;scss&quot;</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#666666;">@</span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">uview-ui/index.scss</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">&lt;/</span><span style="color:#4D9375;">style</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">/* App.vue */</span></span>
<span class="line"><span style="color:#393A34;">&lt;</span><span style="color:#1E754F;">style</span><span style="color:#393A34;"> lang=&quot;scss&quot;</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#999999;">@</span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">uview-ui/index.scss</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">&lt;/</span><span style="color:#1E754F;">style</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"></span></code></pre></div><ol start="5"><li><code>uni.scss</code>引入全局 scss 变量文件</li></ol><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">/* uni.scss */</span></span>
<span class="line"><span style="color:#666666;">@</span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">uview-ui/theme.scss</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">/* uni.scss */</span></span>
<span class="line"><span style="color:#999999;">@</span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">uview-ui/theme.scss</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"></span></code></pre></div><ol start="6"><li><code>pages.json</code>配置 easycom 规则(按需引入)</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// pages.json</span></span>
<span class="line"><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">easycom</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;">: </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 下载安装的方式需要前面的&quot;@/&quot;，npm安装的方式无需&quot;@/&quot;</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// &quot;^u-(.*)&quot;: &quot;@/uview-ui/components/u-$1/u-$1.vue&quot;</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// npm安装方式</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">^u-(.*)</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">uview-ui/components/u-$1/u-$1.vue</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 此为本身已有的内容</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">pages</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;">: </span><span style="color:#666666;">[</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// ......</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// pages.json</span></span>
<span class="line"><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">easycom</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;">: </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 下载安装的方式需要前面的&quot;@/&quot;，npm安装的方式无需&quot;@/&quot;</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// &quot;^u-(.*)&quot;: &quot;@/uview-ui/components/u-$1/u-$1.vue&quot;</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// npm安装方式</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">^u-(.*)</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">uview-ui/components/u-$1/u-$1.vue</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 此为本身已有的内容</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">pages</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;">: </span><span style="color:#999999;">[</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// ......</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="二、首页功能实现" tabindex="-1">二、首页功能实现 <a class="header-anchor" href="#二、首页功能实现" aria-hidden="true">#</a></h2><h3 id="_2-1-首页-header-广告位轮播图功能实现" tabindex="-1">2.1 首页 header 广告位轮播图功能实现 <a class="header-anchor" href="#_2-1-首页-header-广告位轮播图功能实现" aria-hidden="true">#</a></h3><p>关键技术点：</p><ol><li>swiper 轮播器组件的使用</li><li>使用 this.$u.get/post 异步请求数据</li><li>使用 v-for 循环遍历渲染轮播内容</li></ol><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">&lt;!-- 页面 header 相关部分 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">&lt;view class=&quot;header-box&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#758575DD;">&lt;!-- 顶部广告位轮播图 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		&lt;swiper class=&quot;swiper&quot; :indicator-dots=&quot;false&quot; :autoplay=&quot;true&quot; :interval=&quot;2500&quot; :duration=&quot;500&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				&lt;swiper-item v-for=&quot;item in swiperAdList&quot; :key=&quot;item.id&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					&lt;navigator open-type=&quot;navigate&quot; :url=&quot; &#39;/pages/webview/webview?url=&#39;+item.link&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						&lt;image class=&quot;banner-swiper-img&quot; :src=&quot;item.image&quot; mode=&quot;aspectFill&quot; /&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					&lt;/navigator&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				&lt;/swiper-item&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		&lt;/swiper&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#758575DD;">&lt;!-- 遮罩使用弧形框 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		&lt;image class=&quot;crile&quot; src=&quot;@/static/crile.png&quot; mode=&quot;aspectFill&quot; /&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#758575DD;">&lt;!-- 两个选项按钮 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		&lt;view class=&quot;card-header&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				&lt;view class=&quot;card-one card-left&quot; @tap=&quot;gotoFeeds(&#39;/pages/feeds/feeds&#39;)&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					&lt;image class=&quot;img&quot; src=&quot;@/static/coffee.png&quot; mode=&quot;aspectFill&quot; /&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					&lt;view class=&quot;iright&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						&lt;view class=&quot;title&quot;&gt;精彩动态&lt;/view&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					&lt;/view&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				&lt;/view&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				&lt;view class=&quot;card-one card-right&quot; @tap=&quot;gotoFeeds(&#39;/pages/me/me&#39;)&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					&lt;image class=&quot;img&quot; src=&quot;@/static/ran.png&quot; mode=&quot;aspectFill&quot; /&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					&lt;view class=&quot;iright&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						&lt;view class=&quot;title&quot;&gt;个人中心&lt;/view&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					&lt;/view&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				&lt;/view&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		&lt;/view&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#758575DD;">&lt;!-- Tab 选项卡 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		&lt;view class=&quot;tabs-box&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		&lt;view class=&quot;one-nav&quot; :class=&quot;currentSwiperIndex === 0 ? &#39;nav-actived&#39; : &#39;&#39; &quot; @tap=&quot;swiperChange(0)&quot;&gt;推荐&lt;/view&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		&lt;view class=&quot;one-nav&quot; :class=&quot;currentSwiperIndex === 1 ? &#39;nav-actived&#39; : &#39;&#39; &quot; @tap=&quot;swiperChange(1)&quot;&gt;资讯&lt;/view&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	&lt;/view&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">&lt;/view&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">script</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 请求 广告轮播图信息</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#BD976A;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">getAdverts</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">adverts</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">getAdvert</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">space</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">1,2,3</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">})</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperAdList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">adverts</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#80A665;">map</span><span style="color:#666666;">(</span><span style="color:#BD976A;">item</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					return {</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#B8A965;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#B8A965;">link</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">link</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#B8A965;">image</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">image</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				}</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">script</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">&lt;!-- 页面 header 相关部分 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">&lt;view class=&quot;header-box&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#A0ADA0;">&lt;!-- 顶部广告位轮播图 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">		&lt;swiper class=&quot;swiper&quot; :indicator-dots=&quot;false&quot; :autoplay=&quot;true&quot; :interval=&quot;2500&quot; :duration=&quot;500&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">				&lt;swiper-item v-for=&quot;item in swiperAdList&quot; :key=&quot;item.id&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">					&lt;navigator open-type=&quot;navigate&quot; :url=&quot; &#39;/pages/webview/webview?url=&#39;+item.link&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">						&lt;image class=&quot;banner-swiper-img&quot; :src=&quot;item.image&quot; mode=&quot;aspectFill&quot; /&gt;</span></span>
<span class="line"><span style="color:#393A34;">					&lt;/navigator&gt;</span></span>
<span class="line"><span style="color:#393A34;">				&lt;/swiper-item&gt;</span></span>
<span class="line"><span style="color:#393A34;">		&lt;/swiper&gt;</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#A0ADA0;">&lt;!-- 遮罩使用弧形框 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">		&lt;image class=&quot;crile&quot; src=&quot;@/static/crile.png&quot; mode=&quot;aspectFill&quot; /&gt;</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#A0ADA0;">&lt;!-- 两个选项按钮 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">		&lt;view class=&quot;card-header&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">				&lt;view class=&quot;card-one card-left&quot; @tap=&quot;gotoFeeds(&#39;/pages/feeds/feeds&#39;)&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">					&lt;image class=&quot;img&quot; src=&quot;@/static/coffee.png&quot; mode=&quot;aspectFill&quot; /&gt;</span></span>
<span class="line"><span style="color:#393A34;">					&lt;view class=&quot;iright&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">						&lt;view class=&quot;title&quot;&gt;精彩动态&lt;/view&gt;</span></span>
<span class="line"><span style="color:#393A34;">					&lt;/view&gt;</span></span>
<span class="line"><span style="color:#393A34;">				&lt;/view&gt;</span></span>
<span class="line"><span style="color:#393A34;">				&lt;view class=&quot;card-one card-right&quot; @tap=&quot;gotoFeeds(&#39;/pages/me/me&#39;)&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">					&lt;image class=&quot;img&quot; src=&quot;@/static/ran.png&quot; mode=&quot;aspectFill&quot; /&gt;</span></span>
<span class="line"><span style="color:#393A34;">					&lt;view class=&quot;iright&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">						&lt;view class=&quot;title&quot;&gt;个人中心&lt;/view&gt;</span></span>
<span class="line"><span style="color:#393A34;">					&lt;/view&gt;</span></span>
<span class="line"><span style="color:#393A34;">				&lt;/view&gt;</span></span>
<span class="line"><span style="color:#393A34;">		&lt;/view&gt;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#A0ADA0;">&lt;!-- Tab 选项卡 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">		&lt;view class=&quot;tabs-box&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">		&lt;view class=&quot;one-nav&quot; :class=&quot;currentSwiperIndex === 0 ? &#39;nav-actived&#39; : &#39;&#39; &quot; @tap=&quot;swiperChange(0)&quot;&gt;推荐&lt;/view&gt;</span></span>
<span class="line"><span style="color:#393A34;">		&lt;view class=&quot;one-nav&quot; :class=&quot;currentSwiperIndex === 1 ? &#39;nav-actived&#39; : &#39;&#39; &quot; @tap=&quot;swiperChange(1)&quot;&gt;资讯&lt;/view&gt;</span></span>
<span class="line"><span style="color:#393A34;">	&lt;/view&gt;</span></span>
<span class="line"><span style="color:#393A34;">&lt;/view&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">script</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 请求 广告轮播图信息</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#B07D48;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">getAdverts</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">adverts</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">getAdvert</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">space</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">1,2,3</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">})</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperAdList</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">adverts</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#59873A;">map</span><span style="color:#999999;">(</span><span style="color:#B07D48;">item</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">					return {</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#998418;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#998418;">link</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">link</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#998418;">image</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">image</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">				}</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">script</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="_2-2-全局配置-webview-展示第三方-web-页面" tabindex="-1">2.2 全局配置 WebView 展示第三方 web 页面 <a class="header-anchor" href="#_2-2-全局配置-webview-展示第三方-web-页面" aria-hidden="true">#</a></h3><p>关键技术点：我们通常为整个应用的 Web H5 相关页面，构建一个专门用来展示的 webview 路由页面，但是要注意路由传参的时候，对应的 url 需要 decodeURI 、encodeURI</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">web-view</span><span style="color:#666666;"> :</span><span style="color:#BD976A;">src</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">url</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> /&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">script</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">data</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">url</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 接收传递过来的参数地址，将 web-view 相关页面展开集合到一个地方</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">onLoad</span><span style="color:#666666;">(</span><span style="color:#BD976A;">options</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">url</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">decodeURI</span><span style="color:#666666;">(</span><span style="color:#BD976A;">options</span><span style="color:#666666;">.</span><span style="color:#BD976A;">url</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">script</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">web-view</span><span style="color:#999999;"> :</span><span style="color:#B07D48;">src</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">url</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> /&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">script</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">data</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">url</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 接收传递过来的参数地址，将 web-view 相关页面展开集合到一个地方</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">onLoad</span><span style="color:#999999;">(</span><span style="color:#B07D48;">options</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">url</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">decodeURI</span><span style="color:#999999;">(</span><span style="color:#B07D48;">options</span><span style="color:#999999;">.</span><span style="color:#B07D48;">url</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">script</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="_2-3-uviewui-网络-http-请求及-api-集中管理" tabindex="-1">2.3 uViewUI 网络 http 请求及 API 集中管理 <a class="header-anchor" href="#_2-3-uviewui-网络-http-请求及-api-集中管理" aria-hidden="true">#</a></h3><ol><li>请求头、拦截、返回 <code>/common/http.interceptor.js</code> 相关配置</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// 这里的vm，就是我们在vue文件里面的this，所以我们能在这里获取vuex的变量，比如存放在里面的token变量</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">install</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">Vue</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">vm</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 此为自定义配置参数，具体参数见上方说明</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    Vue.prototype.$u.http.setConfig({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">baseUrl</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">http://47.115.83.135/api/v2</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// 请求的本域名</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">dataType</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">json</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// 设置为json，返回后会对数据进行一次JSON.parse()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">showLoading</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// 是否显示请求中的loading</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">loadingText</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">请求中...</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// 请求loading中的文字提示</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">loadingTime</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">800</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// 在此时间内，请求还没回来的话，就显示加载中动画，单位ms</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">originalData</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// 是否在拦截器中返回服务端的原始数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">loadingMask</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// 展示loading的时候，是否给一个透明的蒙层，防止触摸穿透</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 配置请求头信息</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">header</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">content-type</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">application/json;charset=UTF-8</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;">)</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 请求拦截，配置Token等参数</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">Vue</span><span style="color:#666666;">.</span><span style="color:#B8A965;">prototype</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">http</span><span style="color:#666666;">.</span><span style="color:#BD976A;">interceptor</span><span style="color:#666666;">.</span><span style="color:#BD976A;">request</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">config</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 引用token</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 方式一，存放在vuex的token，假设使用了uView封装的vuex方式</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 见：https://uviewui.com/components/globalVariable.html</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// config.header.token = vm.token;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 方式二，如果没有使用uView封装的vuex方法，那么需要使用$store.state获取</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// config.header.token = vm.$store.state.token;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 方式三，如果token放在了globalData，通过getApp().globalData获取</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// config.header.token = getApp().globalData.username;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 方式四，如果token放在了Storage本地存储中，拦截是每次请求都执行的</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 所以哪怕您重新登录修改了Storage，下一次的请求将会是最新值</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// const token = uni.getStorageSync(&#39;token&#39;);</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// config.header.token = token;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        config.header.</span><span style="color:#BD976A;">Token</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">xxxxxx</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 可以对某个url进行特别处理，此url参数为this.$u.get(url)中的url值</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// if(config.url == &#39;/user/login&#39;) config.header.noToken = true;</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 最后需要将config进行return</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        return config;</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 如果return一个false值，则会取消本次请求</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// if(config.url == &#39;/user/rest&#39;) return false; // 取消某次请求</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 响应拦截，判断状态码是否通过</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">Vue</span><span style="color:#666666;">.</span><span style="color:#B8A965;">prototype</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">http</span><span style="color:#666666;">.</span><span style="color:#BD976A;">interceptor</span><span style="color:#666666;">.</span><span style="color:#BD976A;">response</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">res</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#80A665;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">res.code == 401</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 如果返回false，则会调用Promise的reject回调，</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 并将进入this.$u.post(url).then().catch(res=&gt;{})的catch回调中，res为服务端的返回值</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">vm</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#80A665;">toast</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">当前请求 API 接口不存在</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> else {</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// res为服务端返回值，可能有code，result等字段</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 这里对res.result进行返回，将会在this.$u.post(url).then(res ={})的then回调中的res的到</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 如果配置了originalData为true，请留意这里的返回值</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            return res;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    }</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">}</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">install</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// 这里的vm，就是我们在vue文件里面的this，所以我们能在这里获取vuex的变量，比如存放在里面的token变量</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">install</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">Vue</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">vm</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 此为自定义配置参数，具体参数见上方说明</span></span>
<span class="line"><span style="color:#393A34;">    Vue.prototype.$u.http.setConfig({</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">baseUrl</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">http://47.115.83.135/api/v2</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// 请求的本域名</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">dataType</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">json</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// 设置为json，返回后会对数据进行一次JSON.parse()</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">showLoading</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// 是否显示请求中的loading</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">loadingText</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">请求中...</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// 请求loading中的文字提示</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">loadingTime</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">800</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// 在此时间内，请求还没回来的话，就显示加载中动画，单位ms</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">originalData</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// 是否在拦截器中返回服务端的原始数据</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">loadingMask</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// 展示loading的时候，是否给一个透明的蒙层，防止触摸穿透</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 配置请求头信息</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">header</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">content-type</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">application/json;charset=UTF-8</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span><span style="color:#393A34;">)</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 请求拦截，配置Token等参数</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">Vue</span><span style="color:#999999;">.</span><span style="color:#998418;">prototype</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">http</span><span style="color:#999999;">.</span><span style="color:#B07D48;">interceptor</span><span style="color:#999999;">.</span><span style="color:#B07D48;">request</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">config</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 引用token</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 方式一，存放在vuex的token，假设使用了uView封装的vuex方式</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 见：https://uviewui.com/components/globalVariable.html</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// config.header.token = vm.token;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 方式二，如果没有使用uView封装的vuex方法，那么需要使用$store.state获取</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// config.header.token = vm.$store.state.token;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 方式三，如果token放在了globalData，通过getApp().globalData获取</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// config.header.token = getApp().globalData.username;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 方式四，如果token放在了Storage本地存储中，拦截是每次请求都执行的</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 所以哪怕您重新登录修改了Storage，下一次的请求将会是最新值</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// const token = uni.getStorageSync(&#39;token&#39;);</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// config.header.token = token;</span></span>
<span class="line"><span style="color:#393A34;">        config.header.</span><span style="color:#B07D48;">Token</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">xxxxxx</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 可以对某个url进行特别处理，此url参数为this.$u.get(url)中的url值</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// if(config.url == &#39;/user/login&#39;) config.header.noToken = true;</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 最后需要将config进行return</span></span>
<span class="line"><span style="color:#393A34;">        return config;</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 如果return一个false值，则会取消本次请求</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// if(config.url == &#39;/user/rest&#39;) return false; // 取消某次请求</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 响应拦截，判断状态码是否通过</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">Vue</span><span style="color:#999999;">.</span><span style="color:#998418;">prototype</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">http</span><span style="color:#999999;">.</span><span style="color:#B07D48;">interceptor</span><span style="color:#999999;">.</span><span style="color:#B07D48;">response</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">res</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#59873A;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#393A34;">res.code == 401</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 如果返回false，则会调用Promise的reject回调，</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 并将进入this.$u.post(url).then().catch(res=&gt;{})的catch回调中，res为服务端的返回值</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">vm</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#59873A;">toast</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">当前请求 API 接口不存在</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">}</span><span style="color:#393A34;"> else {</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// res为服务端返回值，可能有code，result等字段</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 这里对res.result进行返回，将会在this.$u.post(url).then(res ={})的then回调中的res的到</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 如果配置了originalData为true，请留意这里的返回值</span></span>
<span class="line"><span style="color:#393A34;">            return res;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">    }</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">}</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">install</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>请求 API 集中管理 <code>/common/http.api.js</code></li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// 此处第二个参数vm，就是我们在页面使用的this，你可以通过vm获取vuex等操作，更多内容详见uView对拦截器的介绍部分：</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">install</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">Vue</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">vm</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    let </span><span style="color:#BD976A;">api</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{}</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 获取广告位列表信息</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    api.</span><span style="color:#80A665;">getAdvert</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">params</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#BD976A;">vm</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#80A665;">get</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">/advertisingspace/advertising</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">params</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 获取动态列表信息</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    api.</span><span style="color:#BD976A;">getFeeds</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">params</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#BD976A;">vm</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#80A665;">get</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">/feeds</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">params</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 获取资讯列表信息</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    api.</span><span style="color:#BD976A;">getNews</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">params</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#BD976A;">vm</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#80A665;">get</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">/news</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">params</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 将各个定义的接口名称，统一放进对象挂载到vm.$u.api(因为vm就是this，也即this.$u.api)下</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    vm.$u.</span><span style="color:#BD976A;">api</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">api</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">install</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// 此处第二个参数vm，就是我们在页面使用的this，你可以通过vm获取vuex等操作，更多内容详见uView对拦截器的介绍部分：</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">install</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">Vue</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">vm</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">    let </span><span style="color:#B07D48;">api</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{}</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 获取广告位列表信息</span></span>
<span class="line"><span style="color:#393A34;">    api.</span><span style="color:#59873A;">getAdvert</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">params</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B07D48;">vm</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#59873A;">get</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">/advertisingspace/advertising</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">params</span><span style="color:#999999;">)</span><span style="color:#393A34;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 获取动态列表信息</span></span>
<span class="line"><span style="color:#393A34;">    api.</span><span style="color:#B07D48;">getFeeds</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">params</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#B07D48;">vm</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#59873A;">get</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">/feeds</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">params</span><span style="color:#999999;">)</span><span style="color:#393A34;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 获取资讯列表信息</span></span>
<span class="line"><span style="color:#393A34;">    api.</span><span style="color:#B07D48;">getNews</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">params</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#B07D48;">vm</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#59873A;">get</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">/news</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">params</span><span style="color:#999999;">)</span><span style="color:#393A34;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 将各个定义的接口名称，统一放进对象挂载到vm.$u.api(因为vm就是this，也即this.$u.api)下</span></span>
<span class="line"><span style="color:#393A34;">    vm.$u.</span><span style="color:#B07D48;">api</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">api</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">install</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>在 main.js 中配置，插件注册第二个参数 app 要传入到实例中去，所以要注意引入顺序</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">app</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">Vue</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">...</span><span style="color:#BD976A;">App</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#758575DD;">// http拦截器，此为需要加入的内容，如果不是写在common目录，请自行修改引入路径</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">httpInterceptor</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">@/common/http.interceptor.js</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#758575DD;">// 这里需要写在最后，是为了等Vue创建对象完成，引入&quot;app&quot;对象(也即页面的&quot;this&quot;实例)</span></span>
<span class="line"><span style="color:#BD976A;">Vue</span><span style="color:#666666;">.</span><span style="color:#80A665;">use</span><span style="color:#666666;">(</span><span style="color:#BD976A;">httpInterceptor</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">app</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#758575DD;">// http接口API集中管理引入部分</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">httpApi</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">@/common/http.api.js</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#BD976A;">Vue</span><span style="color:#666666;">.</span><span style="color:#80A665;">use</span><span style="color:#666666;">(</span><span style="color:#BD976A;">httpApi</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">app</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#BD976A;">app</span><span style="color:#666666;">.</span><span style="color:#80A665;">$mount</span><span style="color:#666666;">();</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">app</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">Vue</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">...</span><span style="color:#B07D48;">App</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#A0ADA0;">// http拦截器，此为需要加入的内容，如果不是写在common目录，请自行修改引入路径</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">httpInterceptor</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">@/common/http.interceptor.js</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#A0ADA0;">// 这里需要写在最后，是为了等Vue创建对象完成，引入&quot;app&quot;对象(也即页面的&quot;this&quot;实例)</span></span>
<span class="line"><span style="color:#B07D48;">Vue</span><span style="color:#999999;">.</span><span style="color:#59873A;">use</span><span style="color:#999999;">(</span><span style="color:#B07D48;">httpInterceptor</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">app</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#A0ADA0;">// http接口API集中管理引入部分</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">httpApi</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">@/common/http.api.js</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#B07D48;">Vue</span><span style="color:#999999;">.</span><span style="color:#59873A;">use</span><span style="color:#999999;">(</span><span style="color:#B07D48;">httpApi</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">app</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#B07D48;">app</span><span style="color:#999999;">.</span><span style="color:#59873A;">$mount</span><span style="color:#999999;">();</span></span>
<span class="line"></span></code></pre></div><h3 id="_2-4-首页推荐、资讯模块平滑切换效果实现" tabindex="-1">2.4 首页推荐、资讯模块平滑切换效果实现 <a class="header-anchor" href="#_2-4-首页推荐、资讯模块平滑切换效果实现" aria-hidden="true">#</a></h3><p>关键技术点：</p><ol><li>使用轮播器，不自动播放，来构建一个左右滑动切换页面的效果</li><li>需要注意的是，轮播器的高度要设置一个固定值</li></ol><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">&lt;!-- 内容轮播导航实现 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">&lt;swiper class=&quot;swiper-box&quot; style=&quot;height:1000upx&quot; :current=&quot;0&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#758575DD;">&lt;!-- 推荐动态实现 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			&lt;swiper-item class=&quot;swiper-item sns-now&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					&lt;view class=&quot;feeds-box&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						...动态页面瀑布流展示</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					&lt;/view&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			&lt;/swiper-item&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#758575DD;">&lt;!-- 资讯列表实现 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			&lt;swiper-item class=&quot;swiper-item sns-news&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				&lt;view v-for=&quot;(item, index) in newsList&quot; :key=&quot;index&quot;&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					...资讯页面列表展示</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				&lt;/view&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			&lt;/swiper-item&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		&lt;/swiper&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">&lt;!-- 内容轮播导航实现 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">&lt;swiper class=&quot;swiper-box&quot; style=&quot;height:1000upx&quot; :current=&quot;0&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#A0ADA0;">&lt;!-- 推荐动态实现 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">			&lt;swiper-item class=&quot;swiper-item sns-now&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">					&lt;view class=&quot;feeds-box&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">						...动态页面瀑布流展示</span></span>
<span class="line"><span style="color:#393A34;">					&lt;/view&gt;</span></span>
<span class="line"><span style="color:#393A34;">			&lt;/swiper-item&gt;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#A0ADA0;">&lt;!-- 资讯列表实现 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">			&lt;swiper-item class=&quot;swiper-item sns-news&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">				&lt;view v-for=&quot;(item, index) in newsList&quot; :key=&quot;index&quot;&gt;</span></span>
<span class="line"><span style="color:#393A34;">					...资讯页面列表展示</span></span>
<span class="line"><span style="color:#393A34;">				&lt;/view&gt;</span></span>
<span class="line"><span style="color:#393A34;">			&lt;/swiper-item&gt;</span></span>
<span class="line"><span style="color:#393A34;">		&lt;/swiper&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="_2-5-首页推荐瀑布流布局效果实现" tabindex="-1">2.5 首页推荐瀑布流布局效果实现 <a class="header-anchor" href="#_2-5-首页推荐瀑布流布局效果实现" aria-hidden="true">#</a></h3><p>瀑布流布局其核心是基于一个网格的布局，而且每行包含的项目列表高度是随机的（随着自己内容动态变化高度），同时每个项目列表呈堆栈形式排列，最为关键的是，堆栈之间彼此之间没有多余的间距差存大。</p><p>实现瀑布流的解决方案，可以使用 CSS3 布局来实现，也可以使用 JS 脚本来实现，使用 CSS3 实现代码如下：</p><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">/*</span></span>
<span class="line"><span style="color:#758575DD;">  这里的关键属性是column-count，设置列数为2。然后是break-inside:avoid，为了控制文本块分解成单独的列，以免项目列表的内容跨列，破坏整体的布局，这样就实现了瀑布流布局。</span></span>
<span class="line"><span style="color:#758575DD;">*/</span></span>
<span class="line"><span style="color:#666666;">.</span><span style="color:#BD976A;">waterfall</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">width</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">80</span><span style="color:#CB7676;">%</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">margin</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">auto</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;">/* 瀑布流容器内元素的间隔 */</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">column-gap</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">10</span><span style="color:#CB7676;">px</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;">/* 瀑布容器内排列的列数 */</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">column-count</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">2</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">.</span><span style="color:#BD976A;">item</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">padding</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">10</span><span style="color:#CB7676;">px</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">margin-bottom</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">10</span><span style="color:#CB7676;">px</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;">/* avoid避免在主体框中插入任何中断（页面，列或区域） */</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">break-inside</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">avoid</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">/*</span></span>
<span class="line"><span style="color:#A0ADA0;">  这里的关键属性是column-count，设置列数为2。然后是break-inside:avoid，为了控制文本块分解成单独的列，以免项目列表的内容跨列，破坏整体的布局，这样就实现了瀑布流布局。</span></span>
<span class="line"><span style="color:#A0ADA0;">*/</span></span>
<span class="line"><span style="color:#999999;">.</span><span style="color:#B07D48;">waterfall</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">width</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">80</span><span style="color:#AB5959;">%</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">margin</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">auto</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;">/* 瀑布流容器内元素的间隔 */</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">column-gap</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">10</span><span style="color:#AB5959;">px</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;">/* 瀑布容器内排列的列数 */</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">column-count</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">2</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">.</span><span style="color:#B07D48;">item</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">padding</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">10</span><span style="color:#AB5959;">px</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">margin-bottom</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">10</span><span style="color:#AB5959;">px</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;">/* avoid避免在主体框中插入任何中断（页面，列或区域） */</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">break-inside</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">avoid</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><p>使用 CSS3 实现瀑布流布局，性能高于 js，jq，缺点是用户体验差，比如：移除数据、更新数据会造成整个页面结构的复杂变化，让用户突然失去焦点的感觉非常不友好！所以使用 js 实现优势也是比较明显的，我们这里使用 uViewUI 的瀑布流插件来实现</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-waterfall</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">v-model</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">flowList</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ref</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">uWaterfall</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">template</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">v-slot:left</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">{leftList}</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">view</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">v-for</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">(item, index) in leftList</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">:key</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">index</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#758575DD;">&lt;!-- 这里编写您的内容，item为您传递给v-model的数组元素 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;/</span><span style="color:#FDAEB7;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">template</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">v-slot:right</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">{rightList}</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">view</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">v-for</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">(item, index) in rightList</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">:key</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">index</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#758575DD;">&lt;!-- 这里编写您的内容，item为您传递给v-model的数组元素 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;/</span><span style="color:#FDAEB7;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">u-waterfall</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">script</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">methods</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#80A665;">remove</span><span style="color:#666666;">(</span><span style="color:#BD976A;">id</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$refs</span><span style="color:#666666;">.</span><span style="color:#BD976A;">uWaterfall</span><span style="color:#666666;">.</span><span style="color:#80A665;">remove</span><span style="color:#666666;">(</span><span style="color:#BD976A;">id</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#80A665;">clear</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$refs</span><span style="color:#666666;">.</span><span style="color:#BD976A;">uWaterfall</span><span style="color:#666666;">.</span><span style="color:#80A665;">clear</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">script</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-waterfall</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">v-model</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">flowList</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ref</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">uWaterfall</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">template</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">v-slot:left</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">{leftList}</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">view</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">v-for</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">(item, index) in leftList</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">:key</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">index</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#A0ADA0;">&lt;!-- 这里编写您的内容，item为您传递给v-model的数组元素 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;/</span><span style="color:#B31D28;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">template</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">v-slot:right</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">{rightList}</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">view</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">v-for</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">(item, index) in rightList</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">:key</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">index</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#A0ADA0;">&lt;!-- 这里编写您的内容，item为您传递给v-model的数组元素 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;/</span><span style="color:#B31D28;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">u-waterfall</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">script</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">methods</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#59873A;">remove</span><span style="color:#999999;">(</span><span style="color:#B07D48;">id</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$refs</span><span style="color:#999999;">.</span><span style="color:#B07D48;">uWaterfall</span><span style="color:#999999;">.</span><span style="color:#59873A;">remove</span><span style="color:#999999;">(</span><span style="color:#B07D48;">id</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#59873A;">clear</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$refs</span><span style="color:#999999;">.</span><span style="color:#B07D48;">uWaterfall</span><span style="color:#999999;">.</span><span style="color:#59873A;">clear</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">script</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>PS ：swiper 实现 滑动切换页面的效果需要设置一个固定的高度值，但是咱们瀑布流的高度是未知的，那么该怎么办呢？iViewUI 中的 u-waterfall 源码分析，我们要通过全局事件设置的方式来动态的设置 高度，同时，咱们这个定制化的 u-waterfall 需要单独再拿出来进行使用，拓展咱们定制化的插件</p><ol><li><p>在 uViewUI 中创建一个自定义使用的 u-waterfall-sns.vue 插件，主要分为三步：</p><ul><li>在 uViewUI 组件库 components 中找到 u-waterfall 文件，复制一份命名为 u-waterfall-sns</li><li>文件内 u-waterfall.vue 插件，复制一份命名为 u-waterfall-sns.vue 插件</li><li>u-waterfall-sns.vue 插件内，name 属性更改为 u-waterfall-sns，就可以调用咱们拓展出来的插件了</li></ul></li><li><p>使用 uni.$on 设置全局事件，在 u-waterfall-sns.vue 插件内部瀑布流渲染完毕后触发这个事件，动态修改首页轮播切换页面内的 swiper 高度</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#80A665;">data</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">				</span><span style="color:#758575DD;">// 轮播器高度</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">swiperSliderHeight</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">500px</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#BD976A;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">onLoad</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 根据瀑布流计算的高度设置全局事件，动态修正页面滑动轮播器高度</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$on</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">swiperHeightChange</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">height</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#BD976A;">height</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderHeight</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">height</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">})</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">},</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#393A34;">		</span><span style="color:#59873A;">data</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">				</span><span style="color:#A0ADA0;">// 轮播器高度</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">swiperSliderHeight</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">500px</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#B07D48;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">onLoad</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 根据瀑布流计算的高度设置全局事件，动态修正页面滑动轮播器高度</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$on</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">swiperHeightChange</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">height</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B07D48;">height</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderHeight</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">height</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">})</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">},</span></span>
<span class="line"></span></code></pre></div></li><li><p>设置 image 组件的 mode 属性为 widthFil ，让动态瀑布流错落有致的状态更友好</p></li></ol><h3 id="_2-6-首页资讯页面高度动态设置及切换状态保存" tabindex="-1">2.6 首页资讯页面高度动态设置及切换状态保存 <a class="header-anchor" href="#_2-6-首页资讯页面高度动态设置及切换状态保存" aria-hidden="true">#</a></h3><p>关键技术点：切换 资讯、动态 的时候，轮播器切换页面的高度是需要动态调整的，我们需要监听行为进行调整</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">data</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 当前 推荐 资讯 滑动位置</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">currentSwiperIndex</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 滑动页面轮播器的高度</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">swiperSliderHeight</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">500px</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">swiperSliderFeedsHeight</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">swiperSliderNewsHeight</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#CB7676;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">onLoad</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 在这里注册一个 uniAPP 的顶层事件，用来作为数据通信</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$on</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">swiperHeightChange</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">height</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            this.</span><span style="color:#BD976A;">swiperSliderFeedsHeight</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">height</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            this.</span><span style="color:#BD976A;">swiperSliderHeight</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">height</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 我们要在这里初始化请求相关数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">getAdverts</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">getFeedsList</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">getNewsList</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">methods</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 请求 广告轮播图信息</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#CB7676;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">getAdverts</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{},</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 请求 feeds 列表数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#CB7676;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">getFeedsList</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{},</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 请求资讯列表数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#CB7676;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">getNewsList</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">news</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">getNews</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">newsList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">news</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#80A665;">map</span><span style="color:#666666;">((</span><span style="color:#BD976A;">item</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                console.log(</span><span style="color:#80A665;">timeFrom</span><span style="color:#666666;">(</span><span style="color:#BD976A;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Date</span><span style="color:#DBD7CAEE;">(item.created_at</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">));</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                return {</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#666666;">...</span><span style="color:#BD976A;">item</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">cover</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">BaseFileURL</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">image</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            }</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">newsList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[...</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">newsList</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">...</span><span style="color:#BD976A;">newsList</span><span style="color:#666666;">];</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderNewsHeight</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">newsList</span><span style="color:#666666;">.</span><span style="color:#B8A965;">length</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">*</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">95</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">100</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">px</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderHeight</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderNewsHeight</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 页面滑动左右分页的时候实现的效果</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#80A665;">swiperSlider</span><span style="color:#666666;">(</span><span style="color:#BD976A;">event</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">event</span><span style="color:#666666;">.</span><span style="color:#BD976A;">detail</span><span style="color:#666666;">.</span><span style="color:#BD976A;">current</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderHeight</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderFeedsHeight</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderHeight</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderNewsHeight</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">currentSwiperIndex</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">event</span><span style="color:#666666;">.</span><span style="color:#BD976A;">detail</span><span style="color:#666666;">.</span><span style="color:#BD976A;">current</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 点击按钮实现切换效果</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#80A665;">swiperChange</span><span style="color:#666666;">(</span><span style="color:#BD976A;">index</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">index</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderHeight</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderFeedsHeight</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderHeight</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderNewsHeight</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">currentSwiperIndex</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">index</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">data</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 当前 推荐 资讯 滑动位置</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">currentSwiperIndex</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 滑动页面轮播器的高度</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">swiperSliderHeight</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">500px</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">swiperSliderFeedsHeight</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">swiperSliderNewsHeight</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">onLoad</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 在这里注册一个 uniAPP 的顶层事件，用来作为数据通信</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$on</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">swiperHeightChange</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">height</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">            this.</span><span style="color:#B07D48;">swiperSliderFeedsHeight</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">height</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">            this.</span><span style="color:#B07D48;">swiperSliderHeight</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">height</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 我们要在这里初始化请求相关数据</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">getAdverts</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">getFeedsList</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">getNewsList</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">methods</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 请求 广告轮播图信息</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#AB5959;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">getAdverts</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{},</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 请求 feeds 列表数据</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#AB5959;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">getFeedsList</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{},</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 请求资讯列表数据</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#AB5959;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">getNewsList</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">news</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">getNews</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">newsList</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">news</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#59873A;">map</span><span style="color:#999999;">((</span><span style="color:#B07D48;">item</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">                console.log(</span><span style="color:#59873A;">timeFrom</span><span style="color:#999999;">(</span><span style="color:#B07D48;">new</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Date</span><span style="color:#393A34;">(item.created_at</span><span style="color:#999999;">)</span><span style="color:#393A34;">));</span></span>
<span class="line"><span style="color:#393A34;">                return {</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#999999;">...</span><span style="color:#B07D48;">item</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">cover</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">BaseFileURL</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">image</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">}</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">            }</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">newsList</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[...</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">newsList</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">...</span><span style="color:#B07D48;">newsList</span><span style="color:#999999;">];</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderNewsHeight</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">newsList</span><span style="color:#999999;">.</span><span style="color:#998418;">length</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">*</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">95</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">100</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">px</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderHeight</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderNewsHeight</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 页面滑动左右分页的时候实现的效果</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#59873A;">swiperSlider</span><span style="color:#999999;">(</span><span style="color:#B07D48;">event</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">event</span><span style="color:#999999;">.</span><span style="color:#B07D48;">detail</span><span style="color:#999999;">.</span><span style="color:#B07D48;">current</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderHeight</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderFeedsHeight</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderHeight</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderNewsHeight</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">currentSwiperIndex</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">event</span><span style="color:#999999;">.</span><span style="color:#B07D48;">detail</span><span style="color:#999999;">.</span><span style="color:#B07D48;">current</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 点击按钮实现切换效果</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#59873A;">swiperChange</span><span style="color:#999999;">(</span><span style="color:#B07D48;">index</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">index</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderHeight</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderFeedsHeight</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderHeight</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderNewsHeight</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">currentSwiperIndex</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">index</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span></code></pre></div><h3 id="_2-7-首页滚动、切换动态设置顶部-navbar-状态" tabindex="-1">2.7 首页滚动、切换动态设置顶部 NavBar 状态 <a class="header-anchor" href="#_2-7-首页滚动、切换动态设置顶部-navbar-状态" aria-hidden="true">#</a></h3><ol><li><p>在插件市场找到一个功能比较丰富的 NavBar 插件</p><p><a href="https://ext.dcloud.net.cn/plugin?id=813" target="_blank" rel="noreferrer">https://ext.dcloud.net.cn/plugin?id=813</a></p><p>PS：导入后，注意，不要被所谓的插件吓到，咱们改一改，让其更好阅读，查一查，看看是否能够全部兼顾，同时注意检索文件是否引入全面了</p></li></ol><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">&lt;!-- 顶部导航 --&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">uni-nav-bar</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">v-if</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">navBarShowTag</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">view</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">tabs-box</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">view</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">one-nav</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">:class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">currentSwiperIndex === 0 ? &#39;nav-actived&#39; : &#39;&#39; </span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">@tap</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">swiperChange(0)</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">推荐</span><span style="color:#666666;">&lt;/</span><span style="color:#FDAEB7;">view</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">view</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">one-nav</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">:class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">currentSwiperIndex === 1 ? &#39;nav-actived&#39; : &#39;&#39; </span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">@tap</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">swiperChange(1)</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">资讯</span><span style="color:#666666;">&lt;/</span><span style="color:#FDAEB7;">view</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;/</span><span style="color:#FDAEB7;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">uni-nav-bar</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">&lt;!-- 顶部导航 --&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">uni-nav-bar</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">v-if</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">navBarShowTag</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">view</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">tabs-box</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">view</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">one-nav</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">:class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">currentSwiperIndex === 0 ? &#39;nav-actived&#39; : &#39;&#39; </span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">@tap</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">swiperChange(0)</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">推荐</span><span style="color:#999999;">&lt;/</span><span style="color:#B31D28;">view</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">view</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">one-nav</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">:class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">currentSwiperIndex === 1 ? &#39;nav-actived&#39; : &#39;&#39; </span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">@tap</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">swiperChange(1)</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">资讯</span><span style="color:#999999;">&lt;/</span><span style="color:#B31D28;">view</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;/</span><span style="color:#B31D28;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">uni-nav-bar</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>监听页面滚动事件，判断滚动唯一显示和隐藏 navBar 导航</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#80A665;">onPageScroll</span><span style="color:#666666;">(</span><span style="color:#BD976A;">event</span><span style="color:#666666;">){</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#4D9375;">if</span><span style="color:#666666;">(</span><span style="color:#BD976A;">event</span><span style="color:#666666;">.</span><span style="color:#BD976A;">scrollTop</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">220</span><span style="color:#666666;">){</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">navBarShowTag</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span><span style="color:#4D9375;">else</span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">navBarShowTag</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#393A34;">	</span><span style="color:#59873A;">onPageScroll</span><span style="color:#999999;">(</span><span style="color:#B07D48;">event</span><span style="color:#999999;">){</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#1E754F;">if</span><span style="color:#999999;">(</span><span style="color:#B07D48;">event</span><span style="color:#999999;">.</span><span style="color:#B07D48;">scrollTop</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">220</span><span style="color:#999999;">){</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">navBarShowTag</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span><span style="color:#1E754F;">else</span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">navBarShowTag</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>资讯、动态切换动态设置</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">data</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 记录滚动所在的位置</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">oldFeedsScrollTop</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">oldNewsScrollTop</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">onPageScroll</span><span style="color:#666666;">(</span><span style="color:#BD976A;">event</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">currentSwiperIndex</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oldFeedsScrollTop</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">event</span><span style="color:#666666;">.</span><span style="color:#BD976A;">scrollTop</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oldNewsScrollTop</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">event</span><span style="color:#666666;">.</span><span style="color:#BD976A;">scrollTop</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">methods</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 页面滑动左右分页的时候实现的效果</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#80A665;">swiperSlider</span><span style="color:#666666;">(</span><span style="color:#BD976A;">event</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">event</span><span style="color:#666666;">.</span><span style="color:#BD976A;">detail</span><span style="color:#666666;">.</span><span style="color:#BD976A;">current</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderHeight</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderFeedsHeight</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">pageScrollTo</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">duration</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">//过渡时间必须为0，uniapp bug，否则运行到手机会报错</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">scrollTop</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oldFeedsScrollTop</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">//滚动到目标位置</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderHeight</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderNewsHeight</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">pageScrollTo</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">duration</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">//过渡时间必须为0，uniapp bug，否则运行到手机会报错</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">scrollTop</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oldNewsScrollTop</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">//滚动到目标位置</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">currentSwiperIndex</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">event</span><span style="color:#666666;">.</span><span style="color:#BD976A;">detail</span><span style="color:#666666;">.</span><span style="color:#BD976A;">current</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 点击按钮实现切换效果</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#80A665;">swiperChange</span><span style="color:#666666;">(</span><span style="color:#BD976A;">index</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">index</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderHeight</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderFeedsHeight</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">pageScrollTo</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">duration</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">//过渡时间必须为0，uniapp bug，否则运行到手机会报错</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">scrollTop</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oldFeedsScrollTop</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">//滚动到目标位置</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderHeight</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">swiperSliderNewsHeight</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">pageScrollTo</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">duration</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">//过渡时间必须为0，uniapp bug，否则运行到手机会报错</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">scrollTop</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oldNewsScrollTop</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">//滚动到目标位置</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">currentSwiperIndex</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">index</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">data</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 记录滚动所在的位置</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">oldFeedsScrollTop</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">oldNewsScrollTop</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">onPageScroll</span><span style="color:#999999;">(</span><span style="color:#B07D48;">event</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">currentSwiperIndex</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oldFeedsScrollTop</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">event</span><span style="color:#999999;">.</span><span style="color:#B07D48;">scrollTop</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oldNewsScrollTop</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">event</span><span style="color:#999999;">.</span><span style="color:#B07D48;">scrollTop</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">methods</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 页面滑动左右分页的时候实现的效果</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#59873A;">swiperSlider</span><span style="color:#999999;">(</span><span style="color:#B07D48;">event</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">event</span><span style="color:#999999;">.</span><span style="color:#B07D48;">detail</span><span style="color:#999999;">.</span><span style="color:#B07D48;">current</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderHeight</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderFeedsHeight</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">pageScrollTo</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">duration</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">//过渡时间必须为0，uniapp bug，否则运行到手机会报错</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">scrollTop</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oldFeedsScrollTop</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">//滚动到目标位置</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderHeight</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderNewsHeight</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">pageScrollTo</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">duration</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">//过渡时间必须为0，uniapp bug，否则运行到手机会报错</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">scrollTop</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oldNewsScrollTop</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">//滚动到目标位置</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">currentSwiperIndex</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">event</span><span style="color:#999999;">.</span><span style="color:#B07D48;">detail</span><span style="color:#999999;">.</span><span style="color:#B07D48;">current</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 点击按钮实现切换效果</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#59873A;">swiperChange</span><span style="color:#999999;">(</span><span style="color:#B07D48;">index</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">index</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderHeight</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderFeedsHeight</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">pageScrollTo</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">duration</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">//过渡时间必须为0，uniapp bug，否则运行到手机会报错</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">scrollTop</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oldFeedsScrollTop</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">//滚动到目标位置</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderHeight</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">swiperSliderNewsHeight</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">pageScrollTo</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">duration</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">//过渡时间必须为0，uniapp bug，否则运行到手机会报错</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">scrollTop</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oldNewsScrollTop</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">//滚动到目标位置</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">currentSwiperIndex</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">index</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span></code></pre></div><h3 id="_2-8-顶部下拉、底部置底请求更新数据" tabindex="-1">2.8 顶部下拉、底部置底请求更新数据 <a class="header-anchor" href="#_2-8-顶部下拉、底部置底请求更新数据" aria-hidden="true">#</a></h3><p>关键技术点：</p><ol><li>onReachBottom、onPullDownRefresh 全局方法调用</li><li>this.$refs.waterfall.clear() 调用插件对应方法清空数据流</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#80A665;">onReachBottom</span><span style="color:#666666;">(){</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">下拉到底啦</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 请求新的数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#4D9375;">if</span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">currentSwiperIndex</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">){</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">getFeedsList</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span><span style="color:#4D9375;">else</span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">getNewsList</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#80A665;">onPullDownRefresh</span><span style="color:#666666;">(){</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">顶部下拉刷新</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">feedsList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$refs</span><span style="color:#666666;">.</span><span style="color:#BD976A;">waterfall</span><span style="color:#666666;">.</span><span style="color:#80A665;">clear</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#4D9375;">if</span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">currentSwiperIndex</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">){</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">getFeedsList</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span><span style="color:#4D9375;">else</span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">getNewsList</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#393A34;">	</span><span style="color:#59873A;">onReachBottom</span><span style="color:#999999;">(){</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">下拉到底啦</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 请求新的数据</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#1E754F;">if</span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">currentSwiperIndex</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">){</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">getFeedsList</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span><span style="color:#1E754F;">else</span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">getNewsList</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#59873A;">onPullDownRefresh</span><span style="color:#999999;">(){</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">顶部下拉刷新</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">feedsList</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$refs</span><span style="color:#999999;">.</span><span style="color:#B07D48;">waterfall</span><span style="color:#999999;">.</span><span style="color:#59873A;">clear</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#1E754F;">if</span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">currentSwiperIndex</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">){</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">getFeedsList</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span><span style="color:#1E754F;">else</span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">getNewsList</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="三、资讯动态页面功能实现" tabindex="-1">三、资讯动态页面功能实现 <a class="header-anchor" href="#三、资讯动态页面功能实现" aria-hidden="true">#</a></h2><h3 id="_3-1-使用-grid-布局实现动态瀑布流页面" tabindex="-1">3.1 使用 Grid 布局实现动态瀑布流页面 <a class="header-anchor" href="#_3-1-使用-grid-布局实现动态瀑布流页面" aria-hidden="true">#</a></h3><p>技术关键点：</p><ol><li>动态请求数据，并对数据进行加工处理成为我们期望的 分组数组 目标数据</li><li>grid 栅格化布局</li><li>顶部下拉刷新更新数据</li><li>滚动置底请求数据</li><li>请求状态控制器</li></ol><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">rfeeds</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">one-feeds-box</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#BD976A;">v-for</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">(</span><span style="color:#BD976A;">feedsList</span><span style="color:#666666;">, </span><span style="color:#BD976A;">i</span><span style="color:#666666;">) </span><span style="color:#CB7676;">in</span><span style="color:#666666;"> </span><span style="color:#BD976A;">showFeedsList</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">            :</span><span style="color:#BD976A;">key</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">i</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">        &gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span></span>
<span class="line"><span style="color:#666666;">                </span><span style="color:#BD976A;">v-for</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">(</span><span style="color:#BD976A;">item</span><span style="color:#666666;">, </span><span style="color:#BD976A;">k</span><span style="color:#666666;">) </span><span style="color:#CB7676;">in</span><span style="color:#666666;"> </span><span style="color:#BD976A;">feedsList</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                :</span><span style="color:#BD976A;">key</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">one-feed</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                :</span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                    </span><span style="color:#BD976A;">k</span><span style="color:#666666;"> </span><span style="color:#CB7676;">%</span><span style="color:#666666;"> </span><span style="color:#4C9A91;">6</span><span style="color:#666666;"> </span><span style="color:#CB7676;">==</span><span style="color:#666666;"> </span><span style="color:#4C9A91;">0</span></span>
<span class="line"><span style="color:#666666;">                        </span><span style="color:#CB7676;">?</span><span style="color:#666666;"> </span><span style="color:#BD976A;">i</span><span style="color:#666666;"> </span><span style="color:#CB7676;">%</span><span style="color:#666666;"> </span><span style="color:#4C9A91;">2</span><span style="color:#666666;"> </span><span style="color:#CB7676;">==</span><span style="color:#666666;"> </span><span style="color:#4C9A91;">0</span></span>
<span class="line"><span style="color:#666666;">                            </span><span style="color:#CB7676;">?</span><span style="color:#666666;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">feed-big-left</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#666666;">                            </span><span style="color:#CB7676;">:</span><span style="color:#666666;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">feed-big-right</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#666666;">                        </span><span style="color:#CB7676;">:</span><span style="color:#666666;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span></span>
<span class="line"><span style="color:#666666;">                </span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">            &gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">navigator</span><span style="color:#666666;"> :</span><span style="color:#BD976A;">url</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;&#39;</span><span style="color:#C98A7D;">/subpages/feedinfo/feedinfo?id=</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;"> </span><span style="color:#CB7676;">+</span><span style="color:#666666;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">image</span></span>
<span class="line"><span style="color:#666666;">                        :</span><span style="color:#BD976A;">src</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">cover</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                        </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">feed-content</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                        </span><span style="color:#BD976A;">mode</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">aspectFill</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                        :</span><span style="color:#BD976A;">lazy-load</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#4D9375;">true</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                    /&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">navigator</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;">&lt;!-- 分享按钮组件 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">goto-share</span><span style="color:#666666;"> /&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">script</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">data</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 列表数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">feedsList</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[],</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 用来展示的栅格系统的列表数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">showFeedsList</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[],</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 记录请求 feed 状态</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">canRequestFeeds</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">yes</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 发布新的动态，跳转到当前页面，更新最新信息</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">onLoad</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">startPullDownRefresh</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 顶部下拉刷新新数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">onPullDownRefresh</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">feedsList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[];</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">getFeeds</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">timer</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">setTimeout</span><span style="color:#666666;">(</span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#80A665;">clearTimeout</span><span style="color:#666666;">(</span><span style="color:#BD976A;">timer</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">stopPullDownRefresh</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">500</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 滚动置底刷新请求数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">onReachBottom</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">getFeeds</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">methods</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 获取请求数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#CB7676;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">getFeeds</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">canRequestFeeds</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">yes</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showToast</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">请求中...</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">icon</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">loading</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">duration</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">10000</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#666666;">                </span><span style="color:#758575DD;">// 设置状态</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">canRequestFeeds</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">no</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">getFeeds</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">feeds</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">feeds</span><span style="color:#666666;">.</span><span style="color:#80A665;">map</span><span style="color:#666666;">((</span><span style="color:#BD976A;">item</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    return {</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                        </span><span style="color:#B8A965;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                        </span><span style="color:#B8A965;">cover</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">BaseFileURL</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">images</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">].</span><span style="color:#BD976A;">file</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                }</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">feeds</span><span style="color:#666666;">.</span><span style="color:#B8A965;">length</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">5</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">                    </span><span style="color:#758575DD;">// 记录总列表数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">feedsList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[...</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">feedsList</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">...</span><span style="color:#BD976A;">feeds</span><span style="color:#666666;">];</span></span>
<span class="line"><span style="color:#666666;">                    </span><span style="color:#758575DD;">// 在这里要处理页面的内容布局模式为栅格模式，6个元素一组</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">showArrList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[];</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">i</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">i</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">feedsList</span><span style="color:#666666;">.</span><span style="color:#B8A965;">length</span><span style="color:#666666;">;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">i</span><span style="color:#CB7676;">++</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                        </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">i</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">%</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">6</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">&amp;&amp;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">!!</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">feedsList</span><span style="color:#666666;">[</span><span style="color:#BD976A;">i</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">5</span><span style="color:#666666;">])</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">                            </span><span style="color:#758575DD;">// 返回一个新的数组，包含从 start 到 end （不包括该元素）元素。</span></span>
<span class="line"><span style="color:#666666;">                            </span><span style="color:#758575DD;">// 该方法并不会修改数组，而是返回一个子数组。如果想删除数组中的一段元素，应该使用方法 Array.splice()。</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                            </span><span style="color:#BD976A;">showArrList</span><span style="color:#666666;">.</span><span style="color:#80A665;">push</span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">feedsList</span><span style="color:#666666;">.</span><span style="color:#80A665;">slice</span><span style="color:#666666;">(</span><span style="color:#BD976A;">i</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">i</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">6</span><span style="color:#666666;">));</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                        </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">showFeedsList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">showArrList</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">timer</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">setTimeout</span><span style="color:#666666;">(()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                        </span><span style="color:#80A665;">clearTimeout</span><span style="color:#666666;">(</span><span style="color:#BD976A;">timer</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                        this.</span><span style="color:#BD976A;">canRequestFeeds</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">yes</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#666666;">},</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">500</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">canRequestFeeds</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">end</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showToast</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                        </span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">到底啦！</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                        </span><span style="color:#B8A965;">icon</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">success</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                        </span><span style="color:#B8A965;">duration</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1000</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">hideToast</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 如果请求状态到底了后，则提示到底了</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">canRequestFeeds</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">end</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">hideToast</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showToast</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">到底啦！</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">icon</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">success</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">duration</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1000</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">script</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">style</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">lang</span><span style="color:#DBD7CAEE;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">scss</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">scoped</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">.</span><span style="color:#BD976A;">rfeeds</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">background-color</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">#</span><span style="color:#C99076;">ffffff</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">padding-bottom</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">20</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">.</span><span style="color:#BD976A;">one-feeds-box</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">width</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">704</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">margin</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">4</span><span style="color:#DBD7CAEE;">upx </span><span style="color:#4C9A91;">22</span><span style="color:#DBD7CAEE;">upx </span><span style="color:#4C9A91;">0</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">22</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;">// 定义栅格布局</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">display</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">grid</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;">// 定义栅格每一列的宽度</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">grid-template-columns</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">232</span><span style="color:#DBD7CAEE;">upx </span><span style="color:#4C9A91;">232</span><span style="color:#DBD7CAEE;">upx </span><span style="color:#4C9A91;">232</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;">// 定义栅格每一行的高度</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">grid-template-rows</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">232</span><span style="color:#DBD7CAEE;">upx </span><span style="color:#4C9A91;">232</span><span style="color:#DBD7CAEE;">upx </span><span style="color:#4C9A91;">232</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;">// grid-row-gap属性设置行与行的间隔（行间距），grid-column-gap属性设置列与列的间隔（列间距）</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">grid-row-gap</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">4</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">grid-column-gap</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">4</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">background-color</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">#</span><span style="color:#C99076;">dadada</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">.</span><span style="color:#BD976A;">one-feed</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">position</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">relative</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">.</span><span style="color:#BD976A;">feed-content</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">width</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">232</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">height</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">232</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">border</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#CB7676;">px</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">solid</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">#</span><span style="color:#C99076;">eeeeee</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">border-radius</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">4</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">.</span><span style="color:#BD976A;">icon</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">position</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">absolute</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">right</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">10</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">top</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">10</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">.</span><span style="color:#BD976A;">play-icon</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">width</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">40</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">height</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">40</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">&amp;</span><span style="color:#666666;">.</span><span style="color:#BD976A;">feed-big-left</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">grid-column-start</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">grid-column-end</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">3</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">grid-row-start</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">grid-row-end</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">3</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">background-color</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">#</span><span style="color:#C99076;">dadada</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">.</span><span style="color:#BD976A;">feed-content</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">width</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">466</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">height</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">466</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">border</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#CB7676;">px</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">solid</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">#</span><span style="color:#C99076;">eeeeee</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">&amp;</span><span style="color:#666666;">.</span><span style="color:#BD976A;">feed-big-right</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">grid-column-start</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">2</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">grid-column-end</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">4</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">grid-row-start</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">grid-row-end</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">3</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">background-color</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">#</span><span style="color:#C99076;">dadada</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">.</span><span style="color:#BD976A;">feed-content</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">width</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">466</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">height</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">466</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">border</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#CB7676;">px</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">solid</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">#</span><span style="color:#C99076;">eeeeee</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">style</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">rfeeds</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">one-feeds-box</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#B07D48;">v-for</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">(</span><span style="color:#B07D48;">feedsList</span><span style="color:#999999;">, </span><span style="color:#B07D48;">i</span><span style="color:#999999;">) </span><span style="color:#AB5959;">in</span><span style="color:#999999;"> </span><span style="color:#B07D48;">showFeedsList</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">            :</span><span style="color:#B07D48;">key</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">i</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">        &gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span></span>
<span class="line"><span style="color:#999999;">                </span><span style="color:#B07D48;">v-for</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">(</span><span style="color:#B07D48;">item</span><span style="color:#999999;">, </span><span style="color:#B07D48;">k</span><span style="color:#999999;">) </span><span style="color:#AB5959;">in</span><span style="color:#999999;"> </span><span style="color:#B07D48;">feedsList</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                :</span><span style="color:#B07D48;">key</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">one-feed</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                :</span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                    </span><span style="color:#B07D48;">k</span><span style="color:#999999;"> </span><span style="color:#AB5959;">%</span><span style="color:#999999;"> </span><span style="color:#2F798A;">6</span><span style="color:#999999;"> </span><span style="color:#AB5959;">==</span><span style="color:#999999;"> </span><span style="color:#2F798A;">0</span></span>
<span class="line"><span style="color:#999999;">                        </span><span style="color:#AB5959;">?</span><span style="color:#999999;"> </span><span style="color:#B07D48;">i</span><span style="color:#999999;"> </span><span style="color:#AB5959;">%</span><span style="color:#999999;"> </span><span style="color:#2F798A;">2</span><span style="color:#999999;"> </span><span style="color:#AB5959;">==</span><span style="color:#999999;"> </span><span style="color:#2F798A;">0</span></span>
<span class="line"><span style="color:#999999;">                            </span><span style="color:#AB5959;">?</span><span style="color:#999999;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">feed-big-left</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#999999;">                            </span><span style="color:#AB5959;">:</span><span style="color:#999999;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">feed-big-right</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#999999;">                        </span><span style="color:#AB5959;">:</span><span style="color:#999999;"> </span><span style="color:#B56959AA;">&#39;&#39;</span></span>
<span class="line"><span style="color:#999999;">                </span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">            &gt;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">navigator</span><span style="color:#999999;"> :</span><span style="color:#B07D48;">url</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;&#39;</span><span style="color:#B56959;">/subpages/feedinfo/feedinfo?id=</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;"> </span><span style="color:#AB5959;">+</span><span style="color:#999999;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">image</span></span>
<span class="line"><span style="color:#999999;">                        :</span><span style="color:#B07D48;">src</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">cover</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                        </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">feed-content</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                        </span><span style="color:#B07D48;">mode</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">aspectFill</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                        :</span><span style="color:#B07D48;">lazy-load</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#1E754F;">true</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                    /&gt;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">navigator</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;">&lt;!-- 分享按钮组件 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">goto-share</span><span style="color:#999999;"> /&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">script</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">data</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 列表数据</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">feedsList</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[],</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 用来展示的栅格系统的列表数据</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">showFeedsList</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[],</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 记录请求 feed 状态</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">canRequestFeeds</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">yes</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 发布新的动态，跳转到当前页面，更新最新信息</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">onLoad</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">startPullDownRefresh</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 顶部下拉刷新新数据</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">onPullDownRefresh</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">feedsList</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[];</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">getFeeds</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">timer</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">setTimeout</span><span style="color:#999999;">(</span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#59873A;">clearTimeout</span><span style="color:#999999;">(</span><span style="color:#B07D48;">timer</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">stopPullDownRefresh</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">500</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 滚动置底刷新请求数据</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">onReachBottom</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">getFeeds</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">methods</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 获取请求数据</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#AB5959;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">getFeeds</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">canRequestFeeds</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">yes</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showToast</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">请求中...</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">icon</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">loading</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">duration</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">10000</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#999999;">                </span><span style="color:#A0ADA0;">// 设置状态</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">canRequestFeeds</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">no</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">getFeeds</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">feeds</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">feeds</span><span style="color:#999999;">.</span><span style="color:#59873A;">map</span><span style="color:#999999;">((</span><span style="color:#B07D48;">item</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">                    return {</span></span>
<span class="line"><span style="color:#393A34;">                        </span><span style="color:#998418;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                        </span><span style="color:#998418;">cover</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">BaseFileURL</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">images</span><span style="color:#999999;">[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">].</span><span style="color:#B07D48;">file</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#999999;">}</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">                }</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">feeds</span><span style="color:#999999;">.</span><span style="color:#998418;">length</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">5</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">                    </span><span style="color:#A0ADA0;">// 记录总列表数据</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">feedsList</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[...</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">feedsList</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">...</span><span style="color:#B07D48;">feeds</span><span style="color:#999999;">];</span></span>
<span class="line"><span style="color:#999999;">                    </span><span style="color:#A0ADA0;">// 在这里要处理页面的内容布局模式为栅格模式，6个元素一组</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">showArrList</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[];</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">i</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">i</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">feedsList</span><span style="color:#999999;">.</span><span style="color:#998418;">length</span><span style="color:#999999;">;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">i</span><span style="color:#AB5959;">++</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                        </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">i</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">%</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">6</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&amp;&amp;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">!!</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">feedsList</span><span style="color:#999999;">[</span><span style="color:#B07D48;">i</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">5</span><span style="color:#999999;">])</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">                            </span><span style="color:#A0ADA0;">// 返回一个新的数组，包含从 start 到 end （不包括该元素）元素。</span></span>
<span class="line"><span style="color:#999999;">                            </span><span style="color:#A0ADA0;">// 该方法并不会修改数组，而是返回一个子数组。如果想删除数组中的一段元素，应该使用方法 Array.splice()。</span></span>
<span class="line"><span style="color:#393A34;">                            </span><span style="color:#B07D48;">showArrList</span><span style="color:#999999;">.</span><span style="color:#59873A;">push</span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">feedsList</span><span style="color:#999999;">.</span><span style="color:#59873A;">slice</span><span style="color:#999999;">(</span><span style="color:#B07D48;">i</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">i</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">6</span><span style="color:#999999;">));</span></span>
<span class="line"><span style="color:#393A34;">                        </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">showFeedsList</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">showArrList</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">timer</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">setTimeout</span><span style="color:#999999;">(()</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">                        </span><span style="color:#59873A;">clearTimeout</span><span style="color:#999999;">(</span><span style="color:#B07D48;">timer</span><span style="color:#999999;">)</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">                        this.</span><span style="color:#B07D48;">canRequestFeeds</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">yes</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#999999;">},</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">500</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">canRequestFeeds</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">end</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showToast</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                        </span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">到底啦！</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                        </span><span style="color:#998418;">icon</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">success</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                        </span><span style="color:#998418;">duration</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1000</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">hideToast</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 如果请求状态到底了后，则提示到底了</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">canRequestFeeds</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">end</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">hideToast</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showToast</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">到底啦！</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">icon</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">success</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">duration</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1000</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">script</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">style</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">lang</span><span style="color:#393A34;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">scss</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">scoped</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">.</span><span style="color:#B07D48;">rfeeds</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">background-color</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">#</span><span style="color:#A65E2B;">ffffff</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">padding-bottom</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">20</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">.</span><span style="color:#B07D48;">one-feeds-box</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">width</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">704</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">margin</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">4</span><span style="color:#393A34;">upx </span><span style="color:#2F798A;">22</span><span style="color:#393A34;">upx </span><span style="color:#2F798A;">0</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">22</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;">// 定义栅格布局</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">display</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">grid</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;">// 定义栅格每一列的宽度</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">grid-template-columns</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">232</span><span style="color:#393A34;">upx </span><span style="color:#2F798A;">232</span><span style="color:#393A34;">upx </span><span style="color:#2F798A;">232</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;">// 定义栅格每一行的高度</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">grid-template-rows</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">232</span><span style="color:#393A34;">upx </span><span style="color:#2F798A;">232</span><span style="color:#393A34;">upx </span><span style="color:#2F798A;">232</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;">// grid-row-gap属性设置行与行的间隔（行间距），grid-column-gap属性设置列与列的间隔（列间距）</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">grid-row-gap</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">4</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">grid-column-gap</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">4</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">background-color</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">#</span><span style="color:#A65E2B;">dadada</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">.</span><span style="color:#B07D48;">one-feed</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">position</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">relative</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">.</span><span style="color:#B07D48;">feed-content</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">width</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">232</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">height</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">232</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">border</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#AB5959;">px</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">solid</span><span style="color:#393A34;"> </span><span style="color:#999999;">#</span><span style="color:#A65E2B;">eeeeee</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">border-radius</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">4</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">.</span><span style="color:#B07D48;">icon</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">position</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">absolute</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">right</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">10</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">top</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">10</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">.</span><span style="color:#B07D48;">play-icon</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">width</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">40</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">height</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">40</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">&amp;</span><span style="color:#999999;">.</span><span style="color:#B07D48;">feed-big-left</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">grid-column-start</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">grid-column-end</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">3</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">grid-row-start</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">grid-row-end</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">3</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">background-color</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">#</span><span style="color:#A65E2B;">dadada</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">.</span><span style="color:#B07D48;">feed-content</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">width</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">466</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">height</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">466</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">border</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#AB5959;">px</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">solid</span><span style="color:#393A34;"> </span><span style="color:#999999;">#</span><span style="color:#A65E2B;">eeeeee</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">&amp;</span><span style="color:#999999;">.</span><span style="color:#B07D48;">feed-big-right</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">grid-column-start</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">2</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">grid-column-end</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">4</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">grid-row-start</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">grid-row-end</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">3</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">background-color</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">#</span><span style="color:#A65E2B;">dadada</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">.</span><span style="color:#B07D48;">feed-content</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">width</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">466</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">height</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">466</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">border</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#AB5959;">px</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">solid</span><span style="color:#393A34;"> </span><span style="color:#999999;">#</span><span style="color:#A65E2B;">eeeeee</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">style</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="_3-2-使用小程序分包构建业务模块" tabindex="-1">3.2 使用小程序分包构建业务模块 <a class="header-anchor" href="#_3-2-使用小程序分包构建业务模块" aria-hidden="true">#</a></h3><p>技术关键点：page.json 中配置分包业务逻辑</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">subPackages</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;">: </span><span style="color:#666666;">[{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">root</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">subpages</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">pages</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">path</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">feedinfo/feedinfo</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">style</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">navigationBarTitleText</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">动态详情</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">navigationBarBackgroundColor</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">#FFFFFF</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">navigationBarTextStyle</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">black</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">backgroundColor</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">#FFFFFF</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">},</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">path</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">newinfo/newinfo</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">style</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">navigationStyle</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">custom</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">enablePullDownRefresh</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">},</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">path</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">setting/setting</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">style</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">navigationBarTitleText</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">enablePullDownRefresh</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">},</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">path</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">share/share</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">style</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">navigationBarTitleText</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">enablePullDownRefresh</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">}]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">}]</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">subPackages</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;">: </span><span style="color:#999999;">[{</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">root</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">subpages</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">pages</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">path</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">feedinfo/feedinfo</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">style</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">navigationBarTitleText</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">动态详情</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">navigationBarBackgroundColor</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">#FFFFFF</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">navigationBarTextStyle</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">black</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">backgroundColor</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">#FFFFFF</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">},</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">path</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">newinfo/newinfo</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">style</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">navigationStyle</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">custom</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">enablePullDownRefresh</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">},</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">path</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">setting/setting</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">style</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">navigationBarTitleText</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">enablePullDownRefresh</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">},</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">path</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">share/share</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">style</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">navigationBarTitleText</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">enablePullDownRefresh</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">}]</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#999999;">}]</span></span>
<span class="line"></span></code></pre></div><h3 id="_3-3-图文类动态详情页面功能实现" tabindex="-1">3.3 图文类动态详情页面功能实现 <a class="header-anchor" href="#_3-3-图文类动态详情页面功能实现" aria-hidden="true">#</a></h3><p>技术关键点：</p><ol><li>分享朋友圈</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#BD976A;">wx</span><span style="color:#666666;">.</span><span style="color:#80A665;">showShareMenu</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">withShareTicket</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">menus</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">shareAppMessage</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">shareTimeline</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">],</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#B07D48;">wx</span><span style="color:#999999;">.</span><span style="color:#59873A;">showShareMenu</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">withShareTicket</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">menus</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">shareAppMessage</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">shareTimeline</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">],</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>图片预览</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#80A665;">methods</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#80A665;">previewImage</span><span style="color:#666666;">(</span><span style="color:#BD976A;">index</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">previewImage</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">current</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">index</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">urls</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">feedInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">images</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#59873A;">methods</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#59873A;">previewImage</span><span style="color:#999999;">(</span><span style="color:#B07D48;">index</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">previewImage</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">current</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">index</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">urls</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">feedInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">images</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>使用日期格式化过滤器显示时间</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// 引入 时间日期格式化显示函数</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">timeFrom</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">@/tools/timeFrom.js</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#758575DD;">// 设置过滤器</span></span>
<span class="line"><span style="color:#80A665;">filters</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#80A665;">timeFormate</span><span style="color:#666666;">(</span><span style="color:#BD976A;">timeDate</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Time</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">Date</span><span style="color:#666666;">(</span><span style="color:#BD976A;">timeDate</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">timestemp</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Time</span><span style="color:#666666;">.</span><span style="color:#80A665;">getTime</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">t</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">timeFrom</span><span style="color:#666666;">(</span><span style="color:#BD976A;">timestemp</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">yyyy年mm月dd日</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">t</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#758575DD;">// 调用过滤器</span></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">text</span><span style="color:#666666;">&gt;{{</span><span style="color:#DBD7CAEE;"> feedInfo.created_at | </span><span style="color:#BD976A;">timeFormate</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}}</span><span style="color:#DBD7CAEE;"> 发布</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">text</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// 引入 时间日期格式化显示函数</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">timeFrom</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">@/tools/timeFrom.js</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#A0ADA0;">// 设置过滤器</span></span>
<span class="line"><span style="color:#59873A;">filters</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#59873A;">timeFormate</span><span style="color:#999999;">(</span><span style="color:#B07D48;">timeDate</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Time</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">Date</span><span style="color:#999999;">(</span><span style="color:#B07D48;">timeDate</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">timestemp</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Time</span><span style="color:#999999;">.</span><span style="color:#59873A;">getTime</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">t</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">timeFrom</span><span style="color:#999999;">(</span><span style="color:#B07D48;">timestemp</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">yyyy年mm月dd日</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">t</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#A0ADA0;">// 调用过滤器</span></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">text</span><span style="color:#999999;">&gt;{{</span><span style="color:#393A34;"> feedInfo.created_at | </span><span style="color:#B07D48;">timeFormate</span><span style="color:#393A34;"> </span><span style="color:#999999;">}}</span><span style="color:#393A34;"> 发布</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">text</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="_3-4-富文本解析资讯详情页面功能实现" tabindex="-1">3.4 富文本解析资讯详情页面功能实现 <a class="header-anchor" href="#_3-4-富文本解析资讯详情页面功能实现" aria-hidden="true">#</a></h3><p>技术关键点：</p><ol><li>顶部毛玻璃插件的引入及使用</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#666666;">	</span><span style="color:#758575DD;">// 引入毛玻璃组件</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">picBlur</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">@/components/pic-blur/pic-blur.vue</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">components</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#BD976A;">picBlur</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#CB7676;">&lt;!--</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">顶部毛玻璃背景图</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">--&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#CB7676;">&lt;!--</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">可选值</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">xs</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">s</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">m</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">l</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">xl</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">--&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">pic-blur</span><span style="color:#DBD7CAEE;"> </span><span style="color:#FDAEB7;">:params=&quot;{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		        </span><span style="color:#FDAEB7;">width:&#39;750rpx&#39;,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		        </span><span style="color:#FDAEB7;">height:&#39;520rpx&#39;,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		        </span><span style="color:#FDAEB7;">image:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#FDAEB7;">newInfo.cover,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		        </span><span style="color:#FDAEB7;">blur:&#39;xs&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#FDAEB7;">}&quot;&gt;&lt;/pic-blur&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#999999;">	</span><span style="color:#A0ADA0;">// 引入毛玻璃组件</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">picBlur</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">@/components/pic-blur/pic-blur.vue</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">components</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#B07D48;">picBlur</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">&lt;!--</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">顶部毛玻璃背景图</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">--&gt;</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#AB5959;">&lt;!--</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">可选值</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">xs</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">s</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">m</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">l</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">xl</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">--&gt;</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">pic-blur</span><span style="color:#393A34;"> </span><span style="color:#B31D28;">:params=&quot;{</span></span>
<span class="line"><span style="color:#393A34;">		        </span><span style="color:#B31D28;">width:&#39;750rpx&#39;,</span></span>
<span class="line"><span style="color:#393A34;">		        </span><span style="color:#B31D28;">height:&#39;520rpx&#39;,</span></span>
<span class="line"><span style="color:#393A34;">		        </span><span style="color:#B31D28;">image:</span><span style="color:#393A34;"> </span><span style="color:#B31D28;">newInfo.cover,</span></span>
<span class="line"><span style="color:#393A34;">		        </span><span style="color:#B31D28;">blur:&#39;xs&#39;</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#B31D28;">}&quot;&gt;&lt;/pic-blur&gt;</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>资讯详情内容 富文本内容 深度解析</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">htmlParse</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">@/components/html-parse/parse.vue</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">info-content</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">html-parse</span><span style="color:#DBD7CAEE;"> </span><span style="color:#FDAEB7;">:content=&quot;newInfo.content&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#BD976A;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">onLoad</span><span style="color:#666666;">(</span><span style="color:#BD976A;">options</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 分享</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#BD976A;">wx</span><span style="color:#666666;">.</span><span style="color:#80A665;">showShareMenu</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">withShareTicket</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">menus</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">shareAppMessage</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">shareTimeline</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">})</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">getNewInfo</span><span style="color:#666666;">(</span><span style="color:#BD976A;">options</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#BD976A;">res</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// let cp = res.content.replace(/@!\[(\d*).jpg\]\((\d*)\)/g,&quot;&lt;img src=&#39;&quot; +this.BaseFileURL +&#39;$2&#39; + &quot;&#39; /&gt;&quot;)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">cp</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">content</span><span style="color:#666666;">.</span><span style="color:#80A665;">replace</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">/</span><span style="color:#C4704F;">@!</span><span style="color:#E6CC77;">\[</span><span style="color:#C99076;">.</span><span style="color:#CB7676;">*</span><span style="color:#E6CC77;">\]\(</span><span style="color:#666666;">(</span><span style="color:#C99076;">\d</span><span style="color:#CB7676;">*</span><span style="color:#666666;">)</span><span style="color:#E6CC77;">\)</span><span style="color:#C98A7DAA;">/</span><span style="color:#4D9375;">g</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">&lt;img src=&#39;</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">BaseFileURL</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">$1</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">&#39; /&gt;</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">newInfo</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">...</span><span style="color:#BD976A;">res</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">cutTitle</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">title</span><span style="color:#666666;">.</span><span style="color:#B8A965;">length</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">11</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">?</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">title</span><span style="color:#666666;">.</span><span style="color:#80A665;">substring</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">11</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">...</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">title</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">cover</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">BaseFileURL</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">image</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">userId</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">user_id</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">content</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">cp</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">views_count</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">hits</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">getRequestOK</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#393A34;">	</span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">htmlParse</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">@/components/html-parse/parse.vue</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">info-content</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">html-parse</span><span style="color:#393A34;"> </span><span style="color:#B31D28;">:content=&quot;newInfo.content&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#B07D48;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">onLoad</span><span style="color:#999999;">(</span><span style="color:#B07D48;">options</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 分享</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#B07D48;">wx</span><span style="color:#999999;">.</span><span style="color:#59873A;">showShareMenu</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">withShareTicket</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">menus</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">shareAppMessage</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">shareTimeline</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">})</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">getNewInfo</span><span style="color:#999999;">(</span><span style="color:#B07D48;">options</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#B07D48;">res</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// let cp = res.content.replace(/@!\[(\d*).jpg\]\((\d*)\)/g,&quot;&lt;img src=&#39;&quot; +this.BaseFileURL +&#39;$2&#39; + &quot;&#39; /&gt;&quot;)</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">cp</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">content</span><span style="color:#999999;">.</span><span style="color:#59873A;">replace</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">/</span><span style="color:#AB5E3F;">@!</span><span style="color:#BDA437;">\[</span><span style="color:#A65E2B;">.</span><span style="color:#AB5959;">*</span><span style="color:#BDA437;">\]\(</span><span style="color:#999999;">(</span><span style="color:#A65E2B;">\d</span><span style="color:#AB5959;">*</span><span style="color:#999999;">)</span><span style="color:#BDA437;">\)</span><span style="color:#B56959AA;">/</span><span style="color:#1E754F;">g</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">&lt;img src=&#39;</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">BaseFileURL</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">$1</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">&#39; /&gt;</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">newInfo</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">...</span><span style="color:#B07D48;">res</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">cutTitle</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">title</span><span style="color:#999999;">.</span><span style="color:#998418;">length</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">11</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">?</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">title</span><span style="color:#999999;">.</span><span style="color:#59873A;">substring</span><span style="color:#999999;">(</span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">11</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">...</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">title</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">cover</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">BaseFileURL</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">image</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">userId</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">user_id</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">content</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">cp</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">views_count</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">hits</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">getRequestOK</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>NavBar 根据滚动动态显示</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">&lt;!--</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">顶部导航</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">--&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">uni-nav-bar</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">backState</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">2000</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fontColor</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">#FFF</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#FDAEB7;">:titleCenter=&quot;false&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">type</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">transparent</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">slot</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">left</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">image</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">hicon</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">src</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">/static/home.png</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">mode</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">aspectFit</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#FDAEB7;">@tap=&quot;goHome&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">&lt;/</span><span style="color:#B8A965;">uni-nav-bar</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">&lt;</span><span style="color:#B8A965;">uni-nav-bar</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">v-if</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">navBarShow</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">backState</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">1000</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#FDAEB7;">:titleCenter=&quot;false&quot;&gt;{{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#FDAEB7;">newInfo.cutTitle</span><span style="color:#DBD7CAEE;"> </span><span style="color:#FDAEB7;">}}&lt;/uni-nav-bar&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#FDAEB7;">data()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#BD976A;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">				</span><span style="color:#758575DD;">// 是否显示 navbar</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">navBarShow</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">}</span><span style="color:#FDAEB7;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#FDAEB7;">onPageScroll(res)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#80A665;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">scrollTop</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">100</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				this.</span><span style="color:#BD976A;">navBarShow</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				this.</span><span style="color:#BD976A;">navBarShow</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">&lt;!--</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">顶部导航</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">--&gt;</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">uni-nav-bar</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">backState</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">2000</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fontColor</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">#FFF</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B31D28;">:titleCenter=&quot;false&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">type</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">transparent</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">slot</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">left</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">image</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">hicon</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">src</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">/static/home.png</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">mode</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">aspectFit</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B31D28;">@tap=&quot;goHome&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">&lt;/</span><span style="color:#998418;">uni-nav-bar</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">&lt;</span><span style="color:#998418;">uni-nav-bar</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">v-if</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">navBarShow</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">backState</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">1000</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B31D28;">:titleCenter=&quot;false&quot;&gt;{{</span><span style="color:#393A34;"> </span><span style="color:#B31D28;">newInfo.cutTitle</span><span style="color:#393A34;"> </span><span style="color:#B31D28;">}}&lt;/uni-nav-bar&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#B31D28;">data()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#B07D48;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">				</span><span style="color:#A0ADA0;">// 是否显示 navbar</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">navBarShow</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">}</span><span style="color:#B31D28;">,</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#B31D28;">onPageScroll(res)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#59873A;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">scrollTop</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">100</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				this.</span><span style="color:#B07D48;">navBarShow</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				this.</span><span style="color:#B07D48;">navBarShow</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="_3-5-评论组件评论列表展示功能实现" tabindex="-1">3.5 评论组件评论列表展示功能实现 <a class="header-anchor" href="#_3-5-评论组件评论列表展示功能实现" aria-hidden="true">#</a></h3><p>关键技术点：使用 props 接收到的数据可以直接渲染到页面上，但是 props 接收到的数据如果修改后，则不会动态触发 对应 dom 结构的内容更新，我们需要做一个变量去保存 props 传递的初始化值然后基于此变量更新页面结构和内容</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;">&lt;!-- 评论列表 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">comments</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">title gohere</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">id</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">gohere</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">ref</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">gohere</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">最新评论</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">no-comment</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">v-if</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">commintsList</span><span style="color:#666666;">.</span><span style="color:#B8A965;">length</span><span style="color:#666666;"> </span><span style="color:#CB7676;">==</span><span style="color:#666666;"> </span><span style="color:#4C9A91;">0</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                &gt;</span><span style="color:#DBD7CAEE;">暂无评论</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span></span>
<span class="line"><span style="color:#666666;">            &gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span></span>
<span class="line"><span style="color:#666666;">                </span><span style="color:#BD976A;">v-for</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">(</span><span style="color:#BD976A;">commentItem</span><span style="color:#666666;">, </span><span style="color:#BD976A;">index</span><span style="color:#666666;">) </span><span style="color:#CB7676;">in</span><span style="color:#666666;"> </span><span style="color:#BD976A;">commintsList</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                :</span><span style="color:#BD976A;">key</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">index</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">one-comment</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">            &gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#758575DD;">&lt;!-- 一级评论相关 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">commenter</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">info</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                        </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">left</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                            </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-avatar</span></span>
<span class="line"><span style="color:#666666;">                                </span><span style="color:#BD976A;">size</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">50</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                                </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">avatar</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                                :</span><span style="color:#BD976A;">src</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                                    </span><span style="color:#CB7676;">!!</span><span style="color:#BD976A;">commentItem</span><span style="color:#666666;">.</span><span style="color:#BD976A;">user</span><span style="color:#666666;">.</span><span style="color:#BD976A;">avatar</span></span>
<span class="line"><span style="color:#666666;">                                        </span><span style="color:#CB7676;">?</span><span style="color:#666666;"> </span><span style="color:#BD976A;">commentItem</span><span style="color:#666666;">.</span><span style="color:#BD976A;">user</span><span style="color:#666666;">.</span><span style="color:#BD976A;">avatar</span><span style="color:#666666;">.</span><span style="color:#BD976A;">url</span></span>
<span class="line"><span style="color:#666666;">                                        </span><span style="color:#CB7676;">:</span><span style="color:#666666;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span></span>
<span class="line"><span style="color:#666666;">                                </span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                            /&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                            </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">name</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;{{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                                </span><span style="color:#BD976A;">commentItem</span><span style="color:#666666;">.</span><span style="color:#BD976A;">user</span><span style="color:#666666;">.</span><span style="color:#BD976A;">name</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                            </span><span style="color:#666666;">}}&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                        </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">content</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;{{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">commentItem</span><span style="color:#666666;">.</span><span style="color:#BD976A;">body</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}}&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">uptime</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">                        &gt;{{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">commentItem</span><span style="color:#666666;">.</span><span style="color:#BD976A;">created_at</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">|</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">timeFormate</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}}</span><span style="color:#DBD7CAEE;"> 评论</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span></span>
<span class="line"><span style="color:#666666;">                    &gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">script</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">timeFrom</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">@/tools/timeFrom.js</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">props</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">oneInfo</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Object</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">type</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">String</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">data</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 当前动态评论列表详情</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">commintsList</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[],</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// props 传递的数据无法改变触发 DOM 更新</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">oneInfoClone</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[],</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#CB7676;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">created</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfo</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">getCommentsList</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">methods</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 获取评论列表</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#CB7676;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">getCommentsList</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">type</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">feed</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">                </span><span style="color:#758575DD;">// 获取当前动态评论列表信息</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">getFeedComments</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">commintsList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">comments</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">                </span><span style="color:#758575DD;">// 获取当前资讯评论列表信息</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">getNewComments</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">commintsList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">comments</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 过滤器</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">filters</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#80A665;">timeFormate</span><span style="color:#666666;">(</span><span style="color:#BD976A;">timeDate</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Time</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">Date</span><span style="color:#666666;">(</span><span style="color:#BD976A;">timeDate</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">timestemp</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Time</span><span style="color:#666666;">.</span><span style="color:#80A665;">getTime</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">t</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">timeFrom</span><span style="color:#666666;">(</span><span style="color:#BD976A;">timestemp</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">yyyy年mm月dd日</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">t</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">script</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;">&lt;!-- 评论列表 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">comments</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">title gohere</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">id</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">gohere</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">ref</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">gohere</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">最新评论</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">no-comment</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">v-if</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">commintsList</span><span style="color:#999999;">.</span><span style="color:#998418;">length</span><span style="color:#999999;"> </span><span style="color:#AB5959;">==</span><span style="color:#999999;"> </span><span style="color:#2F798A;">0</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                &gt;</span><span style="color:#393A34;">暂无评论</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span></span>
<span class="line"><span style="color:#999999;">            &gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span></span>
<span class="line"><span style="color:#999999;">                </span><span style="color:#B07D48;">v-for</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">(</span><span style="color:#B07D48;">commentItem</span><span style="color:#999999;">, </span><span style="color:#B07D48;">index</span><span style="color:#999999;">) </span><span style="color:#AB5959;">in</span><span style="color:#999999;"> </span><span style="color:#B07D48;">commintsList</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                :</span><span style="color:#B07D48;">key</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">index</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">one-comment</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">            &gt;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A0ADA0;">&lt;!-- 一级评论相关 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">commenter</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">info</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">                        </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">left</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">                            </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-avatar</span></span>
<span class="line"><span style="color:#999999;">                                </span><span style="color:#B07D48;">size</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">50</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                                </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">avatar</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                                :</span><span style="color:#B07D48;">src</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                                    </span><span style="color:#AB5959;">!!</span><span style="color:#B07D48;">commentItem</span><span style="color:#999999;">.</span><span style="color:#B07D48;">user</span><span style="color:#999999;">.</span><span style="color:#B07D48;">avatar</span></span>
<span class="line"><span style="color:#999999;">                                        </span><span style="color:#AB5959;">?</span><span style="color:#999999;"> </span><span style="color:#B07D48;">commentItem</span><span style="color:#999999;">.</span><span style="color:#B07D48;">user</span><span style="color:#999999;">.</span><span style="color:#B07D48;">avatar</span><span style="color:#999999;">.</span><span style="color:#B07D48;">url</span></span>
<span class="line"><span style="color:#999999;">                                        </span><span style="color:#AB5959;">:</span><span style="color:#999999;"> </span><span style="color:#B56959AA;">&#39;&#39;</span></span>
<span class="line"><span style="color:#999999;">                                </span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                            /&gt;</span></span>
<span class="line"><span style="color:#393A34;">                            </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">name</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;{{</span></span>
<span class="line"><span style="color:#393A34;">                                </span><span style="color:#B07D48;">commentItem</span><span style="color:#999999;">.</span><span style="color:#B07D48;">user</span><span style="color:#999999;">.</span><span style="color:#B07D48;">name</span></span>
<span class="line"><span style="color:#393A34;">                            </span><span style="color:#999999;">}}&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">                        </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">content</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;{{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">commentItem</span><span style="color:#999999;">.</span><span style="color:#B07D48;">body</span><span style="color:#393A34;"> </span><span style="color:#999999;">}}&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">uptime</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">                        &gt;{{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">commentItem</span><span style="color:#999999;">.</span><span style="color:#B07D48;">created_at</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">|</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">timeFormate</span><span style="color:#393A34;"> </span><span style="color:#999999;">}}</span><span style="color:#393A34;"> 评论</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span></span>
<span class="line"><span style="color:#999999;">                    &gt;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">script</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">timeFrom</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">@/tools/timeFrom.js</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">props</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">oneInfo</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Object</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">type</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">String</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">data</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 当前动态评论列表详情</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">commintsList</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[],</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// props 传递的数据无法改变触发 DOM 更新</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">oneInfoClone</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[],</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">created</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfo</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">getCommentsList</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">methods</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 获取评论列表</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#AB5959;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">getCommentsList</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">type</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">feed</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">                </span><span style="color:#A0ADA0;">// 获取当前动态评论列表信息</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">getFeedComments</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">commintsList</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">comments</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">                </span><span style="color:#A0ADA0;">// 获取当前资讯评论列表信息</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">getNewComments</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">commintsList</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">comments</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 过滤器</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">filters</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#59873A;">timeFormate</span><span style="color:#999999;">(</span><span style="color:#B07D48;">timeDate</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Time</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">Date</span><span style="color:#999999;">(</span><span style="color:#B07D48;">timeDate</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">timestemp</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Time</span><span style="color:#999999;">.</span><span style="color:#59873A;">getTime</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">t</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">timeFrom</span><span style="color:#999999;">(</span><span style="color:#B07D48;">timestemp</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">yyyy年mm月dd日</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">t</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">script</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><h2 id="四、用户注册、登陆业务功能实现" tabindex="-1">四、用户注册、登陆业务功能实现 <a class="header-anchor" href="#四、用户注册、登陆业务功能实现" aria-hidden="true">#</a></h2><h3 id="_4-1-用户登陆、注册功能组件实现及触发显示" tabindex="-1">4.1 用户登陆、注册功能组件实现及触发显示 <a class="header-anchor" href="#_4-1-用户登陆、注册功能组件实现及触发显示" aria-hidden="true">#</a></h3><p>关键技术点：</p><ol><li>获取当前微信用户的 昵称 和 头像信息</li><li>使用 u-form 实现登陆、手机注册、邮箱注册基础逻辑</li><li>使用 u-form 实现表单验证相关逻辑</li></ol><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">login</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> :</span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">{</span><span style="color:#B8A965;">show</span><span style="color:#666666;">:</span><span style="color:#BD976A;">show</span><span style="color:#666666;">}</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">button</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">submit-btn</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">open-type</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">getUserInfo</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> @</span><span style="color:#BD976A;">getuserinfo</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">getWechatUserInfo</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">v-if</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">getUserInfoTag</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">image</span><span style="color:#666666;"> </span><span style="color:#BD976A;">src</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">/static/wechat.png</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">wechat-img</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> /&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">text</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">一键获取微信信息</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">text</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">button</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-form</span><span style="color:#666666;"> :</span><span style="color:#BD976A;">model</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">form</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">ref</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">uForm</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">v-show</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#CB7676;">!</span><span style="color:#BD976A;">getUserInfoTag</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-form-item</span><span style="color:#666666;"> </span><span style="color:#BD976A;">label</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">账号</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">prop</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">login</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">label-width</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">150</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">required</span><span style="color:#666666;"> </span><span style="color:#BD976A;">v-if</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">loginType</span><span style="color:#666666;"> </span><span style="color:#CB7676;">===</span><span style="color:#666666;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">login</span><span style="color:#C98A7DAA;">&#39;&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-input</span><span style="color:#666666;"> </span><span style="color:#BD976A;">v-model</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">form</span><span style="color:#666666;">.</span><span style="color:#BD976A;">login</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">placeholder</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">输入手机号/邮箱/昵称</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;"> /&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">u-form-item</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-form-item</span><span style="color:#666666;"> </span><span style="color:#BD976A;">label</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">密码</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">label-width</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">150</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">required</span><span style="color:#666666;"> </span><span style="color:#BD976A;">prop</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">password</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-input</span><span style="color:#666666;"> </span><span style="color:#BD976A;">v-model</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">form</span><span style="color:#666666;">.</span><span style="color:#BD976A;">password</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">type</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">password</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">placeholder</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">限4-20个字符,区分大小写</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;"> /&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">u-form-item</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">btns</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-button</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">ubtn</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> @</span><span style="color:#BD976A;">click</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">submit</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">提交</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">u-button</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-button</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">ubtn</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> @</span><span style="color:#BD976A;">click</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">cancel</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">取消</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">u-button</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">type</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-subsection</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">active-color</span><span style="color:#DBD7CAEE;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">#007cba</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">font-size</span><span style="color:#DBD7CAEE;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">24</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">height</span><span style="color:#DBD7CAEE;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">52</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">:</span><span style="color:#BD976A;">list</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">subsectionList</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">:</span><span style="color:#BD976A;">current</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#4C9A91;">0</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">@</span><span style="color:#BD976A;">change</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">sectionChange</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;&lt;/</span><span style="color:#4D9375;">u-subsection</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">u-form</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">script</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#80A665;">data</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">				</span><span style="color:#758575DD;">// 登陆组件是否显示</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">show</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">				</span><span style="color:#758575DD;">// 登陆方式</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">loginType</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">login</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">				</span><span style="color:#758575DD;">// 登陆方式选择器</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">subsectionList</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[{</span><span style="color:#DBD7CAEE;">	</span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">账号登陆</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;">	</span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">手机注册</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;">	</span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">邮箱注册</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">],</span></span>
<span class="line"><span style="color:#666666;">				</span><span style="color:#758575DD;">// 是否获取用户信息</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">getUserInfoTag</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">				</span><span style="color:#758575DD;">// 用户信息输入框</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">form</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">login</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">avatar</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">phone</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">email</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">code</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">password</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">repassword</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">				</span><span style="color:#758575DD;">// 用户输入规则校验</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">rules</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">login</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#B8A965;">validator</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">rule</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">value</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">callback</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#80A665;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">this.loginType === </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">login</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">!</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">test</span><span style="color:#666666;">.</span><span style="color:#80A665;">isEmpty</span><span style="color:#666666;">(</span><span style="color:#BD976A;">value</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> else {</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								return </span><span style="color:#BD976A;">true</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#BD976A;">message</span><span style="color:#DBD7CAEE;">: </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">必填 * 输入内容不许为空</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#BD976A;">trigger</span><span style="color:#DBD7CAEE;">: </span><span style="color:#666666;">[</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">change</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">blur</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">],</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					}</span><span style="color:#666666;">],</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">asyncValidator</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">rule</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">value</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">callback</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								this.$u.api.findUser({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">									</span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">value</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;">)</span><span style="color:#666666;">.</span><span style="color:#80A665;">then</span><span style="color:#666666;">(</span><span style="color:#BD976A;">res</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#666666;">									</span><span style="color:#758575DD;">// 如果验证不通过，需要在callback()抛出new Error(&#39;错误提示信息&#39;)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">									</span><span style="color:#80A665;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">!!</span><span style="color:#BD976A;">value</span><span style="color:#DBD7CAEE;"> &amp;&amp; res.statusCode === 200</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">										</span><span style="color:#80A665;">callback</span><span style="color:#666666;">(</span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">Error</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">当前用户昵称已存在</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">));</span></span>
<span class="line"><span style="color:#DBD7CAEE;">									</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> else {</span></span>
<span class="line"><span style="color:#666666;">										</span><span style="color:#758575DD;">// 如果校验通过，也要执行callback()回调</span></span>
<span class="line"><span style="color:#DBD7CAEE;">										</span><span style="color:#80A665;">callback</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">									</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								}</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#BD976A;">trigger</span><span style="color:#DBD7CAEE;">: </span><span style="color:#666666;">[</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">blur</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">],</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">],</span></span>
<span class="line"><span style="color:#666666;">         </span><span style="color:#758575DD;">// ... 其他验证规则</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">		</span><span style="color:#758575DD;">// 必须要在onReady生命周期设置校验规则，因为onLoad生命周期组件可能尚未创建完毕</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#80A665;">onReady</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$refs</span><span style="color:#666666;">.</span><span style="color:#BD976A;">uForm</span><span style="color:#666666;">.</span><span style="color:#80A665;">setRules</span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">rules</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#CB7676;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">created</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 每次这个组件展开，我们就去判断一下当前 token 是否可以获取新的 token 如果可以获取，咱们就关闭登陆状态</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">getUserMsg</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 点赞消息数量</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">statusCode</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">200</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">show</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#4D9375;">return</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">show</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#BD976A;">wx</span><span style="color:#666666;">.</span><span style="color:#80A665;">getSetting</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#B8A965;">success</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#80A665;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">res.authSetting</span><span style="color:#666666;">[</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">scope.userInfo</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">])</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">getUserInfo</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">success</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 如果用户授权了，则做两件事，第一件事</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								this.form.</span><span style="color:#BD976A;">login</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">nickName</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								this.form.</span><span style="color:#BD976A;">name</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">nickName</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								this.form.</span><span style="color:#BD976A;">avatar</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">avatarUrl</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								this.</span><span style="color:#BD976A;">getUserInfoTag</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">fail</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								console.log(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">用户未授权！</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#B8A965;">)</span></span>
<span class="line"><span style="color:#B8A965;">							}</span></span>
<span class="line"><span style="color:#B8A965;">						})</span></span>
<span class="line"><span style="color:#B8A965;">					}</span></span>
<span class="line"><span style="color:#B8A965;">				}</span></span>
<span class="line"><span style="color:#B8A965;">			})</span></span>
<span class="line"><span style="color:#B8A965;">		},</span></span>
<span class="line"><span style="color:#B8A965;">		methods</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 关闭弹窗</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#80A665;">closeLogin</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">show</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 打开登陆弹窗</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#80A665;">openLogin</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">show</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 跳转到 H5 页面</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#80A665;">gotoWeb</span><span style="color:#666666;">(</span><span style="color:#BD976A;">url</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#BD976A;">wx</span><span style="color:#666666;">.</span><span style="color:#80A665;">navigateTo</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">url</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">/pages/webview/webview?url=</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">encodeURI</span><span style="color:#666666;">(</span><span style="color:#BD976A;">url</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 微信授权</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#80A665;">getWechatUserInfo</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">getUserInfo</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">success</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#666666;">						</span><span style="color:#758575DD;">// 进行下一步操作</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						this.</span><span style="color:#BD976A;">getUserInfoTag</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						this.form.</span><span style="color:#BD976A;">login</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">nickName</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						this.form.</span><span style="color:#BD976A;">name</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">nickName</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						this.form.</span><span style="color:#BD976A;">avatar</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">avatarUrl</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">fail</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						console.log(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">用户未授权！</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#B8A965;">)</span></span>
<span class="line"><span style="color:#B8A965;">					}</span></span>
<span class="line"><span style="color:#B8A965;">				})</span></span>
<span class="line"><span style="color:#B8A965;">			},</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 获取验证码</span></span>
<span class="line"><span style="color:#B8A965;">			getCode() {</span></span>
<span class="line"><span style="color:#B8A965;">				uni.showModal({</span></span>
<span class="line"><span style="color:#B8A965;">					title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">验证码获取成功</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">content</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">8888</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 取消表单输入</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#80A665;">cancel</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				this.</span><span style="color:#BD976A;">form</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">login</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">phone</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">email</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">code</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">password</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">repassword</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 提交表单验证</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#80A665;">submit</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				this.$refs.uForm.validate(async </span><span style="color:#BD976A;">valid</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#80A665;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">!</span><span style="color:#BD976A;">valid</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showToast</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">请检查输入</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">icon</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">loading</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#666666;">})</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#80A665;">switch</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">this.loginType</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#4D9375;">case</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">login</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resa</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">userLogin</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">login</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">form</span><span style="color:#666666;">.</span><span style="color:#BD976A;">login</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">password</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">form</span><span style="color:#666666;">.</span><span style="color:#BD976A;">password</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">})</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">resa</span><span style="color:#666666;">.</span><span style="color:#BD976A;">statusCode</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">200</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 登陆成功</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">loginAfter</span><span style="color:#666666;">(</span><span style="color:#BD976A;">resa</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">access_token</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showModal</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">									</span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">登陆失败</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">									</span><span style="color:#B8A965;">content</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resa</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">message</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#666666;">})</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#4D9375;">break</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#4D9375;">case</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">phone</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resb</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">userRegister</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 必须，用户名</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">form</span><span style="color:#666666;">.</span><span style="color:#BD976A;">name</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 必须，验证码发送模式。</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">verifiable_type</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">sms</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 必须，用户收到的验证码。(教学阶段验证码统一使用 8888 )</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">verifiable_code</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">8888</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 如果 `verifiable_type` 为 `sms` 则必须, 手机号码。</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">phone</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">form</span><span style="color:#666666;">.</span><span style="color:#BD976A;">phone</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 可选，密码，如果不输入密码，允许用户无密码注册。</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">password</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">form</span><span style="color:#666666;">.</span><span style="color:#BD976A;">password</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">})</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#BD976A;">resb</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">resb</span><span style="color:#666666;">.</span><span style="color:#BD976A;">statusCode</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">201</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 登陆成功</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">loginAfter</span><span style="color:#666666;">(</span><span style="color:#BD976A;">resb</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">token</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showModal</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">									</span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">登陆失败</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">									</span><span style="color:#B8A965;">content</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resb</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">message</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#666666;">})</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#4D9375;">break</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#4D9375;">case</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">email</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resc</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">userRegister</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 必须，用户名</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">form</span><span style="color:#666666;">.</span><span style="color:#BD976A;">name</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 必须，验证码发送模式。</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">verifiable_type</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">mail</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 必须，用户收到的验证码。(教学阶段验证码统一使用 8888 )</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">verifiable_code</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">8888</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 如果 `verifiable_type` 为 `mail` 则必须, E-Mail。</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">email</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">form</span><span style="color:#666666;">.</span><span style="color:#BD976A;">email</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 可选，密码，如果不输入密码，允许用户无密码注册。</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">password</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">form</span><span style="color:#666666;">.</span><span style="color:#BD976A;">password</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">})</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#BD976A;">resc</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">resc</span><span style="color:#666666;">.</span><span style="color:#BD976A;">statusCode</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">201</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">								</span><span style="color:#758575DD;">// 登陆成功</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">loginAfter</span><span style="color:#666666;">(</span><span style="color:#BD976A;">resc</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">token</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showModal</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">									</span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">登陆失败</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">									</span><span style="color:#B8A965;">content</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resc</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">message</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#666666;">})</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#4D9375;">break</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showToast</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">未知用户状态</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">								</span><span style="color:#B8A965;">icon</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">loading</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#666666;">})</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#4D9375;">break</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 注册、登陆成功后设置相关逻辑</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#BD976A;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">loginAfter</span><span style="color:#666666;">(</span><span style="color:#BD976A;">token</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				this.</span><span style="color:#BD976A;">show</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				uni.setStorageSync(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">token</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> token)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">				</span><span style="color:#758575DD;">// 获取未读消息提示</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				let </span><span style="color:#BD976A;">res</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">getUserMsg</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				let </span><span style="color:#BD976A;">name</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">form</span><span style="color:#666666;">.</span><span style="color:#BD976A;">name</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#80A665;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">this.loginType === </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">login</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#BD976A;">name</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">form</span><span style="color:#666666;">.</span><span style="color:#BD976A;">login</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				let </span><span style="color:#BD976A;">loginInfo</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#BD976A;">name</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">avatar</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">form</span><span style="color:#666666;">.</span><span style="color:#BD976A;">avatar</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">liked</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">user</span><span style="color:#666666;">.</span><span style="color:#BD976A;">liked</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">commented</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">user</span><span style="color:#666666;">.</span><span style="color:#BD976A;">commented</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				this.userLoginAction(loginInfo)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				uni.$emit(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">userLogin</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#B8A965;">)</span></span>
<span class="line"><span style="color:#B8A965;">			},</span></span>
<span class="line"><span style="color:#666666;">			</span><span style="color:#758575DD;">// 更改 登陆 注册 方式选择</span></span>
<span class="line"><span style="color:#B8A965;">			sectionChange(index) {</span></span>
<span class="line"><span style="color:#B8A965;">				switch (index) {</span></span>
<span class="line"><span style="color:#B8A965;">					case 1</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">loginType</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">phone</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#BD976A;">break</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#BD976A;">case</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">2</span><span style="color:#DBD7CAEE;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">loginType</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">email</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#BD976A;">break</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#BD976A;">default</span><span style="color:#DBD7CAEE;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">loginType</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">login</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#BD976A;">break</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">		}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	}</span></span>
<span class="line"><span style="color:#CB7676;">&lt;/</span><span style="color:#BD976A;">script</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">login</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> :</span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">{</span><span style="color:#998418;">show</span><span style="color:#999999;">:</span><span style="color:#B07D48;">show</span><span style="color:#999999;">}</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">button</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">submit-btn</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">open-type</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">getUserInfo</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> @</span><span style="color:#B07D48;">getuserinfo</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">getWechatUserInfo</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">v-if</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">getUserInfoTag</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">image</span><span style="color:#999999;"> </span><span style="color:#B07D48;">src</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">/static/wechat.png</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">wechat-img</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> /&gt;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">text</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">一键获取微信信息</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">text</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">button</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-form</span><span style="color:#999999;"> :</span><span style="color:#B07D48;">model</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">form</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">ref</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">uForm</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">v-show</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#AB5959;">!</span><span style="color:#B07D48;">getUserInfoTag</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-form-item</span><span style="color:#999999;"> </span><span style="color:#B07D48;">label</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">账号</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">prop</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">login</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">label-width</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">150</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">required</span><span style="color:#999999;"> </span><span style="color:#B07D48;">v-if</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">loginType</span><span style="color:#999999;"> </span><span style="color:#AB5959;">===</span><span style="color:#999999;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">login</span><span style="color:#B56959AA;">&#39;&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-input</span><span style="color:#999999;"> </span><span style="color:#B07D48;">v-model</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">form</span><span style="color:#999999;">.</span><span style="color:#B07D48;">login</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">placeholder</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">输入手机号/邮箱/昵称</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;"> /&gt;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">u-form-item</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-form-item</span><span style="color:#999999;"> </span><span style="color:#B07D48;">label</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">密码</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">label-width</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">150</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">required</span><span style="color:#999999;"> </span><span style="color:#B07D48;">prop</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">password</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-input</span><span style="color:#999999;"> </span><span style="color:#B07D48;">v-model</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">form</span><span style="color:#999999;">.</span><span style="color:#B07D48;">password</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">type</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">password</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">placeholder</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">限4-20个字符,区分大小写</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;"> /&gt;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">u-form-item</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">btns</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-button</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">ubtn</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> @</span><span style="color:#B07D48;">click</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">submit</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">提交</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">u-button</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-button</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">ubtn</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> @</span><span style="color:#B07D48;">click</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">cancel</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">取消</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">u-button</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">type</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-subsection</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">active-color</span><span style="color:#393A34;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">#007cba</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">font-size</span><span style="color:#393A34;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">24</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">height</span><span style="color:#393A34;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">52</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">:</span><span style="color:#B07D48;">list</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">subsectionList</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">:</span><span style="color:#B07D48;">current</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#2F798A;">0</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">@</span><span style="color:#B07D48;">change</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">sectionChange</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;&lt;/</span><span style="color:#1E754F;">u-subsection</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">u-form</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">script</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#59873A;">data</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">				</span><span style="color:#A0ADA0;">// 登陆组件是否显示</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">show</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">				</span><span style="color:#A0ADA0;">// 登陆方式</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">loginType</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">login</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">				</span><span style="color:#A0ADA0;">// 登陆方式选择器</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">subsectionList</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[{</span><span style="color:#393A34;">	</span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">账号登陆</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">{</span><span style="color:#393A34;">	</span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">手机注册</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;">	</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">{</span><span style="color:#393A34;">	</span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">邮箱注册</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;">	</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">],</span></span>
<span class="line"><span style="color:#999999;">				</span><span style="color:#A0ADA0;">// 是否获取用户信息</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">getUserInfoTag</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">				</span><span style="color:#A0ADA0;">// 用户信息输入框</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">form</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">login</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">avatar</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">phone</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">email</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">code</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">password</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">repassword</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">				</span><span style="color:#A0ADA0;">// 用户输入规则校验</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">rules</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">login</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[{</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#998418;">validator</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">rule</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">value</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">callback</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#59873A;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#393A34;">this.loginType === </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">login</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">!</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">test</span><span style="color:#999999;">.</span><span style="color:#59873A;">isEmpty</span><span style="color:#999999;">(</span><span style="color:#B07D48;">value</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">}</span><span style="color:#393A34;"> else {</span></span>
<span class="line"><span style="color:#393A34;">								return </span><span style="color:#B07D48;">true</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#B07D48;">message</span><span style="color:#393A34;">: </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">必填 * 输入内容不许为空</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#B07D48;">trigger</span><span style="color:#393A34;">: </span><span style="color:#999999;">[</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">change</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">blur</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">],</span></span>
<span class="line"><span style="color:#393A34;">					}</span><span style="color:#999999;">],</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[{</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">asyncValidator</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">rule</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">value</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">callback</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">								this.$u.api.findUser({</span></span>
<span class="line"><span style="color:#393A34;">									</span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">value</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#999999;">}</span><span style="color:#393A34;">)</span><span style="color:#999999;">.</span><span style="color:#59873A;">then</span><span style="color:#999999;">(</span><span style="color:#B07D48;">res</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#999999;">									</span><span style="color:#A0ADA0;">// 如果验证不通过，需要在callback()抛出new Error(&#39;错误提示信息&#39;)</span></span>
<span class="line"><span style="color:#393A34;">									</span><span style="color:#59873A;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#393A34;">!!</span><span style="color:#B07D48;">value</span><span style="color:#393A34;"> &amp;&amp; res.statusCode === 200</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">										</span><span style="color:#59873A;">callback</span><span style="color:#999999;">(</span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">Error</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">当前用户昵称已存在</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">));</span></span>
<span class="line"><span style="color:#393A34;">									</span><span style="color:#999999;">}</span><span style="color:#393A34;"> else {</span></span>
<span class="line"><span style="color:#999999;">										</span><span style="color:#A0ADA0;">// 如果校验通过，也要执行callback()回调</span></span>
<span class="line"><span style="color:#393A34;">										</span><span style="color:#59873A;">callback</span><span style="color:#999999;">()</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">									</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">								}</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#B07D48;">trigger</span><span style="color:#393A34;">: </span><span style="color:#999999;">[</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">blur</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">],</span></span>
<span class="line"><span style="color:#393A34;">						}</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">],</span></span>
<span class="line"><span style="color:#999999;">         </span><span style="color:#A0ADA0;">// ... 其他验证规则</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">		</span><span style="color:#A0ADA0;">// 必须要在onReady生命周期设置校验规则，因为onLoad生命周期组件可能尚未创建完毕</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#59873A;">onReady</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$refs</span><span style="color:#999999;">.</span><span style="color:#B07D48;">uForm</span><span style="color:#999999;">.</span><span style="color:#59873A;">setRules</span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">rules</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#AB5959;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">created</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 每次这个组件展开，我们就去判断一下当前 token 是否可以获取新的 token 如果可以获取，咱们就关闭登陆状态</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">getUserMsg</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 点赞消息数量</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">statusCode</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">200</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">show</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#1E754F;">return</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">show</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#B07D48;">wx</span><span style="color:#999999;">.</span><span style="color:#59873A;">getSetting</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#998418;">success</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#59873A;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#393A34;">res.authSetting</span><span style="color:#999999;">[</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">scope.userInfo</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">])</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">getUserInfo</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">success</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 如果用户授权了，则做两件事，第一件事</span></span>
<span class="line"><span style="color:#393A34;">								this.form.</span><span style="color:#B07D48;">login</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">nickName</span></span>
<span class="line"><span style="color:#393A34;">								this.form.</span><span style="color:#B07D48;">name</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">nickName</span></span>
<span class="line"><span style="color:#393A34;">								this.form.</span><span style="color:#B07D48;">avatar</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">avatarUrl</span></span>
<span class="line"><span style="color:#393A34;">								this.</span><span style="color:#B07D48;">getUserInfoTag</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">fail</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">								console.log(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">用户未授权！</span><span style="color:#B56959AA;">&#39;</span><span style="color:#998418;">)</span></span>
<span class="line"><span style="color:#998418;">							}</span></span>
<span class="line"><span style="color:#998418;">						})</span></span>
<span class="line"><span style="color:#998418;">					}</span></span>
<span class="line"><span style="color:#998418;">				}</span></span>
<span class="line"><span style="color:#998418;">			})</span></span>
<span class="line"><span style="color:#998418;">		},</span></span>
<span class="line"><span style="color:#998418;">		methods</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 关闭弹窗</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#59873A;">closeLogin</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">show</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 打开登陆弹窗</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#59873A;">openLogin</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">show</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 跳转到 H5 页面</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#59873A;">gotoWeb</span><span style="color:#999999;">(</span><span style="color:#B07D48;">url</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#B07D48;">wx</span><span style="color:#999999;">.</span><span style="color:#59873A;">navigateTo</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">url</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">/pages/webview/webview?url=</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#59873A;">encodeURI</span><span style="color:#999999;">(</span><span style="color:#B07D48;">url</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 微信授权</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#59873A;">getWechatUserInfo</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">getUserInfo</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">success</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#999999;">						</span><span style="color:#A0ADA0;">// 进行下一步操作</span></span>
<span class="line"><span style="color:#393A34;">						this.</span><span style="color:#B07D48;">getUserInfoTag</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span></span>
<span class="line"><span style="color:#393A34;">						this.form.</span><span style="color:#B07D48;">login</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">nickName</span></span>
<span class="line"><span style="color:#393A34;">						this.form.</span><span style="color:#B07D48;">name</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">nickName</span></span>
<span class="line"><span style="color:#393A34;">						this.form.</span><span style="color:#B07D48;">avatar</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">avatarUrl</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">fail</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">						console.log(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">用户未授权！</span><span style="color:#B56959AA;">&#39;</span><span style="color:#998418;">)</span></span>
<span class="line"><span style="color:#998418;">					}</span></span>
<span class="line"><span style="color:#998418;">				})</span></span>
<span class="line"><span style="color:#998418;">			},</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 获取验证码</span></span>
<span class="line"><span style="color:#998418;">			getCode() {</span></span>
<span class="line"><span style="color:#998418;">				uni.showModal({</span></span>
<span class="line"><span style="color:#998418;">					title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">验证码获取成功</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">content</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">8888</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">}</span><span style="color:#393A34;">)</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 取消表单输入</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#59873A;">cancel</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				this.</span><span style="color:#B07D48;">form</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">login</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">phone</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">email</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">code</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">password</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">repassword</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 提交表单验证</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#59873A;">submit</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				this.$refs.uForm.validate(async </span><span style="color:#B07D48;">valid</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#59873A;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#393A34;">!</span><span style="color:#B07D48;">valid</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showToast</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">请检查输入</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">icon</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">loading</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#999999;">})</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#59873A;">switch</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#393A34;">this.loginType</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#1E754F;">case</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">login</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;">:</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resa</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">userLogin</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">login</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">form</span><span style="color:#999999;">.</span><span style="color:#B07D48;">login</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">password</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">form</span><span style="color:#999999;">.</span><span style="color:#B07D48;">password</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">})</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">resa</span><span style="color:#999999;">.</span><span style="color:#B07D48;">statusCode</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">200</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 登陆成功</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">loginAfter</span><span style="color:#999999;">(</span><span style="color:#B07D48;">resa</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">access_token</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showModal</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">									</span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">登陆失败</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">									</span><span style="color:#998418;">content</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resa</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">message</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#999999;">})</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#1E754F;">break</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#1E754F;">case</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">phone</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;">:</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resb</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">userRegister</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 必须，用户名</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">form</span><span style="color:#999999;">.</span><span style="color:#B07D48;">name</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 必须，验证码发送模式。</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">verifiable_type</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">sms</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 必须，用户收到的验证码。(教学阶段验证码统一使用 8888 )</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">verifiable_code</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">8888</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 如果 `verifiable_type` 为 `sms` 则必须, 手机号码。</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">phone</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">form</span><span style="color:#999999;">.</span><span style="color:#B07D48;">phone</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 可选，密码，如果不输入密码，允许用户无密码注册。</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">password</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">form</span><span style="color:#999999;">.</span><span style="color:#B07D48;">password</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">})</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B07D48;">resb</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">resb</span><span style="color:#999999;">.</span><span style="color:#B07D48;">statusCode</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">201</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 登陆成功</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">loginAfter</span><span style="color:#999999;">(</span><span style="color:#B07D48;">resb</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">token</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showModal</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">									</span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">登陆失败</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">									</span><span style="color:#998418;">content</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resb</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">message</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#999999;">})</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#1E754F;">break</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#1E754F;">case</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">email</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;">:</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resc</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">userRegister</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 必须，用户名</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">form</span><span style="color:#999999;">.</span><span style="color:#B07D48;">name</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 必须，验证码发送模式。</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">verifiable_type</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">mail</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 必须，用户收到的验证码。(教学阶段验证码统一使用 8888 )</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">verifiable_code</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">8888</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 如果 `verifiable_type` 为 `mail` 则必须, E-Mail。</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">email</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">form</span><span style="color:#999999;">.</span><span style="color:#B07D48;">email</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 可选，密码，如果不输入密码，允许用户无密码注册。</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">password</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">form</span><span style="color:#999999;">.</span><span style="color:#B07D48;">password</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">})</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B07D48;">resc</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">resc</span><span style="color:#999999;">.</span><span style="color:#B07D48;">statusCode</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">201</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">								</span><span style="color:#A0ADA0;">// 登陆成功</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">loginAfter</span><span style="color:#999999;">(</span><span style="color:#B07D48;">resc</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">token</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showModal</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">									</span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">登陆失败</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">									</span><span style="color:#998418;">content</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resc</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">message</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#999999;">})</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#1E754F;">break</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#1E754F;">default</span><span style="color:#393A34;">:</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showToast</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">未知用户状态</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">								</span><span style="color:#998418;">icon</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">loading</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#999999;">})</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#1E754F;">break</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">}</span><span style="color:#393A34;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 注册、登陆成功后设置相关逻辑</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#B07D48;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">loginAfter</span><span style="color:#999999;">(</span><span style="color:#B07D48;">token</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				this.</span><span style="color:#B07D48;">show</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span></span>
<span class="line"><span style="color:#393A34;">				uni.setStorageSync(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">token</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> token)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">				</span><span style="color:#A0ADA0;">// 获取未读消息提示</span></span>
<span class="line"><span style="color:#393A34;">				let </span><span style="color:#B07D48;">res</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">getUserMsg</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">				let </span><span style="color:#B07D48;">name</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">form</span><span style="color:#999999;">.</span><span style="color:#B07D48;">name</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#59873A;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#393A34;">this.loginType === </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">login</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#B07D48;">name</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">form</span><span style="color:#999999;">.</span><span style="color:#B07D48;">login</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">				let </span><span style="color:#B07D48;">loginInfo</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#B07D48;">name</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">avatar</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">form</span><span style="color:#999999;">.</span><span style="color:#B07D48;">avatar</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">liked</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">user</span><span style="color:#999999;">.</span><span style="color:#B07D48;">liked</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">commented</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">user</span><span style="color:#999999;">.</span><span style="color:#B07D48;">commented</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">				this.userLoginAction(loginInfo)</span></span>
<span class="line"><span style="color:#393A34;">				uni.$emit(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">userLogin</span><span style="color:#B56959AA;">&#39;</span><span style="color:#998418;">)</span></span>
<span class="line"><span style="color:#998418;">			},</span></span>
<span class="line"><span style="color:#999999;">			</span><span style="color:#A0ADA0;">// 更改 登陆 注册 方式选择</span></span>
<span class="line"><span style="color:#998418;">			sectionChange(index) {</span></span>
<span class="line"><span style="color:#998418;">				switch (index) {</span></span>
<span class="line"><span style="color:#998418;">					case 1</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">loginType</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">phone</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#B07D48;">break</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#B07D48;">case</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">2</span><span style="color:#393A34;">:</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">loginType</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">email</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#B07D48;">break</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#B07D48;">default</span><span style="color:#393A34;">:</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">loginType</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">login</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#B07D48;">break</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">			}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">		}</span></span>
<span class="line"><span style="color:#393A34;">	}</span></span>
<span class="line"><span style="color:#AB5959;">&lt;/</span><span style="color:#B07D48;">script</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-2-vuex-storage-登陆状态管理" tabindex="-1">4.2 Vuex + Storage 登陆状态管理 <a class="header-anchor" href="#_4-2-vuex-storage-登陆状态管理" aria-hidden="true">#</a></h3><p>关键技术点：</p><ol><li>构建 vuex 注册 main.js 全局，并配合使用 storage 实现刷新后数据保存</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Vue</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">vue</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Vuex</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">vuex</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#BD976A;">Vue</span><span style="color:#666666;">.</span><span style="color:#80A665;">use</span><span style="color:#666666;">(</span><span style="color:#BD976A;">Vuex</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">store</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Vuex</span><span style="color:#666666;">.</span><span style="color:#80A665;">Store</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 这个代表全局可以访问数据对象，就像是咱们在组件中声明的 data 属性</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">state</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">loginState</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">!!</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">getStorageSync</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">loginState</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">?</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">userInfo</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">!!</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">getStorageSync</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">userInfo</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#CB7676;">?</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">JSON</span><span style="color:#666666;">.</span><span style="color:#80A665;">parse</span><span style="color:#666666;">(</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">getStorageSync</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">userInfo</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">))</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#CB7676;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                  </span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">未知用户</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                  </span><span style="color:#B8A965;">avatar</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">/static/nopic.png</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                  </span><span style="color:#B8A965;">liked</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                  </span><span style="color:#B8A965;">commented</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">              </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 这个实时监听 state 内的数据对象变化，类似 咱们组件中的 computed 属性，会依赖 state 数据变化而变化</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">getters</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{},</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 用来同步设置 state 的值</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">mutations</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#80A665;">userLogin</span><span style="color:#666666;">(</span><span style="color:#BD976A;">state</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">state</span><span style="color:#666666;">.</span><span style="color:#BD976A;">loginState</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">state</span><span style="color:#666666;">.</span><span style="color:#BD976A;">userInfo</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">setStorageSync</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">loginState</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">ok</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">setStorageSync</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">userInfo</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">JSON</span><span style="color:#666666;">.</span><span style="color:#80A665;">stringify</span><span style="color:#666666;">(</span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">));</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#80A665;">userLogout</span><span style="color:#666666;">(</span><span style="color:#BD976A;">state</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">state</span><span style="color:#666666;">.</span><span style="color:#BD976A;">loginState</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">state</span><span style="color:#666666;">.</span><span style="color:#BD976A;">userInfo</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">未知用户</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">avatar</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">/static/nopic.png</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">liked</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">commented</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">clearStorageSync</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">userInfo</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">clearStorageSync</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">loginState</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">clearStorageSync</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">token</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 通过提交 mutations 内部的方法，异步更新 state 的状态，官方推荐都使用这种方法比较合适</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">actions</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#80A665;">userLoginAction</span><span style="color:#666666;">(</span><span style="color:#BD976A;">context</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">context</span><span style="color:#666666;">.</span><span style="color:#80A665;">commit</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">userLogin</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#80A665;">userLogoutAction</span><span style="color:#666666;">(</span><span style="color:#BD976A;">context</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">context</span><span style="color:#666666;">.</span><span style="color:#80A665;">commit</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">userLogout</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">store</span><span style="color:#666666;">;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Vue</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">vue</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Vuex</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">vuex</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#B07D48;">Vue</span><span style="color:#999999;">.</span><span style="color:#59873A;">use</span><span style="color:#999999;">(</span><span style="color:#B07D48;">Vuex</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">store</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Vuex</span><span style="color:#999999;">.</span><span style="color:#59873A;">Store</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 这个代表全局可以访问数据对象，就像是咱们在组件中声明的 data 属性</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">state</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">loginState</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">!!</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">getStorageSync</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">loginState</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">?</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">userInfo</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">!!</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">getStorageSync</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">userInfo</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">?</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">JSON</span><span style="color:#999999;">.</span><span style="color:#59873A;">parse</span><span style="color:#999999;">(</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">getStorageSync</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">userInfo</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">))</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                  </span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">未知用户</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                  </span><span style="color:#998418;">avatar</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">/static/nopic.png</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                  </span><span style="color:#998418;">liked</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                  </span><span style="color:#998418;">commented</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">              </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 这个实时监听 state 内的数据对象变化，类似 咱们组件中的 computed 属性，会依赖 state 数据变化而变化</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">getters</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{},</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 用来同步设置 state 的值</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">mutations</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#59873A;">userLogin</span><span style="color:#999999;">(</span><span style="color:#B07D48;">state</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">state</span><span style="color:#999999;">.</span><span style="color:#B07D48;">loginState</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">state</span><span style="color:#999999;">.</span><span style="color:#B07D48;">userInfo</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">setStorageSync</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">loginState</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">ok</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">setStorageSync</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">userInfo</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">JSON</span><span style="color:#999999;">.</span><span style="color:#59873A;">stringify</span><span style="color:#999999;">(</span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">));</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#59873A;">userLogout</span><span style="color:#999999;">(</span><span style="color:#B07D48;">state</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">state</span><span style="color:#999999;">.</span><span style="color:#B07D48;">loginState</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">state</span><span style="color:#999999;">.</span><span style="color:#B07D48;">userInfo</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">未知用户</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">avatar</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">/static/nopic.png</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">liked</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">commented</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">clearStorageSync</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">userInfo</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">clearStorageSync</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">loginState</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">clearStorageSync</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">token</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 通过提交 mutations 内部的方法，异步更新 state 的状态，官方推荐都使用这种方法比较合适</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">actions</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#59873A;">userLoginAction</span><span style="color:#999999;">(</span><span style="color:#B07D48;">context</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">context</span><span style="color:#999999;">.</span><span style="color:#59873A;">commit</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">userLogin</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#59873A;">userLogoutAction</span><span style="color:#999999;">(</span><span style="color:#B07D48;">context</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">context</span><span style="color:#999999;">.</span><span style="color:#59873A;">commit</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">userLogout</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">store</span><span style="color:#999999;">;</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>使用 mapState、mapActions 实现 vuex 变量快速调用</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#BD976A;">mapState</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#BD976A;">mapActions</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">vuex</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#80A665;">computed</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">...</span><span style="color:#80A665;">mapState</span><span style="color:#666666;">([</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">loginState</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">userInfo</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">])</span></span>
<span class="line"><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#80A665;">methods</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">...</span><span style="color:#80A665;">mapActions</span><span style="color:#666666;">([</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">userLoginAction</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">userLogoutAction</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">])</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#B07D48;">mapState</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#B07D48;">mapActions</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">vuex</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#59873A;">computed</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#999999;">...</span><span style="color:#59873A;">mapState</span><span style="color:#999999;">([</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">loginState</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">userInfo</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">])</span></span>
<span class="line"><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#59873A;">methods</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">...</span><span style="color:#59873A;">mapActions</span><span style="color:#999999;">([</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">userLoginAction</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">userLogoutAction</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">])</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>使用 uni.$on $emit 触发首页及个人中心页面登录后对应的数据更新</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// index onload</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$on</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">indexUserLogin</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.</span><span style="color:#BD976A;">currentSwiperIndex</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.</span><span style="color:#BD976A;">feedsList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.$refs.waterfall.clear();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.getFeedsList();</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#758575DD;">// me onload</span></span>
<span class="line"><span style="color:#758575DD;">// 用户登录后触发数据更新</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$on</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">meUserLogin</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">getInfos</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$emit</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">meUserLogin</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$emit</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">indexUserLogin</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// index onload</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$on</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">indexUserLogin</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">    this.</span><span style="color:#B07D48;">currentSwiperIndex</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">    this.</span><span style="color:#B07D48;">feedsList</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">    this.$refs.waterfall.clear();</span></span>
<span class="line"><span style="color:#393A34;">    this.getFeedsList();</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#A0ADA0;">// me onload</span></span>
<span class="line"><span style="color:#A0ADA0;">// 用户登录后触发数据更新</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$on</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">meUserLogin</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">getInfos</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$emit</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">meUserLogin</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$emit</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">indexUserLogin</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-3-个人中心页面基础功能实现" tabindex="-1">4.3 个人中心页面基础功能实现 <a class="header-anchor" href="#_4-3-个人中心页面基础功能实现" aria-hidden="true">#</a></h3><p>关键技术点：</p><ol><li>请求当前登录用户发布动态列表数据</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// 获取当前用户的 动态信息</span></span>
<span class="line"><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">getFeeds</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">type</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">users</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// 获取当前用户的 动态信息</span></span>
<span class="line"><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">getFeeds</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">type</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">users</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>使用 瀑布流 插件实现排版布局</li></ol><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-waterfall</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">v-model</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">feedsList</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ref</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">waterfall</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">template</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">v-slot:left</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">{leftList}</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">... </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">template</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">v-slot:left</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">{leftList}</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">... </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">u-waterfall</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-waterfall</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">v-model</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">feedsList</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ref</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">waterfall</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">template</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">v-slot:left</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">{leftList}</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">... </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">template</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">v-slot:left</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">{leftList}</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">... </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">u-waterfall</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>使用 vuex 状态数据显示用户登录状态</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#BD976A;">mapState</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">		</span><span style="color:#BD976A;">mapActions</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">vuex</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#80A665;">computed</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#666666;">...</span><span style="color:#80A665;">mapState</span><span style="color:#666666;">([</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">loginState</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">userInfo</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">])</span></span>
<span class="line"><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#80A665;">methods</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">...</span><span style="color:#80A665;">mapActions</span><span style="color:#666666;">([</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">userLoginAction</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">userLogoutAction</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">])</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#B07D48;">mapState</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">		</span><span style="color:#B07D48;">mapActions</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">vuex</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#59873A;">computed</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#999999;">...</span><span style="color:#59873A;">mapState</span><span style="color:#999999;">([</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">loginState</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">userInfo</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">])</span></span>
<span class="line"><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#59873A;">methods</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">...</span><span style="color:#59873A;">mapActions</span><span style="color:#999999;">([</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">userLoginAction</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">userLogoutAction</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">])</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>用户删除一条动态更新瀑布流并通信 index 页面同步更新</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// 选择删除一条动态</span></span>
<span class="line"><span style="color:#BD976A;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">openSheet</span><span style="color:#666666;">(</span><span style="color:#BD976A;">fid</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showActionSheet</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">itemList</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">删除</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">],</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">success</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">						console.log(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">删除 id 为</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#B8A965;"> + fid + </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">的动态</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#B8A965;">)</span></span>
<span class="line"><span style="color:#B8A965;">						await this.$u.api.deleteFeed({</span></span>
<span class="line"><span style="color:#B8A965;">							id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fid</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$refs</span><span style="color:#666666;">.</span><span style="color:#BD976A;">waterfall</span><span style="color:#666666;">.</span><span style="color:#80A665;">remove</span><span style="color:#666666;">(</span><span style="color:#BD976A;">fid</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">						</span><span style="color:#758575DD;">// 触发 首页动态 同步删除事件</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$emit</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">indexFeedRemove</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fid</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showToast</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">当前动态已删除</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">duration</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1000</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#666666;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				}</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#758575DD;">// index 页面</span></span>
<span class="line"><span style="color:#758575DD;">// 个人中心删除一条动态后，触发更新首页数据</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$on</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">indexFeedRemove</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fid</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$refs</span><span style="color:#666666;">.</span><span style="color:#BD976A;">waterfall</span><span style="color:#666666;">.</span><span style="color:#80A665;">remove</span><span style="color:#666666;">(</span><span style="color:#BD976A;">fid</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">})</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// 选择删除一条动态</span></span>
<span class="line"><span style="color:#B07D48;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">openSheet</span><span style="color:#999999;">(</span><span style="color:#B07D48;">fid</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showActionSheet</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">itemList</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">删除</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">],</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">success</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">async</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">						console.log(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">删除 id 为</span><span style="color:#B56959AA;">&#39;</span><span style="color:#998418;"> + fid + </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">的动态</span><span style="color:#B56959AA;">&#39;</span><span style="color:#998418;">)</span></span>
<span class="line"><span style="color:#998418;">						await this.$u.api.deleteFeed({</span></span>
<span class="line"><span style="color:#998418;">							id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fid</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#999999;">}</span><span style="color:#393A34;">)</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$refs</span><span style="color:#999999;">.</span><span style="color:#B07D48;">waterfall</span><span style="color:#999999;">.</span><span style="color:#59873A;">remove</span><span style="color:#999999;">(</span><span style="color:#B07D48;">fid</span><span style="color:#999999;">)</span><span style="color:#393A34;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">						</span><span style="color:#A0ADA0;">// 触发 首页动态 同步删除事件</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$emit</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">indexFeedRemove</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fid</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showToast</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">当前动态已删除</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">duration</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1000</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#999999;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">				}</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#A0ADA0;">// index 页面</span></span>
<span class="line"><span style="color:#A0ADA0;">// 个人中心删除一条动态后，触发更新首页数据</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$on</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">indexFeedRemove</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fid</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;{</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$refs</span><span style="color:#999999;">.</span><span style="color:#B07D48;">waterfall</span><span style="color:#999999;">.</span><span style="color:#59873A;">remove</span><span style="color:#999999;">(</span><span style="color:#B07D48;">fid</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">})</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-4-用户设置页面基础功能实现" tabindex="-1">4.4 用户设置页面基础功能实现 <a class="header-anchor" href="#_4-4-用户设置页面基础功能实现" aria-hidden="true">#</a></h3><p>关键技术点：</p><ol><li>使用 vuex 状态管理器 actions 方法快速退出</li><li>使用 uni.$on $emit 触发首页及个人中心页面用户退出后对应的数据更新</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// index onload</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$on</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">indexUserLogout</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.</span><span style="color:#BD976A;">currentSwiperIndex</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.</span><span style="color:#BD976A;">feedsList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.$refs.waterfall.clear();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.getFeedsList();</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#758575DD;">// me onload</span></span>
<span class="line"><span style="color:#758575DD;">// 用户退出后触发数据更新</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$on</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">meUserLogout</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    console.log(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">触发了退出操作</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#B8A965;">);</span></span>
<span class="line"><span style="color:#B8A965;">    this.feedsList = [];</span></span>
<span class="line"><span style="color:#B8A965;">    this.avatar = </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#B8A965;">;</span></span>
<span class="line"><span style="color:#B8A965;">    this.bio = </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#B8A965;">;</span></span>
<span class="line"><span style="color:#B8A965;">    this.$refs.waterfall.clear();</span></span>
<span class="line"><span style="color:#B8A965;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B8A965;">uni.$emit(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">meUserLogout</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#B8A965;">);</span></span>
<span class="line"><span style="color:#B8A965;">uni.$emit(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">indexUserLogout</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#B8A965;">);</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// index onload</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$on</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">indexUserLogout</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">    this.</span><span style="color:#B07D48;">currentSwiperIndex</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">    this.</span><span style="color:#B07D48;">feedsList</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">    this.$refs.waterfall.clear();</span></span>
<span class="line"><span style="color:#393A34;">    this.getFeedsList();</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#A0ADA0;">// me onload</span></span>
<span class="line"><span style="color:#A0ADA0;">// 用户退出后触发数据更新</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$on</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">meUserLogout</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">    console.log(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">触发了退出操作</span><span style="color:#B56959AA;">&#39;</span><span style="color:#998418;">);</span></span>
<span class="line"><span style="color:#998418;">    this.feedsList = [];</span></span>
<span class="line"><span style="color:#998418;">    this.avatar = </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#998418;">;</span></span>
<span class="line"><span style="color:#998418;">    this.bio = </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#998418;">;</span></span>
<span class="line"><span style="color:#998418;">    this.$refs.waterfall.clear();</span></span>
<span class="line"><span style="color:#998418;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#998418;">uni.$emit(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">meUserLogout</span><span style="color:#B56959AA;">&#39;</span><span style="color:#998418;">);</span></span>
<span class="line"><span style="color:#998418;">uni.$emit(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">indexUserLogout</span><span style="color:#B56959AA;">&#39;</span><span style="color:#998418;">);</span></span>
<span class="line"></span></code></pre></div><h2 id="五、登陆态下业务功能实现" tabindex="-1">五、登陆态下业务功能实现 <a class="header-anchor" href="#五、登陆态下业务功能实现" aria-hidden="true">#</a></h2><h3 id="_5-1-使用-mixins-实现动态点赞、取消点赞功能" tabindex="-1">5.1 使用 mixins 实现动态点赞、取消点赞功能 <a class="header-anchor" href="#_5-1-使用-mixins-实现动态点赞、取消点赞功能" aria-hidden="true">#</a></h3><p>关键技术点：</p><ol><li>使用 mixins 构建复用的动态 点赞、取消点赞 事件方法</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">feedMixin</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">methods</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 点赞或者取消点赞一条动态</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#CB7676;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">clickLove</span><span style="color:#666666;">(</span><span style="color:#BD976A;">item</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 判断当前登录状态</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#CB7676;">!</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">loginState</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$refs</span><span style="color:#666666;">.</span><span style="color:#BD976A;">login</span><span style="color:#666666;">.</span><span style="color:#80A665;">openLogin</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#4D9375;">return</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#758575DD;">// 动态点赞</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">has_like</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#CB7676;">--</span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">like_count</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">has_like</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">unlikeThisFeed</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showToast</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">取消点赞</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">icon</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">success</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">duration</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1000</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#CB7676;">++</span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">like_count</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">has_like</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">likeThisFeed</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showToast</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">点赞成功</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">icon</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">success</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">duration</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1000</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$emit</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">indexFeedLoveChange</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$emit</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">myFeedLoveChange</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">feedMixin</span><span style="color:#666666;">;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">feedMixin</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">methods</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 点赞或者取消点赞一条动态</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#AB5959;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">clickLove</span><span style="color:#999999;">(</span><span style="color:#B07D48;">item</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 判断当前登录状态</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#AB5959;">!</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">loginState</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$refs</span><span style="color:#999999;">.</span><span style="color:#B07D48;">login</span><span style="color:#999999;">.</span><span style="color:#59873A;">openLogin</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#1E754F;">return</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#A0ADA0;">// 动态点赞</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">has_like</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#AB5959;">--</span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">like_count</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">has_like</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">unlikeThisFeed</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showToast</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">取消点赞</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">icon</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">success</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">duration</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1000</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#AB5959;">++</span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">like_count</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">has_like</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">likeThisFeed</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showToast</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">点赞成功</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">icon</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">success</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">duration</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1000</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$emit</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">indexFeedLoveChange</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$emit</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">myFeedLoveChange</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">feedMixin</span><span style="color:#999999;">;</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>调用 mixins 实现点赞功能</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// index \ me 两个页面</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">feedMixin</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">@/mixins/todoFeed.js</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#80A665;">mixins</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#BD976A;">feedMixin</span><span style="color:#666666;">];</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// index \ me 两个页面</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">feedMixin</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">@/mixins/todoFeed.js</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#59873A;">mixins</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B07D48;">feedMixin</span><span style="color:#999999;">];</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>点赞完成后通信相关页面更新显示状态</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// me 页面 用户点赞一条动态后触发数据更新</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$on</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">myFeedLoveChange</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">item</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.$refs.waterfall.modify(item.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">like_count</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> item.like_count);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.$refs.waterfall.modify(item.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">has_like</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> item.has_like);</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#758575DD;">// index 用户点赞一条动态后触发数据更新</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$on</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">indexFeedLoveChange</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">item</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.$refs.waterfall.modify(item.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">like_count</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> item.like_count);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.$refs.waterfall.modify(item.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">has_like</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> item.has_like);</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// minxins 中触发通信</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$emit</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">indexFeedLoveChange</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$emit</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">myFeedLoveChange</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">);</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// me 页面 用户点赞一条动态后触发数据更新</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$on</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">myFeedLoveChange</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">item</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">    this.$refs.waterfall.modify(item.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">like_count</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> item.like_count);</span></span>
<span class="line"><span style="color:#393A34;">    this.$refs.waterfall.modify(item.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">has_like</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> item.has_like);</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#A0ADA0;">// index 用户点赞一条动态后触发数据更新</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$on</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">indexFeedLoveChange</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">item</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">    this.$refs.waterfall.modify(item.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">like_count</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> item.like_count);</span></span>
<span class="line"><span style="color:#393A34;">    this.$refs.waterfall.modify(item.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">has_like</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> item.has_like);</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// minxins 中触发通信</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$emit</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">indexFeedLoveChange</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$emit</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">myFeedLoveChange</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">);</span></span>
<span class="line"></span></code></pre></div><h3 id="_5-2-评论组件评论功能实现" tabindex="-1">5.2 评论组件评论功能实现 <a class="header-anchor" href="#_5-2-评论组件评论功能实现" aria-hidden="true">#</a></h3><p>关键技术点：</p><ol><li>登陆插件引入及登陆状态判断</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">&lt;!--</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">登陆组件</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">--&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">login</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ref</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">login</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;&lt;/</span><span style="color:#4D9375;">login</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#758575DD;">// 判断当前登录状态</span></span>
<span class="line"><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#CB7676;">!</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">loginState</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$refs</span><span style="color:#666666;">.</span><span style="color:#BD976A;">login</span><span style="color:#666666;">.</span><span style="color:#80A665;">openLogin</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#4D9375;">return</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">&lt;!--</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">登陆组件</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">--&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">login</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ref</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">login</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;&lt;/</span><span style="color:#1E754F;">login</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#A0ADA0;">// 判断当前登录状态</span></span>
<span class="line"><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#AB5959;">!</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">loginState</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$refs</span><span style="color:#999999;">.</span><span style="color:#B07D48;">login</span><span style="color:#999999;">.</span><span style="color:#59873A;">openLogin</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#1E754F;">return</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>使用 mixins 实现动态点赞功能，正常实现资讯点赞功能</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">feedMixin</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">@/mixins/todoFeed.js</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#80A665;">mixins</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#BD976A;">feedMixin</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#758575DD;">// 点赞逻辑操作</span></span>
<span class="line"><span style="color:#BD976A;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">sendLove</span><span style="color:#666666;">(){</span></span>
<span class="line"><span style="color:#666666;">				</span><span style="color:#758575DD;">// 判断当前登录状态</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#CB7676;">!</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">loginState</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$refs</span><span style="color:#666666;">.</span><span style="color:#BD976A;">login</span><span style="color:#666666;">.</span><span style="color:#80A665;">openLogin</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#4D9375;">return</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">type</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">feed</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">clickLove</span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">}</span><span style="color:#4D9375;">else</span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">					</span><span style="color:#758575DD;">// 动态点赞</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#666666;">.</span><span style="color:#BD976A;">has_like</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#CB7676;">--</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#666666;">.</span><span style="color:#BD976A;">digg_count</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#666666;">.</span><span style="color:#BD976A;">has_like</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">unlikeThisNew</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showToast</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">取消点赞</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">icon</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">success</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">duration</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1000</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#CB7676;">++</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#666666;">.</span><span style="color:#BD976A;">digg_count</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#666666;">.</span><span style="color:#BD976A;">has_like</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">likeThisNew</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showToast</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">点赞成功</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">icon</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">success</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">							</span><span style="color:#B8A965;">duration</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1000</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">feedMixin</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">@/mixins/todoFeed.js</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#59873A;">mixins</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B07D48;">feedMixin</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#A0ADA0;">// 点赞逻辑操作</span></span>
<span class="line"><span style="color:#B07D48;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">sendLove</span><span style="color:#999999;">(){</span></span>
<span class="line"><span style="color:#999999;">				</span><span style="color:#A0ADA0;">// 判断当前登录状态</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#AB5959;">!</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">loginState</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$refs</span><span style="color:#999999;">.</span><span style="color:#B07D48;">login</span><span style="color:#999999;">.</span><span style="color:#59873A;">openLogin</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#1E754F;">return</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">type</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">feed</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">clickLove</span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">}</span><span style="color:#1E754F;">else</span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">					</span><span style="color:#A0ADA0;">// 动态点赞</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#999999;">.</span><span style="color:#B07D48;">has_like</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#AB5959;">--</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#999999;">.</span><span style="color:#B07D48;">digg_count</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#999999;">.</span><span style="color:#B07D48;">has_like</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">unlikeThisNew</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showToast</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">取消点赞</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">icon</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">success</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">duration</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1000</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#AB5959;">++</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#999999;">.</span><span style="color:#B07D48;">digg_count</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#999999;">.</span><span style="color:#B07D48;">has_like</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">likeThisNew</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showToast</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">点赞成功</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">icon</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">success</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">							</span><span style="color:#998418;">duration</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1000</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>实现评论功能，注意：评论完成后修改页面数据不能直接修改 props 中的数据，通知个人中心评论数量增加</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// 发送评论信息</span></span>
<span class="line"><span style="color:#BD976A;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">sendComment</span><span style="color:#666666;">(){</span></span>
<span class="line"><span style="color:#666666;">				</span><span style="color:#758575DD;">// 发送状态判定</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#4D9375;">if</span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">disableSendCommentTag</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">return</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">disableSendCommentTag</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#4D9375;">if</span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">type</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">feed</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">){</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">commentOneFeed</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#B8A965;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#B8A965;">body</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">cinput</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#CB7676;">++</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#666666;">.</span><span style="color:#BD976A;">feed_comment_count</span></span>
<span class="line"><span style="color:#666666;">					</span><span style="color:#758575DD;">// 通知 个人中心当前动态评论增加</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$emit</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">myFeedCommentChange</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">}</span><span style="color:#4D9375;">else</span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">commentOneInfo</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#B8A965;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">						</span><span style="color:#B8A965;">body</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">cinput</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#CB7676;">++</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">oneInfoClone</span><span style="color:#666666;">.</span><span style="color:#BD976A;">comment_count</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showToast</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">评论成功</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">icon</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">success</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">					</span><span style="color:#B8A965;">duration</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1000</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">cinput</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">closeComment</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">				</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">getCommentsList</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">			</span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// 发送评论信息</span></span>
<span class="line"><span style="color:#B07D48;">async</span><span style="color:#393A34;"> </span><span style="color:#59873A;">sendComment</span><span style="color:#999999;">(){</span></span>
<span class="line"><span style="color:#999999;">				</span><span style="color:#A0ADA0;">// 发送状态判定</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#1E754F;">if</span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">disableSendCommentTag</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">return</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">disableSendCommentTag</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span></span>
<span class="line"><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#1E754F;">if</span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">type</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">feed</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">){</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">commentOneFeed</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#998418;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#998418;">body</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">cinput</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#AB5959;">++</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#999999;">.</span><span style="color:#B07D48;">feed_comment_count</span></span>
<span class="line"><span style="color:#999999;">					</span><span style="color:#A0ADA0;">// 通知 个人中心当前动态评论增加</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$emit</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">myFeedCommentChange</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">}</span><span style="color:#1E754F;">else</span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">commentOneInfo</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#998418;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">						</span><span style="color:#998418;">body</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">cinput</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#AB5959;">++</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">oneInfoClone</span><span style="color:#999999;">.</span><span style="color:#B07D48;">comment_count</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showToast</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">评论成功</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">icon</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">success</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">					</span><span style="color:#998418;">duration</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1000</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">cinput</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">closeComment</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">				</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">getCommentsList</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">			</span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="_5-3-评论敏感词-绿网-功能实现" tabindex="-1">5.3 评论敏感词 “绿网” 功能实现 <a class="header-anchor" href="#_5-3-评论敏感词-绿网-功能实现" aria-hidden="true">#</a></h3><p>关键技术点：</p><ol><li><p>封装及调用</p><p>在微信小程序文档，服务平台 - AI 能力中找到 <a href="https://developers.weixin.qq.com/miniprogram/dev/extended/service-market/intro.html#AI" target="_blank" rel="noreferrer">“珊瑚文本内容安全”</a></p><p>购买及使用当前 <a href="https://developers.weixin.qq.com/community/servicemarket/detail/00040275a14468e0e689194b251015" target="_blank" rel="noreferrer">文本内容安全服务</a></p></li><li><p>封装和调用敏感词鉴定功能</p></li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">// 在这里设计 敏感词 鉴定操作</span></span>
<span class="line"><span style="color:#dbd7caee;">doMsgSecCheck(text) {</span></span>
<span class="line"><span style="color:#dbd7caee;">			    return wx.serviceMarket.invokeService({</span></span>
<span class="line"><span style="color:#dbd7caee;">			      service: &#39;wxee446d7507c68b11&#39;,</span></span>
<span class="line"><span style="color:#dbd7caee;">			      api: &#39;msgSecCheck&#39;,</span></span>
<span class="line"><span style="color:#dbd7caee;">			      data: {</span></span>
<span class="line"><span style="color:#dbd7caee;">			        &quot;Action&quot;: &quot;TextApproval&quot;,</span></span>
<span class="line"><span style="color:#dbd7caee;">			        &quot;Text&quot;: text</span></span>
<span class="line"><span style="color:#dbd7caee;">			      },</span></span>
<span class="line"><span style="color:#dbd7caee;">			    })</span></span>
<span class="line"><span style="color:#dbd7caee;">},</span></span>
<span class="line"><span style="color:#dbd7caee;">// 敏感词信息判定</span></span>
<span class="line"><span style="color:#dbd7caee;">let cres = await this.doMsgSecCheck(this.cinput)</span></span>
<span class="line"><span style="color:#dbd7caee;">if(cres.data.Response.EvilTokens.length 0){</span></span>
<span class="line"><span style="color:#dbd7caee;">		uni.showModal({</span></span>
<span class="line"><span style="color:#dbd7caee;">				title:&#39;敏感词审核&#39;,</span></span>
<span class="line"><span style="color:#dbd7caee;">				content: &#39;评论涉及敏感词：&#39;+cres.data.Response.EvilTokens[0].EvilKeywords</span></span>
<span class="line"><span style="color:#dbd7caee;">		})</span></span>
<span class="line"><span style="color:#dbd7caee;">		return</span></span>
<span class="line"><span style="color:#dbd7caee;">}</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#393a34;">// 在这里设计 敏感词 鉴定操作</span></span>
<span class="line"><span style="color:#393a34;">doMsgSecCheck(text) {</span></span>
<span class="line"><span style="color:#393a34;">			    return wx.serviceMarket.invokeService({</span></span>
<span class="line"><span style="color:#393a34;">			      service: &#39;wxee446d7507c68b11&#39;,</span></span>
<span class="line"><span style="color:#393a34;">			      api: &#39;msgSecCheck&#39;,</span></span>
<span class="line"><span style="color:#393a34;">			      data: {</span></span>
<span class="line"><span style="color:#393a34;">			        &quot;Action&quot;: &quot;TextApproval&quot;,</span></span>
<span class="line"><span style="color:#393a34;">			        &quot;Text&quot;: text</span></span>
<span class="line"><span style="color:#393a34;">			      },</span></span>
<span class="line"><span style="color:#393a34;">			    })</span></span>
<span class="line"><span style="color:#393a34;">},</span></span>
<span class="line"><span style="color:#393a34;">// 敏感词信息判定</span></span>
<span class="line"><span style="color:#393a34;">let cres = await this.doMsgSecCheck(this.cinput)</span></span>
<span class="line"><span style="color:#393a34;">if(cres.data.Response.EvilTokens.length 0){</span></span>
<span class="line"><span style="color:#393a34;">		uni.showModal({</span></span>
<span class="line"><span style="color:#393a34;">				title:&#39;敏感词审核&#39;,</span></span>
<span class="line"><span style="color:#393a34;">				content: &#39;评论涉及敏感词：&#39;+cres.data.Response.EvilTokens[0].EvilKeywords</span></span>
<span class="line"><span style="color:#393a34;">		})</span></span>
<span class="line"><span style="color:#393a34;">		return</span></span>
<span class="line"><span style="color:#393a34;">}</span></span>
<span class="line"><span style="color:#393a34;"></span></span></code></pre></div><h3 id="_5-4-ugc-动态发布功能实现" tabindex="-1">5.4 UGC 动态发布功能实现 <a class="header-anchor" href="#_5-4-ugc-动态发布功能实现" aria-hidden="true">#</a></h3><p>关键技术点：</p><ol><li>公共组件 发布按钮 ，注意用户未登录状态下不显示这个按钮</li></ol><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">view</span><span style="color:#666666;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">goto-share</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> </span><span style="color:#BD976A;">v-if</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#BD976A;">loginState</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;">&lt;!-- 个人分享 选择器 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">image</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">share-img</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#BD976A;">src</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">@/static/carm.png</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">            @</span><span style="color:#BD976A;">tap</span><span style="color:#666666;">.</span><span style="color:#BD976A;">stop</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#80A665;">gotoShare</span><span style="color:#666666;">()</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">            </span><span style="color:#BD976A;">mode</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">aspectFit</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">        /&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">template</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">script</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">mapState</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">vuex</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">data</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{};</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">computed</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">...</span><span style="color:#80A665;">mapState</span><span style="color:#666666;">([</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">loginState</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">]),</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">methods</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">        </span><span style="color:#758575DD;">// 底部个人分享 弹窗相关操作</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#80A665;">gotoShare</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">navigateTo</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">url</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">/subpages/share/share</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">script</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">view</span><span style="color:#999999;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">goto-share</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> </span><span style="color:#B07D48;">v-if</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B07D48;">loginState</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;">&lt;!-- 个人分享 选择器 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">image</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">share-img</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#B07D48;">src</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">@/static/carm.png</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">            @</span><span style="color:#B07D48;">tap</span><span style="color:#999999;">.</span><span style="color:#B07D48;">stop</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#59873A;">gotoShare</span><span style="color:#999999;">()</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">            </span><span style="color:#B07D48;">mode</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">aspectFit</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">        /&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">template</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">script</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">mapState</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">vuex</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">data</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{};</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">computed</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">...</span><span style="color:#59873A;">mapState</span><span style="color:#999999;">([</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">loginState</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">]),</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">methods</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">        </span><span style="color:#A0ADA0;">// 底部个人分享 弹窗相关操作</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#59873A;">gotoShare</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">navigateTo</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">url</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">/subpages/share/share</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">script</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>构建 share 页面用来专门实现动态上传能力</li></ol><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">view</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">share</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;">&lt;!-- 内容输入框 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">view</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">uni-textarea</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">textarea</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">placeholder-style</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">color:#AAAAAA</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">placeholder</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">添加描述...</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">@input</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">bindTextAreaInput</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">/</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;/</span><span style="color:#FDAEB7;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;">&lt;!-- 内容发布 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">view</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">pics</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">view</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">medias</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">v-for</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">( image, index ) in uploadPicsList</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">:key</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">index</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">image</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">img</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">:src</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">image.path</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">:data-src</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">image</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">@tap</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">previewImage(index)</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">mode</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">aspectFill</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">           </span><span style="color:#666666;"> /&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-icon</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">name</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">close</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">iclose</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">color</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">#eee</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">size</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">20</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#BD976A;">@tap</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">removeImage(index)</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;/</span><span style="color:#FDAEB7;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;">&lt;!-- 选择照片按钮 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">view</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">uploadBtn</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">@tap</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">chosePicsAndUpload</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">v-if</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">uploadPicsList.length </span><span style="color:#FDAEB7;">&lt;</span><span style="color:#C98A7D;"> 9</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-icon</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">name</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">plus</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">size</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">60</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">color</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">#aaa</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">/&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">view</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">text</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">选择照片</span><span style="color:#666666;">&lt;/</span><span style="color:#FDAEB7;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;/</span><span style="color:#FDAEB7;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;/</span><span style="color:#FDAEB7;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">view</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">btns</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">u-button</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">type</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">primary</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">size</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">default</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">@click</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">sendFeed</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">:disabled</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">uploadStatus</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">发布动态</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">u-button</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;/</span><span style="color:#FDAEB7;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#FDAEB7;">view</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">view</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">share</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;">&lt;!-- 内容输入框 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">view</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">uni-textarea</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">textarea</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">placeholder-style</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">color:#AAAAAA</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">placeholder</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">添加描述...</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">@input</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">bindTextAreaInput</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">/</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;/</span><span style="color:#B31D28;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;">&lt;!-- 内容发布 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">view</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">pics</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">view</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">medias</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">v-for</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">( image, index ) in uploadPicsList</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">:key</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">index</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">image</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">img</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">:src</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">image.path</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">:data-src</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">image</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">@tap</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">previewImage(index)</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">mode</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">aspectFill</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">           </span><span style="color:#999999;"> /&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-icon</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">name</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">close</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">iclose</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">color</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">#eee</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">size</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">20</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#B07D48;">@tap</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">removeImage(index)</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;/</span><span style="color:#B31D28;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;">&lt;!-- 选择照片按钮 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">view</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">uploadBtn</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">@tap</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">chosePicsAndUpload</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">v-if</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">uploadPicsList.length </span><span style="color:#B31D28;">&lt;</span><span style="color:#B56959;"> 9</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-icon</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">name</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">plus</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">size</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">60</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">color</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">#aaa</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">/&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">view</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">text</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">选择照片</span><span style="color:#999999;">&lt;/</span><span style="color:#B31D28;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;/</span><span style="color:#B31D28;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;/</span><span style="color:#B31D28;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">view</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">btns</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">u-button</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">type</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">primary</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">size</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">default</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">@click</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">sendFeed</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">:disabled</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">uploadStatus</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">发布动态</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">u-button</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;/</span><span style="color:#B31D28;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#B31D28;">view</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>封装 uploadFile 公共工具</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">MD5</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">@/common/md5.js</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">uploadFile</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">path</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">size</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    let </span><span style="color:#BD976A;">uploadUrl</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">http://47.115.83.135/api/v2</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 第一步 获取 hash 值</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    let </span><span style="color:#BD976A;">hash</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">Promise</span><span style="color:#666666;">((</span><span style="color:#BD976A;">resolve</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">reject</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        uni.getFileInfo({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">filePath</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">path</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">success</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">result</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#80A665;">resolve</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">result.digest</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;">)</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// console.log(MD5.md5(hash))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 第二步 请求获取基础文件信息</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// let check = await uni.request({</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">//  url: uploadUrl+&#39;/files/uploaded/&#39;+MD5.md5(hash),</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">//  method: &#39;GET&#39;,</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">//  header: {</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">//    &quot;content-type&quot;: &quot;application/json&quot;,</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">//    Accept: &quot;application/json&quot;,</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">//    Authorization: &quot;Bearer &quot; + uni.getStorageSync(&quot;token&quot;),</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">//  }</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// })</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 如果返回的状态码是404，那说明没有上传过，继续后面的上传流程</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 如果返回的是200,那就从body里取出 id，这个id就可以直接使用，后面的上传流程就可以终止了</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// console.log(check[1].statusCode)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 第三步 将文件以buffer流方式存入系统</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ufile</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">uploadFile</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">url</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">uploadUrl</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">/files</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">method</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">POST</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">header</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">content-type</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">multipart/form-data</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">Authorization</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Bearer </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">getStorageSync</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">token</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">),</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">file</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">file</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">getFileSystemManager</span><span style="color:#666666;">().</span><span style="color:#80A665;">readFileSync</span><span style="color:#666666;">(</span><span style="color:#BD976A;">path</span><span style="color:#666666;">),</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">filePath</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">path</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// console.log(JSON.parse(ufile[1].data))</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">JSON</span><span style="color:#666666;">.</span><span style="color:#80A665;">parse</span><span style="color:#666666;">(</span><span style="color:#BD976A;">ufile</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">].</span><span style="color:#BD976A;">data</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">}</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">uploadFile</span><span style="color:#666666;">;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">MD5</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">@/common/md5.js</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">uploadFile</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">async</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">path</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">size</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">    let </span><span style="color:#B07D48;">uploadUrl</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">http://47.115.83.135/api/v2</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 第一步 获取 hash 值</span></span>
<span class="line"><span style="color:#393A34;">    let </span><span style="color:#B07D48;">hash</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#998418;">Promise</span><span style="color:#999999;">((</span><span style="color:#B07D48;">resolve</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">reject</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">        uni.getFileInfo({</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">filePath</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">path</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">success</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">result</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#59873A;">resolve</span><span style="color:#999999;">(</span><span style="color:#393A34;">result.digest</span><span style="color:#999999;">)</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">})</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span><span style="color:#393A34;">)</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// console.log(MD5.md5(hash))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 第二步 请求获取基础文件信息</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// let check = await uni.request({</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">//  url: uploadUrl+&#39;/files/uploaded/&#39;+MD5.md5(hash),</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">//  method: &#39;GET&#39;,</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">//  header: {</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">//    &quot;content-type&quot;: &quot;application/json&quot;,</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">//    Accept: &quot;application/json&quot;,</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">//    Authorization: &quot;Bearer &quot; + uni.getStorageSync(&quot;token&quot;),</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">//  }</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// })</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 如果返回的状态码是404，那说明没有上传过，继续后面的上传流程</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 如果返回的是200,那就从body里取出 id，这个id就可以直接使用，后面的上传流程就可以终止了</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// console.log(check[1].statusCode)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 第三步 将文件以buffer流方式存入系统</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ufile</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">uploadFile</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">url</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">uploadUrl</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">/files</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">method</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">POST</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">header</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">content-type</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">multipart/form-data</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">Authorization</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Bearer </span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">getStorageSync</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">token</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">),</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">file</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">file</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">getFileSystemManager</span><span style="color:#999999;">().</span><span style="color:#59873A;">readFileSync</span><span style="color:#999999;">(</span><span style="color:#B07D48;">path</span><span style="color:#999999;">),</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">filePath</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">path</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// console.log(JSON.parse(ufile[1].data))</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">JSON</span><span style="color:#999999;">.</span><span style="color:#59873A;">parse</span><span style="color:#999999;">(</span><span style="color:#B07D48;">ufile</span><span style="color:#999999;">[</span><span style="color:#2F798A;">1</span><span style="color:#999999;">].</span><span style="color:#B07D48;">data</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">}</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#1E754F;">export</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">default</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">uploadFile</span><span style="color:#999999;">;</span></span>
<span class="line"></span></code></pre></div><ol start="4"><li>使用 primose.all 来确保多张照片能够顺利上传</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">upStatusArr</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[];</span></span>
<span class="line"><span style="color:#758575DD;">// 循环遍历上传多图</span></span>
<span class="line"><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">uploadPicsList</span><span style="color:#666666;">.</span><span style="color:#80A665;">map</span><span style="color:#666666;">((</span><span style="color:#BD976A;">item</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    upStatusArr.push(</span><span style="color:#80A665;">uploadFile</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">item.path</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> item.size</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">);</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">images</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[];</span></span>
<span class="line"><span style="color:#666666;">(</span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">Promise</span><span style="color:#666666;">.</span><span style="color:#80A665;">all</span><span style="color:#666666;">(</span><span style="color:#BD976A;">upStatusArr</span><span style="color:#666666;">)).</span><span style="color:#80A665;">map</span><span style="color:#666666;">((</span><span style="color:#BD976A;">item</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    images.push({ </span><span style="color:#B8A965;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">item</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">})</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">pres</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#80A665;">postOneFeed</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">feed_content</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">feedInfo</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">feed_from</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">5</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">feed_mark</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">Date</span><span style="color:#666666;">().</span><span style="color:#80A665;">getTime</span><span style="color:#666666;">(),</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">images</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">upStatusArr</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[];</span></span>
<span class="line"><span style="color:#A0ADA0;">// 循环遍历上传多图</span></span>
<span class="line"><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">uploadPicsList</span><span style="color:#999999;">.</span><span style="color:#59873A;">map</span><span style="color:#999999;">((</span><span style="color:#B07D48;">item</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">    upStatusArr.push(</span><span style="color:#59873A;">uploadFile</span><span style="color:#999999;">(</span><span style="color:#393A34;">item.path</span><span style="color:#999999;">,</span><span style="color:#393A34;"> item.size</span><span style="color:#999999;">)</span><span style="color:#393A34;">);</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">images</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[];</span></span>
<span class="line"><span style="color:#999999;">(</span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#998418;">Promise</span><span style="color:#999999;">.</span><span style="color:#59873A;">all</span><span style="color:#999999;">(</span><span style="color:#B07D48;">upStatusArr</span><span style="color:#999999;">)).</span><span style="color:#59873A;">map</span><span style="color:#999999;">((</span><span style="color:#B07D48;">item</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">    images.push({ </span><span style="color:#998418;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">item</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#393A34;"> </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">})</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">pres</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#59873A;">postOneFeed</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">feed_content</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">feedInfo</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">feed_from</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">5</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">feed_mark</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">Date</span><span style="color:#999999;">().</span><span style="color:#59873A;">getTime</span><span style="color:#999999;">(),</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">images</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span></code></pre></div><ol start="5"><li>动态发布成功后通知 index me 页面更新</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// 通知个人中心 动态更新了</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$emit</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">indexFeedsUpdate</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#758575DD;">// 通知首页 动态更新了</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$emit</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">myFeedsUpdate</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#758575DD;">// index 发布新的动态后，触发数据更新</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$on</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">indexFeedsUpdate</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.</span><span style="color:#BD976A;">currentSwiperIndex</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.</span><span style="color:#BD976A;">feedsList</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.$refs.waterfall.clear();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.getFeedsList();</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// me 用户发布一条动态后触发数据更新</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">$on</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">myFeedsUpdate</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.$refs.waterfall.clear();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    this.getInfos();</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// 通知个人中心 动态更新了</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$emit</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">indexFeedsUpdate</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#A0ADA0;">// 通知首页 动态更新了</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$emit</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">myFeedsUpdate</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#A0ADA0;">// index 发布新的动态后，触发数据更新</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$on</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">indexFeedsUpdate</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">    this.</span><span style="color:#B07D48;">currentSwiperIndex</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">    this.</span><span style="color:#B07D48;">feedsList</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">    this.$refs.waterfall.clear();</span></span>
<span class="line"><span style="color:#393A34;">    this.getFeedsList();</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// me 用户发布一条动态后触发数据更新</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">$on</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">myFeedsUpdate</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">    this.$refs.waterfall.clear();</span></span>
<span class="line"><span style="color:#393A34;">    this.getInfos();</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span></code></pre></div><h2 id="六、多端打包发布" tabindex="-1">六、多端打包发布 <a class="header-anchor" href="#六、多端打包发布" aria-hidden="true">#</a></h2><h3 id="_6-1-微信小程序打包发布" tabindex="-1">6.1 微信小程序打包发布 <a class="header-anchor" href="#_6-1-微信小程序打包发布" aria-hidden="true">#</a></h3><p><img src="/assets/6.d738d89b.jpg" alt="6"></p><h3 id="_6-2-h5-端相关兼容性开发及打包发布" tabindex="-1">6.2 H5 端相关兼容性开发及打包发布 <a class="header-anchor" href="#_6-2-h5-端相关兼容性开发及打包发布" aria-hidden="true">#</a></h3><p>关键调整节点：</p><ol><li>manifest.json H5 下出现的跨域问题要进行相关配置</li></ol><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">	 </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">h5</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> : </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">devServer</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">port</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">8000</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">//端口</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">disableHostCheck</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">proxy</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#758575DD;">//使用代理</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">/api</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#758575DD;">// &quot;target&quot;: &quot;http://47.115.83.135/api/v2&quot;,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">target</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">http://ts.lagou.uieee.com/api/v2</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">changeOrigin</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">pathRewrite</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                        </span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">^/api</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#393A34;">	 </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">h5</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> : </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">devServer</span><span style="color:#998418AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">port</span><span style="color:#998418AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">8000</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">//端口</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">disableHostCheck</span><span style="color:#998418AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">proxy</span><span style="color:#998418AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A0ADA0;">//使用代理</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">/api</span><span style="color:#998418AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#A0ADA0;">// &quot;target&quot;: &quot;http://47.115.83.135/api/v2&quot;,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">target</span><span style="color:#998418AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">http://ts.lagou.uieee.com/api/v2</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">changeOrigin</span><span style="color:#998418AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">pathRewrite</span><span style="color:#998418AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                        </span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">^/api</span><span style="color:#998418AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;&quot;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>newinfo \ feedinfo 微信分享仅仅在微信下有效</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// #ifdef MP-WEIXIN</span></span>
<span class="line"><span style="color:#758575DD;">// 微信条件下分享到朋友圈、群组</span></span>
<span class="line"><span style="color:#BD976A;">wx</span><span style="color:#666666;">.</span><span style="color:#80A665;">showShareMenu</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">withShareTicket</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">menus</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">shareAppMessage</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">shareTimeline</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">],</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#758575DD;">// #endif</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// #ifdef MP-WEIXIN</span></span>
<span class="line"><span style="color:#A0ADA0;">// 微信条件下分享到朋友圈、群组</span></span>
<span class="line"><span style="color:#B07D48;">wx</span><span style="color:#999999;">.</span><span style="color:#59873A;">showShareMenu</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">withShareTicket</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">menus</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">shareAppMessage</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">shareTimeline</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">],</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#A0ADA0;">// #endif</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>comment 组件分享按钮仅仅在 微信小程序下展示，同步 css 调整</li></ol><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">&lt;!-- 转发次数统计 --&gt;</span></span>
<span class="line"><span style="color:#758575DD;">&lt;!-- #ifdef MP-WEIXIN --&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">button</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">mbtn mhare</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">open-type</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">share</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">image</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">micon</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">src</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">/static/wx.png</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">mode</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">aspectFit</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;"> /&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">&lt;</span><span style="color:#FDAEB7;">text</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">mtext</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">分享</span><span style="color:#666666;">&lt;/</span><span style="color:#FDAEB7;">text</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">button</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#758575DD;">&lt;!-- #endif --&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">&lt;!-- 转发次数统计 --&gt;</span></span>
<span class="line"><span style="color:#A0ADA0;">&lt;!-- #ifdef MP-WEIXIN --&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">button</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">mbtn mhare</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">open-type</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">share</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">image</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">micon</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">src</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">/static/wx.png</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">mode</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">aspectFit</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;"> /&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">&lt;</span><span style="color:#B31D28;">text</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">mtext</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">分享</span><span style="color:#999999;">&lt;/</span><span style="color:#B31D28;">text</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">button</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#A0ADA0;">&lt;!-- #endif --&gt;</span></span>
<span class="line"></span></code></pre></div><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#666666;">.</span><span style="color:#BD976A;">minput</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">background-color</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">#</span><span style="color:#C99076;">eee</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">height</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">60</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    // #</span><span style="color:#B8A965;">ifdef</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">MP-WEIXIN</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">width</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">300</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    // #</span><span style="color:#B8A965;">endif</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    // #</span><span style="color:#B8A965;">ifndef</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">MP-WEIXIN</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">width</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">440</span><span style="color:#DBD7CAEE;">upx</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    // #</span><span style="color:#B8A965;">endif</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#999999;">.</span><span style="color:#B07D48;">minput</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">background-color</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">#</span><span style="color:#A65E2B;">eee</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">height</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">60</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    // #</span><span style="color:#998418;">ifdef</span><span style="color:#393A34;"> </span><span style="color:#998418;">MP-WEIXIN</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">width</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">300</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    // #</span><span style="color:#998418;">endif</span></span>
<span class="line"><span style="color:#393A34;">    // #</span><span style="color:#998418;">ifndef</span><span style="color:#393A34;"> </span><span style="color:#998418;">MP-WEIXIN</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">width</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">440</span><span style="color:#393A34;">upx</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    // #</span><span style="color:#998418;">endif</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><ol start="4"><li>comment 微信敏感词接口调用仅在微信下有效</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// #ifdef MP-WEIXIN</span></span>
<span class="line"><span style="color:#758575DD;">// 敏感词信息判定</span></span>
<span class="line"><span style="color:#CB7676;">let</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">cres</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#80A665;">doMsgSecCheck</span><span style="color:#666666;">(</span><span style="color:#C99076;">this</span><span style="color:#666666;">.</span><span style="color:#BD976A;">cinput</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">cres</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">Response</span><span style="color:#666666;">.</span><span style="color:#BD976A;">EvilTokens</span><span style="color:#666666;">.</span><span style="color:#B8A965;">length</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">showModal</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">敏感词审核</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">content</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">您发布的评论涉及敏感词：</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">cres</span><span style="color:#666666;">.</span><span style="color:#BD976A;">data</span><span style="color:#666666;">.</span><span style="color:#BD976A;">Response</span><span style="color:#666666;">.</span><span style="color:#BD976A;">EvilTokens</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">].</span><span style="color:#BD976A;">EvilKeywords</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#758575DD;">// #endif</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// #ifdef MP-WEIXIN</span></span>
<span class="line"><span style="color:#A0ADA0;">// 敏感词信息判定</span></span>
<span class="line"><span style="color:#AB5959;">let</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">cres</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#59873A;">doMsgSecCheck</span><span style="color:#999999;">(</span><span style="color:#A65E2B;">this</span><span style="color:#999999;">.</span><span style="color:#B07D48;">cinput</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">cres</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">Response</span><span style="color:#999999;">.</span><span style="color:#B07D48;">EvilTokens</span><span style="color:#999999;">.</span><span style="color:#998418;">length</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">showModal</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">敏感词审核</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">content</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">您发布的评论涉及敏感词：</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">cres</span><span style="color:#999999;">.</span><span style="color:#B07D48;">data</span><span style="color:#999999;">.</span><span style="color:#B07D48;">Response</span><span style="color:#999999;">.</span><span style="color:#B07D48;">EvilTokens</span><span style="color:#999999;">[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">].</span><span style="color:#B07D48;">EvilKeywords</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#A0ADA0;">// #endif</span></span>
<span class="line"></span></code></pre></div><ol start="5"><li>login 登陆组件获取用户信息逻辑调整</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// #ifdef MP-WEIXIN</span></span>
<span class="line"><span style="color:#BD976A;">wx</span><span style="color:#666666;">.</span><span style="color:#80A665;">getSetting</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">success</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">res</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#80A665;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">res.authSetting</span><span style="color:#666666;">[</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">scope.userInfo</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">])</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">getUserInfo</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">success</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">res</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#666666;">                    </span><span style="color:#758575DD;">// 如果用户授权了，则做两件事，第一件事</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    this.form.</span><span style="color:#BD976A;">login</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">nickName</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    this.form.</span><span style="color:#BD976A;">name</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">nickName</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    this.form.</span><span style="color:#BD976A;">avatar</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#BD976A;">userInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">avatarUrl</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    this.</span><span style="color:#BD976A;">getUserInfoTag</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">false</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">fail</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    console.log(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">用户未授权！</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#B8A965;">);</span></span>
<span class="line"><span style="color:#B8A965;">                },</span></span>
<span class="line"><span style="color:#B8A965;">            });</span></span>
<span class="line"><span style="color:#B8A965;">        }</span></span>
<span class="line"><span style="color:#B8A965;">    },</span></span>
<span class="line"><span style="color:#B8A965;">});</span></span>
<span class="line"><span style="color:#758575DD;">// #endif</span></span>
<span class="line"><span style="color:#758575DD;">// #ifndef MP-WEIXIN</span></span>
<span class="line"><span style="color:#B8A965;">this.getUserInfoTag = false;</span></span>
<span class="line"><span style="color:#758575DD;">// #endif</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// #ifdef MP-WEIXIN</span></span>
<span class="line"><span style="color:#B07D48;">wx</span><span style="color:#999999;">.</span><span style="color:#59873A;">getSetting</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">success</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">res</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#59873A;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#393A34;">res.authSetting</span><span style="color:#999999;">[</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">scope.userInfo</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">])</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">getUserInfo</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">success</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">res</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#999999;">                    </span><span style="color:#A0ADA0;">// 如果用户授权了，则做两件事，第一件事</span></span>
<span class="line"><span style="color:#393A34;">                    this.form.</span><span style="color:#B07D48;">login</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">nickName</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">                    this.form.</span><span style="color:#B07D48;">name</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">nickName</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">                    this.form.</span><span style="color:#B07D48;">avatar</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#B07D48;">userInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">avatarUrl</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">                    this.</span><span style="color:#B07D48;">getUserInfoTag</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">false</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">fail</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">                    console.log(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">用户未授权！</span><span style="color:#B56959AA;">&#39;</span><span style="color:#998418;">);</span></span>
<span class="line"><span style="color:#998418;">                },</span></span>
<span class="line"><span style="color:#998418;">            });</span></span>
<span class="line"><span style="color:#998418;">        }</span></span>
<span class="line"><span style="color:#998418;">    },</span></span>
<span class="line"><span style="color:#998418;">});</span></span>
<span class="line"><span style="color:#A0ADA0;">// #endif</span></span>
<span class="line"><span style="color:#A0ADA0;">// #ifndef MP-WEIXIN</span></span>
<span class="line"><span style="color:#998418;">this.getUserInfoTag = false;</span></span>
<span class="line"><span style="color:#A0ADA0;">// #endif</span></span>
<span class="line"></span></code></pre></div><ol start="6"><li>http.api.js API 管理器 文件上传逻辑调整</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// 文件上传操作</span></span>
<span class="line"><span style="color:#BD976A;">api</span><span style="color:#666666;">.</span><span style="color:#BD976A;">uploadFile</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">file</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">={</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    let </span><span style="color:#BD976A;">rfile</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">file</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// #ifdef MP-WEIXIN</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">rfile</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">getFileSystemManager</span><span style="color:#666666;">().</span><span style="color:#80A665;">readFileSync</span><span style="color:#666666;">(</span><span style="color:#BD976A;">file</span><span style="color:#666666;">.</span><span style="color:#BD976A;">path</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// #endif</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// 将文件写入后台系统系统</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    let </span><span style="color:#BD976A;">ufile</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">uploadFile</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">url</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">vm</span><span style="color:#666666;">.</span><span style="color:#BD976A;">$u</span><span style="color:#666666;">.</span><span style="color:#BD976A;">http</span><span style="color:#666666;">.</span><span style="color:#BD976A;">config</span><span style="color:#666666;">.</span><span style="color:#BD976A;">baseUrl</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">/files</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">header</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">Authorization</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Bearer </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">getStorageSync</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">token</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">),</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">file</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">file</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">rfile</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">filePath</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">file</span><span style="color:#666666;">.</span><span style="color:#BD976A;">path</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    console.log(JSON.parse(ufile</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">]</span><span style="color:#B8A965;">.data));</span></span>
<span class="line"><span style="color:#B8A965;">    return JSON.parse(ufile</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">]</span><span style="color:#B8A965;">.data);</span></span>
<span class="line"><span style="color:#B8A965;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// 文件上传操作</span></span>
<span class="line"><span style="color:#B07D48;">api</span><span style="color:#999999;">.</span><span style="color:#B07D48;">uploadFile</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">async</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">file</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">={</span></span>
<span class="line"><span style="color:#393A34;">    let </span><span style="color:#B07D48;">rfile</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">file</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// #ifdef MP-WEIXIN</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">rfile</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">getFileSystemManager</span><span style="color:#999999;">().</span><span style="color:#59873A;">readFileSync</span><span style="color:#999999;">(</span><span style="color:#B07D48;">file</span><span style="color:#999999;">.</span><span style="color:#B07D48;">path</span><span style="color:#999999;">)</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// #endif</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// 将文件写入后台系统系统</span></span>
<span class="line"><span style="color:#393A34;">    let </span><span style="color:#B07D48;">ufile</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">uploadFile</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">url</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">vm</span><span style="color:#999999;">.</span><span style="color:#B07D48;">$u</span><span style="color:#999999;">.</span><span style="color:#B07D48;">http</span><span style="color:#999999;">.</span><span style="color:#B07D48;">config</span><span style="color:#999999;">.</span><span style="color:#B07D48;">baseUrl</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">/files</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">header</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">Authorization</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Bearer </span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">getStorageSync</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">token</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">),</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">file</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">file</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">rfile</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">filePath</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">file</span><span style="color:#999999;">.</span><span style="color:#B07D48;">path</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">})</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">    console.log(JSON.parse(ufile</span><span style="color:#999999;">[</span><span style="color:#2F798A;">1</span><span style="color:#999999;">]</span><span style="color:#998418;">.data));</span></span>
<span class="line"><span style="color:#998418;">    return JSON.parse(ufile</span><span style="color:#999999;">[</span><span style="color:#2F798A;">1</span><span style="color:#999999;">]</span><span style="color:#998418;">.data);</span></span>
<span class="line"><span style="color:#998418;">};</span></span>
<span class="line"></span></code></pre></div><p>PS: 可以使用托管工具，快速发布体验，尤其需要注意的是：开发的时候配置的代理服务器，在正式环境打包的时候是不会被调用的，所以要更改对应的配置信息</p><p><img src="/assets/7.dcd64d0f.jpg" alt="8"></p><h3 id="_6-3-安卓云端体验版本打包发布" tabindex="-1">6.3 安卓云端体验版本打包发布 <a class="header-anchor" href="#_6-3-安卓云端体验版本打包发布" aria-hidden="true">#</a></h3><p><img src="/assets/7.dcd64d0f.jpg" alt="7"></p></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-97ada51d data-v-fec45cf1><!----><div class="prev-next" data-v-fec45cf1><div class="pager" data-v-fec45cf1><a class="pager-link prev" href="/PanClient/UniApp/" data-v-fec45cf1><span class="desc" data-v-fec45cf1>Previous page</span><span class="title" data-v-fec45cf1>uniapp 基础</span></a></div><div class="has-prev pager" data-v-fec45cf1><a class="pager-link next" href="/PanClient/RN/" data-v-fec45cf1><span class="desc" data-v-fec45cf1>Next page</span><span class="title" data-v-fec45cf1>React Native介绍</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-04c1d245 data-v-e01008a6><div class="container" data-v-e01008a6><p class="message" data-v-e01008a6>Released under the MIT License.</p><p class="copyright" data-v-e01008a6>Copyright © 2022-present Attraction11</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"framework_gatsby_index.md\":\"dd2dd1f8\",\"framework_module_index.md\":\"d8dd72db\",\"framework_next_nextjs.md\":\"a34511c6\",\"framework_next_serverender.md\":\"f525e3e0\",\"framework_nuxt_myssr.md\":\"5d6e21c0\",\"framework_nuxt_nuxtbase.md\":\"d913dc94\",\"framework_nuxt_serverender.md\":\"8a415692\",\"framework_nuxt_staticsite.md\":\"51b0bdd8\",\"framework_nuxt_index.md\":\"1d6cff4d\",\"framework_react_cssinjs.md\":\"f282c046\",\"framework_react_chakraui.md\":\"cd4e17b0\",\"framework_react_mobx6.md\":\"e262bb4f\",\"framework_react_qa1.md\":\"c5dd36e2\",\"framework_react_qa2.md\":\"93a63ec6\",\"framework_react_react.md\":\"eef60ddc\",\"framework_react_react16code.md\":\"019dfed4\",\"framework_react_reactbase.md\":\"cf73e575\",\"framework_react_reactdiff.md\":\"e4f66230\",\"framework_react_reactfilber.md\":\"5fa9ab91\",\"framework_react_reacthooks.md\":\"81cd67ae\",\"framework_react_reacthooks优缺点.md\":\"c08809d6\",\"framework_react_reacthooks功能.md\":\"8ba2c66c\",\"framework_react_reactoptimize.md\":\"62645ff3\",\"framework_react_reactredux.md\":\"657fe00e\",\"framework_react_reactrouter.md\":\"21bc2e38\",\"framework_react_redux.md\":\"f07c4461\",\"framework_react_reduxcode.md\":\"93b3b21c\",\"framework_react_reduxormobx.md\":\"a7c04ee2\",\"framework_react_usestatenote.md\":\"fc3376ba\",\"framework_vue_component.md\":\"9bbbb2ec\",\"framework_vue_qa1.md\":\"5a4c800a\",\"framework_vue_qa2.md\":\"62bd104e\",\"framework_vue_virtualdom.md\":\"28b162e9\",\"framework_vue_vue2.md\":\"f768ddc6\",\"framework_vue_vue3.md\":\"68b60fc1\",\"framework_vue_vue3code.md\":\"f24eaa2d\",\"framework_vue_vue3tsx.md\":\"9ede0df6\",\"framework_vue_vuerouter.md\":\"efbfbce7\",\"framework_vue_vuex.md\":\"4ffc62d0\",\"fullstack_database_mongodb.md\":\"31ca5d94\",\"fullstack_database_redis.md\":\"712085fc\",\"fullstack_graphql_index.md\":\"3e57dacb\",\"fullstack_nginx_index.md\":\"76768cc6\",\"fullstack_node_nodeapp.md\":\"9a924078\",\"fullstack_node_nodebase.md\":\"8ada7485\",\"fullstack_node_nodecore.md\":\"eec2d5f2\",\"fullstack_node_nodemessage.md\":\"dfde0460\",\"fullstack_webdev_egg.md\":\"7099f678\",\"fullstack_webdev_express.md\":\"03236d2b\",\"fullstack_webdev_koa.md\":\"9989ed2d\",\"fullstack_webdev_nest.md\":\"f2d8e01e\",\"javascript_asynchronous_heap_stack.md\":\"1b365203\",\"javascript_asynchronous_index.md\":\"9c686588\",\"javascript_asynchronous_jsconcepts.md\":\"d59f5b36\",\"javascript_asynchronous_objectoriented.md\":\"891d0469\",\"javascript_asynchronous_promise.md\":\"c1e6ee0c\",\"javascript_asynchronous_promisecode.md\":\"02489ba6\",\"javascript_asynchronous_this.md\":\"e3be21f0\",\"javascript_esfeatures_index.md\":\"a6fbd072\",\"javascript_engineering_automate.md\":\"136a8e5e\",\"javascript_engineering_codestandard.md\":\"42eed537\",\"javascript_engineering_modular.md\":\"a12a7257\",\"javascript_engineering_webpack.md\":\"3c811481\",\"javascript_engineering_index.md\":\"c13ea585\",\"javascript_functional_closure.md\":\"9d2558e4\",\"javascript_functional_combination.md\":\"e84b066e\",\"javascript_functional_currying.md\":\"e2ca6d70\",\"javascript_functional_index.md\":\"9ae48984\",\"javascript_functional_purefunction.md\":\"da93d93f\",\"javascript_html_css_flex.md\":\"1dcf8482\",\"javascript_html_css_grid.md\":\"2ee81c92\",\"javascript_html_css_layout.md\":\"19b5c2db\",\"javascript_html_css_randomrecord.md\":\"b0888912\",\"javascript_html_css_skill.md\":\"6171ec6c\",\"javascript_html_css_index.md\":\"3406404e\",\"javascript_jscore_index.md\":\"5e42ee7a\",\"javascript_module_three.md\":\"6ca08ed3\",\"javascript_module_two.md\":\"9ec7ad57\",\"javascript_module_index.md\":\"1243b06d\",\"javascript_performance_check.md\":\"67c398ea\",\"javascript_performance_execute.md\":\"631d37bd\",\"javascript_performance_optimize.md\":\"bc8d2f40\",\"javascript_performance_overall.md\":\"24c41a8a\",\"javascript_performance_index.md\":\"8834d325\",\"javascript_typescript_tooltype.md\":\"89a94e8d\",\"javascript_typescript_index.md\":\"54dfc5c1\",\"javascript_websafety_transfer.md\":\"cb7d8b95\",\"javascript_websafety_index.md\":\"5d26dee3\",\"panclient_electron_webcli.md\":\"f6351fa3\",\"panclient_flutter_webcli.md\":\"e021fbcd\",\"panclient_rn_architecture.md\":\"844d6947\",\"panclient_rn_component.md\":\"f9874af8\",\"panclient_rn_projectdemo.md\":\"990242a9\",\"panclient_rn_randomrecord.md\":\"ec1a8a5c\",\"panclient_rn_router_nav.md\":\"44223c3c\",\"panclient_rn_setup.md\":\"f9a9c1e6\",\"panclient_rn_stylesheet.md\":\"2b03ac61\",\"panclient_rn_index.md\":\"bcf53f69\",\"panclient_uniapp_projectdemo.md\":\"bbdf369d\",\"panclient_uniapp_index.md\":\"eefb6d3a\",\"programtopics_datavisualization_webcli.md\":\"a9f1b957\",\"programtopics_microfrontend_webcli.md\":\"2e662ad9\",\"programtopics_serverless_webcli.md\":\"d862d2bf\",\"programtopics_testautomation_webcli.md\":\"e9c35a36\",\"readme.md\":\"0c7cca72\",\"sites.md\":\"9f1eb1eb\",\"index.md\":\"ba6bb30a\",\"notes_git常用操作.md\":\"99961238\",\"notes_linux基本命令.md\":\"ed7fcdbf\",\"notes_nginx基本使用.md\":\"694d3d62\",\"notes_regexp介绍与使用.md\":\"4d3f01a6\",\"notes_vscode插件开发.md\":\"e5f32b22\",\"notes_力扣题记录.md\":\"bd469482\",\"notes_小程序开发记录.md\":\"d49168a5\",\"notes_常用快捷键.md\":\"4054c968\",\"notes_排序算法.md\":\"6103fce3\",\"notes_收录精选书籍.md\":\"427a6948\",\"notes_网络相关知识.md\":\"629222b3\",\"notes_面试经验总结.md\":\"d7508c64\",\"notes_面试自检手册.md\":\"15415afa\",\"面试软技能.md\":\"b102c403\"}")</script>
    <script type="module" async src="/assets/app.417e51bc.js"></script>
    
  </body>
</html>