<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Apollo GraphQL | Attraction11</title>
    <meta name="description" content="个人博客">
    <link rel="stylesheet" href="/assets/style.95d26555.css">
    <link rel="modulepreload" href="/assets/app.8a7326df.js">
    <link rel="modulepreload" href="/assets/FullStack_GraphQL_Apollo.md.fdb2018b.lean.js">
    
    <link rel="icon" href="/docs-logo.png">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-04c1d245><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c9cfc3c4></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c9cfc3c4> Skip to content </a><!--]--><!----><header class="VPNav" data-v-04c1d245 data-v-ea4052b4><div class="VPNavBar has-sidebar" data-v-ea4052b4 data-v-36046f86><div class="container" data-v-36046f86><div class="VPNavBarTitle has-sidebar" data-v-36046f86 data-v-2ca9a22c><a class="title" href="/" data-v-2ca9a22c><!--[--><!--]--><!--[--><img class="VPImage logo" src="/docs-logo.png" alt data-v-265535e3><!--]--><!--[-->Attraction11<!--]--><!--[--><!--]--></a></div><div class="content" data-v-36046f86><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-36046f86 data-v-2129ae7b><span id="main-nav-aria-label" class="visually-hidden" data-v-2129ae7b>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-2129ae7b data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e95fa1e4><span class="text" data-v-e95fa1e4><!----> 前端基础 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-e95fa1e4><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><div class="items" data-v-d7943406><!--[--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/HTMLCSS/Index.html" data-v-5a68840c data-v-7a3e2c60><!--[-->HTML与CSS<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/Functional/" data-v-5a68840c data-v-7a3e2c60><!--[-->函数式编程<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/JSCore/" data-v-5a68840c data-v-7a3e2c60><!--[-->JS核心原理<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/Asynchronous/" data-v-5a68840c data-v-7a3e2c60><!--[-->JS异步编程<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/ESFeatures/" data-v-5a68840c data-v-7a3e2c60><!--[-->ES新特性<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/TypeScript/" data-v-5a68840c data-v-7a3e2c60><!--[-->TS语言<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/Performance/" data-v-5a68840c data-v-7a3e2c60><!--[-->性能优化<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/LeetCode/" data-v-5a68840c data-v-7a3e2c60><!--[-->数据结构与算法<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/WebSafety/" data-v-5a68840c data-v-7a3e2c60><!--[-->网络与安全<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/Engineering/" data-v-5a68840c data-v-7a3e2c60><!--[-->项目工程化<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/JavaScript/Module/" data-v-5a68840c data-v-7a3e2c60><!--[-->杂记<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-2129ae7b data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e95fa1e4><span class="text" data-v-e95fa1e4><!----> 前端框架 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-e95fa1e4><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><div class="items" data-v-d7943406><!--[--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/Framework/Vue/Introduce.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Vue<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/Framework/React/React.html" data-v-5a68840c data-v-7a3e2c60><!--[-->React<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/Framework/Render/ServeRender.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Render<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/Framework/StaticSite/Gatsby.html" data-v-5a68840c data-v-7a3e2c60><!--[-->StaticSite<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-2129ae7b data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e95fa1e4><span class="text" data-v-e95fa1e4><!----> 全栈开发 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-e95fa1e4><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><div class="items" data-v-d7943406><!--[--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/FullStack/Node/Introduce.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Node.js 编程<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/FullStack/Nest/Introduce.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Nest.js 应用<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/FullStack/Redis/Introduce.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Redis 应用<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/FullStack/MongoDB/Introduce.html" data-v-5a68840c data-v-7a3e2c60><!--[-->MongoDB 应用<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/FullStack/GraphQL/" data-v-5a68840c data-v-7a3e2c60><!--[-->GraphQL API 开发<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/FullStack/Nginx/" data-v-5a68840c data-v-7a3e2c60><!--[-->Nginx 配置<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-2129ae7b data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e95fa1e4><span class="text" data-v-e95fa1e4><!----> 泛客户端开发 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-e95fa1e4><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><div class="items" data-v-d7943406><!--[--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/PanClient/UniApp/" data-v-5a68840c data-v-7a3e2c60><!--[-->UniApp<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/PanClient/RN/" data-v-5a68840c data-v-7a3e2c60><!--[-->React Native<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/PanClient/Electron/" data-v-5a68840c data-v-7a3e2c60><!--[-->Electron<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/PanClient/AIGC/" data-v-5a68840c data-v-7a3e2c60><!--[-->AIGC<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-2129ae7b data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e95fa1e4><span class="text" data-v-e95fa1e4><!----> 技术方案 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-e95fa1e4><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><div class="items" data-v-d7943406><!--[--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/ProgramTopics/MicroFrontend/WebCli.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Micro Frontend<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/ProgramTopics/TestAutomation/WebCli.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Test Automation<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/ProgramTopics/DataVisualization/WebCli.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Data Visualization<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/ProgramTopics/Serverless/WebCli.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Serverless<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/ProgramTopics/BusinessScene/Login.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Business Scene<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/ProgramTopics/InterviewBible/" data-v-5a68840c data-v-7a3e2c60><!--[-->Interview Bible<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-2129ae7b data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e95fa1e4><span class="text" data-v-e95fa1e4><!----> 随机文章 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-e95fa1e4><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><div class="items" data-v-d7943406><!--[--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/Git%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Git常用操作.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/Linux%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Linux基本命令.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/Nginx%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8.html" data-v-5a68840c data-v-7a3e2c60><!--[-->Nginx基本使用.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/RegExp%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8.html" data-v-5a68840c data-v-7a3e2c60><!--[-->RegExp介绍与使用.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/VsCode%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91.html" data-v-5a68840c data-v-7a3e2c60><!--[-->VsCode插件开发.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E5%8A%9B%E6%89%A3%E9%A2%98%E8%AE%B0%E5%BD%95.html" data-v-5a68840c data-v-7a3e2c60><!--[-->力扣题记录.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95.html" data-v-5a68840c data-v-7a3e2c60><!--[-->小程序开发记录.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE.html" data-v-5a68840c data-v-7a3e2c60><!--[-->常用快捷键.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95.html" data-v-5a68840c data-v-7a3e2c60><!--[-->排序算法.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E6%94%B6%E5%BD%95%E7%B2%BE%E9%80%89%E4%B9%A6%E7%B1%8D.html" data-v-5a68840c data-v-7a3e2c60><!--[-->收录精选书籍.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html" data-v-5a68840c data-v-7a3e2c60><!--[-->最佳实践.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E7%BD%91%E7%BB%9C%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86.html" data-v-5a68840c data-v-7a3e2c60><!--[-->网络相关知识.md<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d7943406 data-v-5a68840c><a class="VPLink link" href="/notes/%E9%9D%A2%E8%AF%95%E8%BD%AF%E6%8A%80%E8%83%BD.html" data-v-5a68840c data-v-7a3e2c60><!--[-->面试软技能.md<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-36046f86 data-v-01996bc4><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-01996bc4 data-v-aa122b2e data-v-4456f1e0><span class="check" data-v-4456f1e0><span class="icon" data-v-4456f1e0><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-aa122b2e><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-aa122b2e><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-36046f86 data-v-6fcdd6cc data-v-673831b0><!--[--><a class="VPSocialLink" href="https://github.com/attraction11" target="_blank" rel="noopener" data-v-673831b0 data-v-87c79f46><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-36046f86 data-v-4a619ef7 data-v-e95fa1e4><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-e95fa1e4><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-e95fa1e4><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-e95fa1e4><div class="VPMenu" data-v-e95fa1e4 data-v-d7943406><!----><!--[--><!--[--><!----><div class="group" data-v-4a619ef7><div class="item appearance" data-v-4a619ef7><p class="label" data-v-4a619ef7>Appearance</p><div class="appearance-action" data-v-4a619ef7><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-4a619ef7 data-v-aa122b2e data-v-4456f1e0><span class="check" data-v-4456f1e0><span class="icon" data-v-4456f1e0><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-aa122b2e><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-aa122b2e><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-4a619ef7><div class="item social-links" data-v-4a619ef7><div class="VPSocialLinks social-links-list" data-v-4a619ef7 data-v-673831b0><!--[--><a class="VPSocialLink" href="https://github.com/attraction11" target="_blank" rel="noopener" data-v-673831b0 data-v-87c79f46><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-36046f86 data-v-e7032f7c><span class="container" data-v-e7032f7c><span class="top" data-v-e7032f7c></span><span class="middle" data-v-e7032f7c></span><span class="bottom" data-v-e7032f7c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-04c1d245 data-v-afebc1bf><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-afebc1bf><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-afebc1bf><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-afebc1bf>Menu</span></button><a class="top-link" href="#" data-v-afebc1bf> Return to top </a></div><aside class="VPSidebar" data-v-04c1d245 data-v-18c1c2a0><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18c1c2a0><span class="visually-hidden" id="sidebar-aria-label" data-v-18c1c2a0> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-18c1c2a0><section class="VPSidebarGroup collapsible" data-v-18c1c2a0 data-v-174c8078><div class="title" role="button" data-v-174c8078><h2 class="title-text" data-v-174c8078>Node.js 编程</h2><div class="action" data-v-174c8078><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-174c8078><!--[--><!--[--><a class="VPLink link link" href="/FullStack/Node/Introduce.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Node.js介绍</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Node/NodeBase.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Node.js基础</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Node/Module.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>模块系统</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Node/FileOpt.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>文件操作</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Node/KeepSession.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>会话保持</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Node/NodeCore.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>核心模块</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Node/NodeMessage.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>网络通信</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Node/NodeDev.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>应用开发</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Node/ExpressDev.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Express 开发</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Node/KoaDev.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Koa 开发</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Node/EggDev.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Egg 开发</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Node/Comparison.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Node.js框架对比</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Node/NodeQA.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>QA问答</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-18c1c2a0><section class="VPSidebarGroup collapsible" data-v-18c1c2a0 data-v-174c8078><div class="title" role="button" data-v-174c8078><h2 class="title-text" data-v-174c8078>Nest.js 应用</h2><div class="action" data-v-174c8078><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-174c8078><!--[--><!--[--><a class="VPLink link link" href="/FullStack/Nest/Introduce.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Nest.js 简介</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Nest/NestLesson.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Nest.js 基本实践</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Nest/NestDev.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Nest.js 开发</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-18c1c2a0><section class="VPSidebarGroup collapsible" data-v-18c1c2a0 data-v-174c8078><div class="title" role="button" data-v-174c8078><h2 class="title-text" data-v-174c8078>Redis 应用</h2><div class="action" data-v-174c8078><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-174c8078><!--[--><!--[--><a class="VPLink link link" href="/FullStack/Redis/Introduce.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Redis 简介</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Redis/SetUp.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Redis 安装</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Redis/Config.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Redis 配置</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Redis/MoreDB.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Redis 多数据库</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Redis/CRUD.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Redis 操作命令</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Redis/Expire.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Redis 过期时间</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Redis/Multi.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Redis 事务</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Redis/Persistence.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Redis 持久化</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Redis/SoftAdmin.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Redis 图形管理软件</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Redis/Client.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>客户端操作 Redis</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Redis/Cluster.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Redis 集群</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/Redis/Connect.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Redis 设置远程连接</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-18c1c2a0><section class="VPSidebarGroup collapsible" data-v-18c1c2a0 data-v-174c8078><div class="title" role="button" data-v-174c8078><h2 class="title-text" data-v-174c8078>MongoDB 应用</h2><div class="action" data-v-174c8078><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-174c8078><!--[--><!--[--><a class="VPLink link link" href="/FullStack/MongoDB/Introduce.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>MongoDB 介绍</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-18c1c2a0><section class="VPSidebarGroup collapsible" data-v-18c1c2a0 data-v-174c8078><div class="title" role="button" data-v-174c8078><h2 class="title-text" data-v-174c8078>GraphQL API 开发</h2><div class="action" data-v-174c8078><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-174c8078><!--[--><!--[--><a class="VPLink link link" href="/FullStack/GraphQL/" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>GraphQL 简介</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/GraphQL/First.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>GraphQL 入门</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/GraphQL/Type.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>GraphQL 模式和类型</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link active" href="/FullStack/GraphQL/Apollo.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Apollo GraphQL</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/FullStack/GraphQL/QA.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>QA 问答</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-18c1c2a0><section class="VPSidebarGroup collapsible" data-v-18c1c2a0 data-v-174c8078><div class="title" role="button" data-v-174c8078><h2 class="title-text" data-v-174c8078>Nginx 配置</h2><div class="action" data-v-174c8078><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-174c8078><!--[--><!--[--><a class="VPLink link link" href="/FullStack/Nginx/" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Nginx 问题解决</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-18c1c2a0><section class="VPSidebarGroup collapsible" data-v-18c1c2a0 data-v-174c8078><div class="title" role="button" data-v-174c8078><h2 class="title-text" data-v-174c8078>Docker 使用</h2><div class="action" data-v-174c8078><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-174c8078><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-174c8078><!--[--><!--[--><a class="VPLink link link" href="/FullStack/Docker/Introduce.html" style="padding-left:0px;" data-v-aef2ae43 data-v-7a3e2c60><!--[--><span class="link-text" data-v-aef2ae43>Docker 介绍</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-04c1d245 data-v-29a3e9f4><div class="VPDoc has-sidebar has-aside" data-v-29a3e9f4 data-v-97ada51d><div class="container" data-v-97ada51d><div class="aside" data-v-97ada51d><div class="aside-curtain" data-v-97ada51d></div><div class="aside-container" data-v-97ada51d><div class="aside-content" data-v-97ada51d><div class="VPDocAside" data-v-97ada51d data-v-2f38cef5><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-2f38cef5 data-v-6bc23c6e><div class="content" data-v-6bc23c6e><div class="outline-marker" data-v-6bc23c6e></div><div class="outline-title" data-v-6bc23c6e>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-6bc23c6e><span class="visually-hidden" id="doc-outline-aria-label" data-v-6bc23c6e> Table of Contents for current page </span><ul class="root" data-v-6bc23c6e data-v-7ea186a3><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-2f38cef5></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-97ada51d><div class="content-container" data-v-97ada51d><!--[--><!--]--><main class="main" data-v-97ada51d><div style="position:relative;" class="vp-doc _FullStack_GraphQL_Apollo" data-v-97ada51d><div><h1 id="apollo-graphql" tabindex="-1">Apollo GraphQL <a class="header-anchor" href="#apollo-graphql" aria-hidden="true">#</a></h1><p>Apollo 是一个开源的 GraphQL 开发平台， 提供了符合 GraphQL 规范的服务端和客户端实现。使用 Apollo 可以帮助我们更方便快捷的开发使用 GraphQL。</p><p><img src="/assets/9.4708101c.png" alt="img"></p><ul><li>官网：<a href="https://www.apollographql.com/" target="_blank" rel="noreferrer">https://www.apollographql.com/</a></li><li>GitHub 相关开源仓库：<a href="https://github.com/apollographql" target="_blank" rel="noreferrer">https://github.com/apollographql</a></li></ul><h2 id="基本用法" tabindex="-1">基本用法 <a class="header-anchor" href="#基本用法" aria-hidden="true">#</a></h2><p>1、准备</p><div class="language-Shell"><button title="Copy Code" class="copy"></button><span class="lang">Shell</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># 创建项目目录</span></span>
<span class="line"><span style="color:#DBD7CAEE;">mkdir graphql-server-example</span></span>
<span class="line"><span style="color:#B8A965;">cd</span><span style="color:#DBD7CAEE;"> graphql-server-example</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 初始化 package.json 文件</span></span>
<span class="line"><span style="color:#DBD7CAEE;">npm init -y</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 安装依赖</span></span>
<span class="line"><span style="color:#DBD7CAEE;">npm install apollo-server graphql</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 创建 index.js</span></span>
<span class="line"><span style="color:#DBD7CAEE;">touch index.js</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># 创建项目目录</span></span>
<span class="line"><span style="color:#393A34;">mkdir graphql-server-example</span></span>
<span class="line"><span style="color:#998418;">cd</span><span style="color:#393A34;"> graphql-server-example</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 初始化 package.json 文件</span></span>
<span class="line"><span style="color:#393A34;">npm init -y</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 安装依赖</span></span>
<span class="line"><span style="color:#393A34;">npm install apollo-server graphql</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 创建 index.js</span></span>
<span class="line"><span style="color:#393A34;">touch index.js</span></span>
<span class="line"></span></code></pre></div><p>2、index.js</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ApolloServer</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">gql</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">require</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">apollo-server</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">typeDefs</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">gql</span><span style="color:#C98A7DAA;">`</span></span>
<span class="line"><span style="color:#C98A7D;">  # Comments in GraphQL strings (such as this one) start with the hash (#) symbol.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C98A7D;">  # This &quot;Book&quot; type defines the queryable fields for every book in our data source.</span></span>
<span class="line"><span style="color:#C98A7D;">  type Book {</span></span>
<span class="line"><span style="color:#C98A7D;">    title: String</span></span>
<span class="line"><span style="color:#C98A7D;">    author: String</span></span>
<span class="line"><span style="color:#C98A7D;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C98A7D;">  # The &quot;Query&quot; type is special: it lists all of the available queries that</span></span>
<span class="line"><span style="color:#C98A7D;">  # clients can execute, along with the return type for each. In this</span></span>
<span class="line"><span style="color:#C98A7D;">  # case, the &quot;books&quot; query returns an array of zero or more Books (defined above).</span></span>
<span class="line"><span style="color:#C98A7D;">  type Query {</span></span>
<span class="line"><span style="color:#C98A7D;">    books: [Book]</span></span>
<span class="line"><span style="color:#C98A7D;">  }</span></span>
<span class="line"><span style="color:#C98A7DAA;">`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">books</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">The Awakening</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">author</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Kate Chopin</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">City of Glass</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">author</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Paul Auster</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resolvers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">Query</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">books</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">books</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// The ApolloServer constructor requires two parameters: your schema</span></span>
<span class="line"><span style="color:#758575DD;">// definition and your set of resolvers.</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">server</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">ApolloServer</span><span style="color:#666666;">({</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">typeDefs</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resolvers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// The `listen` method launches a web server.</span></span>
<span class="line"><span style="color:#BD976A;">server</span><span style="color:#666666;">.</span><span style="color:#80A665;">listen</span><span style="color:#666666;">().</span><span style="color:#80A665;">then</span><span style="color:#666666;">(({</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">url</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">`</span><span style="color:#C98A7D;">🚀  Server ready at </span><span style="color:#666666;">${</span><span style="color:#C98A7D;">url</span><span style="color:#666666;">}</span><span style="color:#C98A7DAA;">`</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#666666;">})</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ApolloServer</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">gql</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">require</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">apollo-server</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">typeDefs</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">gql</span><span style="color:#B56959AA;">`</span></span>
<span class="line"><span style="color:#B56959;">  # Comments in GraphQL strings (such as this one) start with the hash (#) symbol.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B56959;">  # This &quot;Book&quot; type defines the queryable fields for every book in our data source.</span></span>
<span class="line"><span style="color:#B56959;">  type Book {</span></span>
<span class="line"><span style="color:#B56959;">    title: String</span></span>
<span class="line"><span style="color:#B56959;">    author: String</span></span>
<span class="line"><span style="color:#B56959;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B56959;">  # The &quot;Query&quot; type is special: it lists all of the available queries that</span></span>
<span class="line"><span style="color:#B56959;">  # clients can execute, along with the return type for each. In this</span></span>
<span class="line"><span style="color:#B56959;">  # case, the &quot;books&quot; query returns an array of zero or more Books (defined above).</span></span>
<span class="line"><span style="color:#B56959;">  type Query {</span></span>
<span class="line"><span style="color:#B56959;">    books: [Book]</span></span>
<span class="line"><span style="color:#B56959;">  }</span></span>
<span class="line"><span style="color:#B56959AA;">`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">books</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">The Awakening</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">author</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Kate Chopin</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">City of Glass</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">author</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Paul Auster</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resolvers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">Query</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">books</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">books</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// The ApolloServer constructor requires two parameters: your schema</span></span>
<span class="line"><span style="color:#A0ADA0;">// definition and your set of resolvers.</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">server</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">ApolloServer</span><span style="color:#999999;">({</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">typeDefs</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resolvers</span><span style="color:#393A34;"> </span><span style="color:#999999;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// The `listen` method launches a web server.</span></span>
<span class="line"><span style="color:#B07D48;">server</span><span style="color:#999999;">.</span><span style="color:#59873A;">listen</span><span style="color:#999999;">().</span><span style="color:#59873A;">then</span><span style="color:#999999;">(({</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">url</span><span style="color:#393A34;"> </span><span style="color:#999999;">})</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">`</span><span style="color:#B56959;">🚀  Server ready at </span><span style="color:#999999;">${</span><span style="color:#B56959;">url</span><span style="color:#999999;">}</span><span style="color:#B56959AA;">`</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#999999;">})</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p>3、关于 gql 标签模板</p><ul><li>gql 标签模板将查询字符串解析为 AST，用于使用 Prettier 突出显示编辑器语法和自动格式化。</li><li>将来，我们将使用它来静态分析 GraphQL 查询，因此 Apollo Server 需要使用 gql 包装您的 schema。</li><li>gql 也可以用作将字符串转换为AST的常规函数</li></ul><h2 id="与-node-js-中间件集成" tabindex="-1">与 Node.js 中间件集成 <a class="header-anchor" href="#与-node-js-中间件集成" aria-hidden="true">#</a></h2><p>Apollo Server 可以轻松地与几个流行的 Node.js 中间件库集成。要集成，请首先从下表中安装适当的软件包，而不是核心 apollo-server 软件包。</p><h4 id="兼容的软件包" tabindex="-1">兼容的软件包 <a class="header-anchor" href="#兼容的软件包" aria-hidden="true">#</a></h4><table><thead><tr><th>中间件</th><th>npm包</th></tr></thead><tbody><tr><td>Express</td><td>apollo-server-express</td></tr><tr><td>AWS Lambda</td><td>apollo-server-lambda</td></tr><tr><td>Koa</td><td>apollo-server-koa</td></tr><tr><td>hapi</td><td>apollo-server-hapi</td></tr><tr><td>Micro</td><td>apollo-server-micro</td></tr><tr><td>Fastify</td><td>apollo-server-fastify</td></tr><tr><td>Google Cloud Functions</td><td>apollo-server-cloud-functions</td></tr><tr><td>Azure Functions</td><td>apollo-server-azure-functions</td></tr><tr><td>Cloudflare</td><td>apollo-server-cloudflare</td></tr><tr><td>如果您已经安装了核心 apollo-server 软件包，则可以在安装集成软件包后 npm 卸载它。</td><td></td></tr></tbody></table><h4 id="应用中间件" tabindex="-1">应用中间件 <a class="header-anchor" href="#应用中间件" aria-hidden="true">#</a></h4><p>与中间件集成时，首先像往常一样初始化 Apollo Server，然后调用 applyMiddleware。</p><p>这是为 Hello 服务的基本 Express 示例。从 /graphql 以外的每个路径访问，该路径与 Apollo Server 一起提供GraphQL端点：</p><div class="language-JavaScript"><button title="Copy Code" class="copy"></button><span class="lang">JavaScript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">express</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">require</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">express</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ApolloServer</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">require</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">apollo-server-express</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">typeDefs</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resolvers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">require</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">./schema</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">app</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">express</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">server</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">ApolloServer</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">typeDefs</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">resolvers</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BD976A;">server</span><span style="color:#666666;">.</span><span style="color:#80A665;">applyMiddleware</span><span style="color:#666666;">({</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">app</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BD976A;">app</span><span style="color:#666666;">.</span><span style="color:#80A665;">use</span><span style="color:#666666;">((</span><span style="color:#BD976A;">req</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#80A665;">status</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">200</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#80A665;">send</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Hello!</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#80A665;">end</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BD976A;">app</span><span style="color:#666666;">.</span><span style="color:#80A665;">listen</span><span style="color:#666666;">({</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">port</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">4000</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">},</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">`</span><span style="color:#C98A7D;">🚀 Server ready at http://localhost:4000</span><span style="color:#666666;">${</span><span style="color:#C98A7D;">server</span><span style="color:#666666;">.</span><span style="color:#C98A7D;">graphqlPath</span><span style="color:#666666;">}</span><span style="color:#C98A7DAA;">`</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#666666;">)</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">express</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">require</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">express</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ApolloServer</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">require</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">apollo-server-express</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">typeDefs</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resolvers</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">require</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">./schema</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">app</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">express</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">server</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">ApolloServer</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">typeDefs</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">resolvers</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B07D48;">server</span><span style="color:#999999;">.</span><span style="color:#59873A;">applyMiddleware</span><span style="color:#999999;">({</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">app</span><span style="color:#393A34;"> </span><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B07D48;">app</span><span style="color:#999999;">.</span><span style="color:#59873A;">use</span><span style="color:#999999;">((</span><span style="color:#B07D48;">req</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#59873A;">status</span><span style="color:#999999;">(</span><span style="color:#2F798A;">200</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#59873A;">send</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Hello!</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#59873A;">end</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B07D48;">app</span><span style="color:#999999;">.</span><span style="color:#59873A;">listen</span><span style="color:#999999;">({</span><span style="color:#393A34;"> </span><span style="color:#998418;">port</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">4000</span><span style="color:#393A34;"> </span><span style="color:#999999;">},</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">`</span><span style="color:#B56959;">🚀 Server ready at http://localhost:4000</span><span style="color:#999999;">${</span><span style="color:#B56959;">server</span><span style="color:#999999;">.</span><span style="color:#B56959;">graphqlPath</span><span style="color:#999999;">}</span><span style="color:#B56959AA;">`</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#999999;">)</span></span>
<span class="line"></span></code></pre></div><p>您提供给 applyMiddleware 的参数是中间件对应用程序的顶级表示。在 Express 应用程序中，此变量通常称为app。</p><p>当您将应用程序传递给 applyMiddleware 时，Apollo Server 会自动配置各种中间件（包括请求体解析，GraphQL Playground 前端和 CORS 支持），因此您不需要通过诸如 app.use 之类的机制来应用它们。</p><h2 id="解析器" tabindex="-1">解析器 <a class="header-anchor" href="#解析器" aria-hidden="true">#</a></h2><h4 id="基本用法-1" tabindex="-1">基本用法 <a class="header-anchor" href="#基本用法-1" aria-hidden="true">#</a></h4><p>schema：</p><div class="language-GraphQL"><button title="Copy Code" class="copy"></button><span class="lang">GraphQL</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">type</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">Query</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">numberSix</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">Int!</span><span style="color:#666666;"> </span><span style="color:#758575DD;"># Should always return the number 6 when queried</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">numberSeven</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">Int!</span><span style="color:#666666;"> </span><span style="color:#758575DD;"># Should always return 7</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">type</span><span style="color:#393A34;"> </span><span style="color:#998418;">Query</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">numberSix</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">Int!</span><span style="color:#999999;"> </span><span style="color:#A0ADA0;"># Should always return the number 6 when queried</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">numberSeven</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">Int!</span><span style="color:#999999;"> </span><span style="color:#A0ADA0;"># Should always return 7</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><p>resolver：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resolvers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">Query</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">numberSix</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">6</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">numberSeven</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">7</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resolvers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">Query</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">numberSix</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">6</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">numberSeven</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">7</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h4 id="处理参数" tabindex="-1">处理参数 <a class="header-anchor" href="#处理参数" aria-hidden="true">#</a></h4><p>schema：</p><div class="language-GraphQL"><button title="Copy Code" class="copy"></button><span class="lang">GraphQL</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">type</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">User</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">ID!</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">String</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">type</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">Query</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">user</span><span style="color:#666666;">(</span><span style="color:#BD976A;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">ID!</span><span style="color:#666666;">):</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">User</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">type</span><span style="color:#393A34;"> </span><span style="color:#998418;">User</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">ID!</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">String</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">type</span><span style="color:#393A34;"> </span><span style="color:#998418;">Query</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">user</span><span style="color:#999999;">(</span><span style="color:#B07D48;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">ID!</span><span style="color:#999999;">):</span><span style="color:#393A34;"> </span><span style="color:#998418;">User</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><p>resolver：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">users</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">1</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Elizabeth Bennet</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">id</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">2</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Fitzwilliam Darcy</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resolvers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">Query</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">user</span><span style="color:#666666;">(</span><span style="color:#BD976A;">parent</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">args</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">context</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">info</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">users</span><span style="color:#666666;">.</span><span style="color:#80A665;">find</span><span style="color:#666666;">(</span><span style="color:#BD976A;">user</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">user</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">args</span><span style="color:#666666;">.</span><span style="color:#BD976A;">id</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">users</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">1</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Elizabeth Bennet</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">id</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">2</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Fitzwilliam Darcy</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resolvers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">Query</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">user</span><span style="color:#999999;">(</span><span style="color:#B07D48;">parent</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">args</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">context</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">info</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">users</span><span style="color:#999999;">.</span><span style="color:#59873A;">find</span><span style="color:#999999;">(</span><span style="color:#B07D48;">user</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">user</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">args</span><span style="color:#999999;">.</span><span style="color:#B07D48;">id</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h4 id="解析器链" tabindex="-1">解析器链 <a class="header-anchor" href="#解析器链" aria-hidden="true">#</a></h4><p>schema：</p><div class="language-GraphQL"><button title="Copy Code" class="copy"></button><span class="lang">GraphQL</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># A library has a branch and books</span></span>
<span class="line"><span style="color:#4D9375;">type</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">Library</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">branch</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">String!</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">books</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#B8A965;">Book</span><span style="color:#CB7676;">!</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># A book has a title and author</span></span>
<span class="line"><span style="color:#4D9375;">type</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">Book</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">String!</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">author</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">Author</span><span style="color:#CB7676;">!</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># An author has a name</span></span>
<span class="line"><span style="color:#4D9375;">type</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">Author</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">String!</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">type</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">Query</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">libraries</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#B8A965;">Library</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># A library has a branch and books</span></span>
<span class="line"><span style="color:#1E754F;">type</span><span style="color:#393A34;"> </span><span style="color:#998418;">Library</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">branch</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">String!</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">books</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#998418;">Book</span><span style="color:#AB5959;">!</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># A book has a title and author</span></span>
<span class="line"><span style="color:#1E754F;">type</span><span style="color:#393A34;"> </span><span style="color:#998418;">Book</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">String!</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">author</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#998418;">Author</span><span style="color:#AB5959;">!</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># An author has a name</span></span>
<span class="line"><span style="color:#1E754F;">type</span><span style="color:#393A34;"> </span><span style="color:#998418;">Author</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">String!</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">type</span><span style="color:#393A34;"> </span><span style="color:#998418;">Query</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">libraries</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#998418;">Library</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p>有效的查询语法：</p><div class="language-GraphQL"><button title="Copy Code" class="copy"></button><span class="lang">GraphQL</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">query</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">GetBooksByLibrary</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">libraries</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">books</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#BD976A;">author</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#BD976A;">name</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">query</span><span style="color:#393A34;"> </span><span style="color:#59873A;">GetBooksByLibrary</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">libraries</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">books</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B07D48;">author</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B07D48;">name</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><p>此查询的结果解析器链与查询本身的层次结构匹配： <img src="/assets/10.ce13f13e.png" alt="img"></p><p>这些解析器按上述顺序执行，并将其返回值通过父参数传递给链中的下一个解析器。 resolver 处理如下：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ApolloServer</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">gql</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">require</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">apollo-server</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">libraries</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">branch</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">downtown</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">branch</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">riverside</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// The branch field of a book indicates which library has it in stock</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">books</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">The Awakening</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">author</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Kate Chopin</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">branch</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">riverside</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">City of Glass</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">author</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Paul Auster</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">branch</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">downtown</span><span style="color:#C98A7DAA;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// Schema definition</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">typeDefs</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">gql</span><span style="color:#C98A7DAA;">`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C98A7D;"># A library has a branch and books</span></span>
<span class="line"><span style="color:#C98A7D;">  type Library {</span></span>
<span class="line"><span style="color:#C98A7D;">    branch: String!</span></span>
<span class="line"><span style="color:#C98A7D;">    books: [Book!]</span></span>
<span class="line"><span style="color:#C98A7D;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C98A7D;">  # A book has a title and author</span></span>
<span class="line"><span style="color:#C98A7D;">  type Book {</span></span>
<span class="line"><span style="color:#C98A7D;">    title: String!</span></span>
<span class="line"><span style="color:#C98A7D;">    author: Author!</span></span>
<span class="line"><span style="color:#C98A7D;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C98A7D;">  # An author has a name</span></span>
<span class="line"><span style="color:#C98A7D;">  type Author {</span></span>
<span class="line"><span style="color:#C98A7D;">    name: String!</span></span>
<span class="line"><span style="color:#C98A7D;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C98A7D;">  # Queries can fetch a list of libraries</span></span>
<span class="line"><span style="color:#C98A7D;">  type Query {</span></span>
<span class="line"><span style="color:#C98A7D;">    libraries: [Library]</span></span>
<span class="line"><span style="color:#C98A7D;">  }</span></span>
<span class="line"><span style="color:#C98A7DAA;">`</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// Resolver map</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resolvers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">Query</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">libraries</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">      </span><span style="color:#758575DD;">// Return our hardcoded array of libraries</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">libraries</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">Library</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">books</span><span style="color:#666666;">(</span><span style="color:#BD976A;">parent</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">      </span><span style="color:#758575DD;">// Filter the hardcoded array of books to only include</span></span>
<span class="line"><span style="color:#666666;">      </span><span style="color:#758575DD;">// books that are located at the correct branch</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">books</span><span style="color:#666666;">.</span><span style="color:#80A665;">filter</span><span style="color:#666666;">(</span><span style="color:#BD976A;">book</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">book</span><span style="color:#666666;">.</span><span style="color:#BD976A;">branch</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">===</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">parent</span><span style="color:#666666;">.</span><span style="color:#BD976A;">branch</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">Book</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// The parent resolver (Library.books) returns an object with the</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// author&#39;s name in the &quot;author&quot; field. Return a JSON object containing</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// the name, because this field expects an object.</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">author</span><span style="color:#666666;">(</span><span style="color:#BD976A;">parent</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">name</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">parent</span><span style="color:#666666;">.</span><span style="color:#BD976A;">author</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">  </span><span style="color:#758575DD;">// Because Book.author returns an object with a &quot;name&quot; field,</span></span>
<span class="line"><span style="color:#666666;">  </span><span style="color:#758575DD;">// Apollo Server&#39;s default resolver for Author.name will work.</span></span>
<span class="line"><span style="color:#666666;">  </span><span style="color:#758575DD;">// We don&#39;t need to define one.</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// Pass schema definition and resolvers to the</span></span>
<span class="line"><span style="color:#758575DD;">// ApolloServer constructor</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">server</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">ApolloServer</span><span style="color:#666666;">({</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">typeDefs</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resolvers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// Launch the server</span></span>
<span class="line"><span style="color:#BD976A;">server</span><span style="color:#666666;">.</span><span style="color:#80A665;">listen</span><span style="color:#666666;">().</span><span style="color:#80A665;">then</span><span style="color:#666666;">(({</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">url</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">`</span><span style="color:#C98A7D;">🚀  Server ready at </span><span style="color:#666666;">${</span><span style="color:#C98A7D;">url</span><span style="color:#666666;">}</span><span style="color:#C98A7DAA;">`</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ApolloServer</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">gql</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">require</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">apollo-server</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">libraries</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">branch</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">downtown</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">branch</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">riverside</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// The branch field of a book indicates which library has it in stock</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">books</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">The Awakening</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">author</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Kate Chopin</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">branch</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">riverside</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">City of Glass</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">author</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Paul Auster</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">branch</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">downtown</span><span style="color:#B56959AA;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// Schema definition</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">typeDefs</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">gql</span><span style="color:#B56959AA;">`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B56959;"># A library has a branch and books</span></span>
<span class="line"><span style="color:#B56959;">  type Library {</span></span>
<span class="line"><span style="color:#B56959;">    branch: String!</span></span>
<span class="line"><span style="color:#B56959;">    books: [Book!]</span></span>
<span class="line"><span style="color:#B56959;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B56959;">  # A book has a title and author</span></span>
<span class="line"><span style="color:#B56959;">  type Book {</span></span>
<span class="line"><span style="color:#B56959;">    title: String!</span></span>
<span class="line"><span style="color:#B56959;">    author: Author!</span></span>
<span class="line"><span style="color:#B56959;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B56959;">  # An author has a name</span></span>
<span class="line"><span style="color:#B56959;">  type Author {</span></span>
<span class="line"><span style="color:#B56959;">    name: String!</span></span>
<span class="line"><span style="color:#B56959;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B56959;">  # Queries can fetch a list of libraries</span></span>
<span class="line"><span style="color:#B56959;">  type Query {</span></span>
<span class="line"><span style="color:#B56959;">    libraries: [Library]</span></span>
<span class="line"><span style="color:#B56959;">  }</span></span>
<span class="line"><span style="color:#B56959AA;">`</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// Resolver map</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resolvers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">Query</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">libraries</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">      </span><span style="color:#A0ADA0;">// Return our hardcoded array of libraries</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">libraries</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">Library</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">books</span><span style="color:#999999;">(</span><span style="color:#B07D48;">parent</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">      </span><span style="color:#A0ADA0;">// Filter the hardcoded array of books to only include</span></span>
<span class="line"><span style="color:#999999;">      </span><span style="color:#A0ADA0;">// books that are located at the correct branch</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">books</span><span style="color:#999999;">.</span><span style="color:#59873A;">filter</span><span style="color:#999999;">(</span><span style="color:#B07D48;">book</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">book</span><span style="color:#999999;">.</span><span style="color:#B07D48;">branch</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">===</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">parent</span><span style="color:#999999;">.</span><span style="color:#B07D48;">branch</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">Book</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// The parent resolver (Library.books) returns an object with the</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// author&#39;s name in the &quot;author&quot; field. Return a JSON object containing</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// the name, because this field expects an object.</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">author</span><span style="color:#999999;">(</span><span style="color:#B07D48;">parent</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">name</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">parent</span><span style="color:#999999;">.</span><span style="color:#B07D48;">author</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">  </span><span style="color:#A0ADA0;">// Because Book.author returns an object with a &quot;name&quot; field,</span></span>
<span class="line"><span style="color:#999999;">  </span><span style="color:#A0ADA0;">// Apollo Server&#39;s default resolver for Author.name will work.</span></span>
<span class="line"><span style="color:#999999;">  </span><span style="color:#A0ADA0;">// We don&#39;t need to define one.</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// Pass schema definition and resolvers to the</span></span>
<span class="line"><span style="color:#A0ADA0;">// ApolloServer constructor</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">server</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">ApolloServer</span><span style="color:#999999;">({</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">typeDefs</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resolvers</span><span style="color:#393A34;"> </span><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// Launch the server</span></span>
<span class="line"><span style="color:#B07D48;">server</span><span style="color:#999999;">.</span><span style="color:#59873A;">listen</span><span style="color:#999999;">().</span><span style="color:#59873A;">then</span><span style="color:#999999;">(({</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">url</span><span style="color:#393A34;"> </span><span style="color:#999999;">})</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">`</span><span style="color:#B56959;">🚀  Server ready at </span><span style="color:#999999;">${</span><span style="color:#B56959;">url</span><span style="color:#999999;">}</span><span style="color:#B56959AA;">`</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p>如果现在我们更新查询以同时询问每本书的标题：</p><div class="language-GraphQL"><button title="Copy Code" class="copy"></button><span class="lang">GraphQL</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">query</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">GetBooksByLibrary</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">libraries</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">books</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#BD976A;">title</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#BD976A;">author</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#BD976A;">name</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">query</span><span style="color:#393A34;"> </span><span style="color:#59873A;">GetBooksByLibrary</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">libraries</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">books</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B07D48;">title</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B07D48;">author</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B07D48;">name</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><p>然后，解析器链如下所示： <img src="/assets/11.257f9925.png" alt="img"></p><p>当一条链像这样“发散”时，每个子链并行执行。</p><h4 id="解析器参数" tabindex="-1">解析器参数 <a class="header-anchor" href="#解析器参数" aria-hidden="true">#</a></h4><p>解析程序函数按顺序接受以下位置参数：</p><table><thead><tr><th>论点</th><th>描述</th></tr></thead><tbody><tr><td>parent</td><td>此字段的父项（即，解析程序链中的前一个解析程序）的解析程序的返回值。</td></tr><tr><td>对于没有父级的顶级字段的解析器（例如Query的字段），此值是从传递给Apollo Server构造函数的rootValue函数获得的。</td><td></td></tr><tr><td>args</td><td>包含为此字段提供的所有GraphQL参数的对象。</td></tr><tr><td>例如，当执行查询 { user(id: &quot;4&quot;) } 时，传递给用户解析器的args对象是 { &quot;id&quot;: &quot;4&quot; }。</td><td></td></tr><tr><td>context</td><td>在为特定操作而执行的所有解析器之间共享的对象。使用它可以共享每个操作的状态，包括身份验证信息，数据加载器实例以及在解析器之间进行跟踪的其他任何内容。</td></tr><tr><td>info</td><td>包含有关操作执行状态的信息，包括字段名称，从根到字段的路径等。</td></tr><tr><td>GraphQL.js源代码中列出了它的核心字段，并且其他模块（例如apollo-cache-control）通过附加功能对其进行了扩展。</td><td></td></tr></tbody></table><h4 id="context-参数" tabindex="-1">context 参数 <a class="header-anchor" href="#context-参数" aria-hidden="true">#</a></h4><p>context 参数对于传递任何解析器可能需要的东西很有用，例如身份验证范围，数据库连接和自定义获取函数。如果您正在使用数据加载器跨解析器批处理请求，则也可以将它们附加到上下文。</p><p>解析器决不应破坏性地修改上下文参数。这样可以确保所有解析程序的一致性，并防止意外错误。</p><p>要为您的解析器提供上下文，请向 ApolloServer 构造函数添加上下文初始化函数。每个请求都会调用此函数，因此您可以根据请求的详细信息（例如HTTP标头）设置上下文。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"></span>
<span class="line"><span style="color:#758575DD;">// Constructor</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">server</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">ApolloServer</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">typeDefs</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">resolvers</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">context</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">req</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">authScope</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">getScope</span><span style="color:#666666;">(</span><span style="color:#BD976A;">req</span><span style="color:#666666;">.</span><span style="color:#BD976A;">headers</span><span style="color:#666666;">.</span><span style="color:#BD976A;">authorization</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">})</span></span>
<span class="line"><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;">)</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// Example resolver</span></span>
<span class="line"><span style="color:#666666;">(</span><span style="color:#BD976A;">parent</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">args</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">context</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">info</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#4D9375;">if</span><span style="color:#666666;">(</span><span style="color:#BD976A;">context</span><span style="color:#666666;">.</span><span style="color:#BD976A;">authScope</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">!==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ADMIN</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">throw</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">AuthenticationError</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">not admin</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">  </span><span style="color:#758575DD;">// Proceed</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// Constructor</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">server</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">ApolloServer</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">typeDefs</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">resolvers</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">context</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">req</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">authScope</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#59873A;">getScope</span><span style="color:#999999;">(</span><span style="color:#B07D48;">req</span><span style="color:#999999;">.</span><span style="color:#B07D48;">headers</span><span style="color:#999999;">.</span><span style="color:#B07D48;">authorization</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">})</span></span>
<span class="line"><span style="color:#999999;">})</span><span style="color:#393A34;">)</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// Example resolver</span></span>
<span class="line"><span style="color:#999999;">(</span><span style="color:#B07D48;">parent</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">args</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">context</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">info</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#1E754F;">if</span><span style="color:#999999;">(</span><span style="color:#B07D48;">context</span><span style="color:#999999;">.</span><span style="color:#B07D48;">authScope</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">!==</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ADMIN</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">throw</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">AuthenticationError</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">not admin</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">  </span><span style="color:#A0ADA0;">// Proceed</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><blockquote><p>如果您使用的是 Express 以外的中间件，则传递给上下文函数的对象的字段会有所不同。有关详细信息，请参见API参考。</p></blockquote><p>上下文初始化可以是异步的，从而可以完成数据库连接和其他操作：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#80A665;">context</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">db</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">await</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">client</span><span style="color:#666666;">.</span><span style="color:#80A665;">connect</span><span style="color:#666666;">(),</span></span>
<span class="line"><span style="color:#666666;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">// Resolver</span></span>
<span class="line"><span style="color:#666666;">(</span><span style="color:#BD976A;">parent</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">args</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">context</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">info</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">context</span><span style="color:#666666;">.</span><span style="color:#BD976A;">db</span><span style="color:#666666;">.</span><span style="color:#80A665;">query</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">SELECT * FROM table_name</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#59873A;">context</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">async</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">db</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">await</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">client</span><span style="color:#999999;">.</span><span style="color:#59873A;">connect</span><span style="color:#999999;">(),</span></span>
<span class="line"><span style="color:#999999;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">// Resolver</span></span>
<span class="line"><span style="color:#999999;">(</span><span style="color:#B07D48;">parent</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">args</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">context</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">info</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">context</span><span style="color:#999999;">.</span><span style="color:#B07D48;">db</span><span style="color:#999999;">.</span><span style="color:#59873A;">query</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">SELECT * FROM table_name</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h4 id="返回值" tabindex="-1">返回值 <a class="header-anchor" href="#返回值" aria-hidden="true">#</a></h4><p>Apollo Server根据其类型对解析器函数的返回值进行不同的处理：</p><table><thead><tr><th>类型</th><th>详情</th></tr></thead><tbody><tr><td>Scalar / object</td><td>解析程序可以返回单个值或对象，如定义解析程序中所示。该返回值通过父参数传递给任何嵌套的解析器。</td></tr><tr><td>Array</td><td>当且仅当您的模式指示解析器的关联字段包含列表时，才返回一个数组。</td></tr><tr><td>返回数组后，Apollo Server为数组中的每个项目执行嵌套的解析器。</td><td></td></tr><tr><td>null / undefined</td><td>表示找不到该字段的值。</td></tr><tr><td>如果您的模式指示此解析器的字段可为空，则操作结果在该字段的位置具有空值。</td><td></td></tr><tr><td>如果此解析器的字段不可为空，则Apollo Server会将字段的父级设置为null。如有必要，此过程将继续沿解析程序链向上移动，直至到达可为空的字段。这样可以确保响应永远不会为不可为空的字段包含空值。</td><td></td></tr><tr><td>Promise</td><td>解析程序通常执行异步操作，例如从数据库或后端API提取。为了支持这一点，解析器可以返回可解析为其他任何受支持的返回类型的promise。</td></tr></tbody></table><h4 id="默认解析器" tabindex="-1">默认解析器 <a class="header-anchor" href="#默认解析器" aria-hidden="true">#</a></h4><p>如果您没有为特定的架构字段定义解析器，则Apollo Server会为其定义默认解析器（请参阅源代码）。</p><p>默认的解析器功能使用以下逻辑： <img src="/assets/12.f91c5366.png" alt="img"></p><p>例如，请考虑以下 schema：</p><div class="language-GraphQL"><button title="Copy Code" class="copy"></button><span class="lang">GraphQL</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#4D9375;">type</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">Book</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">String</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">type</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">Author</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">books</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#B8A965;">Book</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#1E754F;">type</span><span style="color:#393A34;"> </span><span style="color:#998418;">Book</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">String</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">type</span><span style="color:#393A34;"> </span><span style="color:#998418;">Author</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">books</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#998418;">Book</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><p>如果 books 字段的解析程序返回一个对象数组，每个对象包含一个 title 字段，则可以为 title 字段使用默认的解析程序。默认解析器将正确返回 parent.title。</p><h4 id="监控解析器性能" tabindex="-1">监控解析器性能 <a class="header-anchor" href="#监控解析器性能" aria-hidden="true">#</a></h4><p>与所有代码一样，解析器的性能取决于其逻辑。重要的是要了解模式中的哪些字段在计算上是昂贵的或难以解决的，以便您可以提高其性能或确保仅在必要时查询它们。</p><p>Apollo Studio 直接与 Apollo Server 集成在一起，以提供字段级指标，以帮助您了解一段时间内数据图的性能。有关更多信息，请参阅分析性能。</p><p>在本地进行开发时，您可以为 ApolloServer 构造函数提供 tracing: true，以启用跟踪面板：</p><div class="language-JavaScript"><button title="Copy Code" class="copy"></button><span class="lang">JavaScript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">server</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">ApolloServer</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">typeDefs</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">resolvers</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">tracing</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">true</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">server</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">ApolloServer</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">typeDefs</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">resolvers</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">tracing</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">true</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span></code></pre></div><h2 id="连接到数据源" tabindex="-1">连接到数据源 <a class="header-anchor" href="#连接到数据源" aria-hidden="true">#</a></h2><p>Apollo Server 可以从多给位置获取数据。</p><p>Apollo提供了一个 DataSource 类，我们可以扩展该类以处理特定类型的数据源的交互逻辑。</p><h4 id="连接到-rest-api" tabindex="-1">连接到 REST API <a class="header-anchor" href="#连接到-rest-api" aria-hidden="true">#</a></h4><h4 id="连接到数据库" tabindex="-1">连接到数据库 <a class="header-anchor" href="#连接到数据库" aria-hidden="true">#</a></h4><p>SQLDataSource from datasource-sql MongoDataSource from apollo-datasource-mongodb</p><h4 id="从解析器访问数据" tabindex="-1">从解析器访问数据 <a class="header-anchor" href="#从解析器访问数据" aria-hidden="true">#</a></h4><p>为了使解析器能够访问数据源，可以将它们作为选项传递给 ApolloServer 构造函数：</p><div class="language-JavaScript"><button title="Copy Code" class="copy"></button><span class="lang">JavaScript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">server</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">ApolloServer</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">typeDefs</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">resolvers</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">dataSources</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#B8A965;">moviesAPI</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">MoviesAPI</span><span style="color:#666666;">(),</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#B8A965;">personalizationAPI</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">PersonalizationAPI</span><span style="color:#666666;">(),</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">context</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#B8A965;">token</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">foo</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">server</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">ApolloServer</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">typeDefs</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">resolvers</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">dataSources</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#998418;">moviesAPI</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">MoviesAPI</span><span style="color:#999999;">(),</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#998418;">personalizationAPI</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">PersonalizationAPI</span><span style="color:#999999;">(),</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">context</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#998418;">token</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">foo</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span></code></pre></div><p>Apollo Server 会将每个请求的数据源放在上下文中，因此您可以从解析器访问它们。它还将使您的数据源可以访问上下文。 （之所以没有让用户直接将数据源放在上下文中，是因为这会导致循环依赖。） 从解析器中，我们可以访问数据源并返回结果：</p><div class="language-JavaScript"><button title="Copy Code" class="copy"></button><span class="lang">JavaScript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">Query</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">movie</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">_source</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">id</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">},</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">dataSources</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">dataSources</span><span style="color:#666666;">.</span><span style="color:#BD976A;">moviesAPI</span><span style="color:#666666;">.</span><span style="color:#80A665;">getMovie</span><span style="color:#666666;">(</span><span style="color:#BD976A;">id</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">mostViewedMovies</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">_source</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">_args</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">dataSources</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">dataSources</span><span style="color:#666666;">.</span><span style="color:#BD976A;">moviesAPI</span><span style="color:#666666;">.</span><span style="color:#80A665;">getMostViewedMovies</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">favorites</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">async</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">_source</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">_args</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">dataSources</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">dataSources</span><span style="color:#666666;">.</span><span style="color:#BD976A;">personalizationAPI</span><span style="color:#666666;">.</span><span style="color:#80A665;">getFavorites</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#393A34;"> </span><span style="color:#59873A;">Query</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">movie</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">async</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">_source</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">id</span><span style="color:#393A34;"> </span><span style="color:#999999;">},</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">dataSources</span><span style="color:#393A34;"> </span><span style="color:#999999;">})</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">dataSources</span><span style="color:#999999;">.</span><span style="color:#B07D48;">moviesAPI</span><span style="color:#999999;">.</span><span style="color:#59873A;">getMovie</span><span style="color:#999999;">(</span><span style="color:#B07D48;">id</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">mostViewedMovies</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">async</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">_source</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">_args</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">dataSources</span><span style="color:#393A34;"> </span><span style="color:#999999;">})</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">dataSources</span><span style="color:#999999;">.</span><span style="color:#B07D48;">moviesAPI</span><span style="color:#999999;">.</span><span style="color:#59873A;">getMostViewedMovies</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">favorites</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">async</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">_source</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">_args</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">dataSources</span><span style="color:#393A34;"> </span><span style="color:#999999;">})</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">dataSources</span><span style="color:#999999;">.</span><span style="color:#B07D48;">personalizationAPI</span><span style="color:#999999;">.</span><span style="color:#59873A;">getFavorites</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"></span></code></pre></div><h4 id="关于-dataloader" tabindex="-1">关于 DataLoader <a class="header-anchor" href="#关于-dataloader" aria-hidden="true">#</a></h4><h4 id="使用-memcached-redis-缓存后端数据" tabindex="-1">使用 Memcached/Redis 缓存后端数据 <a class="header-anchor" href="#使用-memcached-redis-缓存后端数据" aria-hidden="true">#</a></h4><h4 id="实现自己的缓存后端" tabindex="-1">实现自己的缓存后端 <a class="header-anchor" href="#实现自己的缓存后端" aria-hidden="true">#</a></h4><h2 id="错误处理" tabindex="-1">错误处理 <a class="header-anchor" href="#错误处理" aria-hidden="true">#</a></h2><p>Apollo 服务器提供了一组预定义的错误，包括 AuthenticationError，ForbiddenError，UserInputError 和常规 ApolloError。这些错误旨在增强 GraphQL 执行之前和执行过程中引发的错误，从而使调试 Apollo Server 集成更加容易，并使客户端能够基于错误采取特定的措施。</p><p>当解析器内部和外部的 Apollo Server 中都发生错误时，errors 数组内部的每个错误都包含一个扩展对象，该对象包含由 Apollo Server 添加的信息。</p><h4 id="默认信息" tabindex="-1">默认信息 <a class="header-anchor" href="#默认信息" aria-hidden="true">#</a></h4><p>改善服务器可用性的第一步是默认情况下提供错误堆栈跟踪。下面的示例演示了从Apollo Server返回的响应，该响应带有引发节点 SystemError 的解析器。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">ApolloServer</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">gql</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">require</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">apollo-server</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">typeDefs</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">gql</span><span style="color:#C98A7DAA;">`</span></span>
<span class="line"><span style="color:#C98A7D;">  type Query {</span></span>
<span class="line"><span style="color:#C98A7D;">    readError: String</span></span>
<span class="line"><span style="color:#C98A7D;">  }</span></span>
<span class="line"><span style="color:#C98A7DAA;">`</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resolvers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">Query</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">readError</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">parent</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">args</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">context</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#BD976A;">fs</span><span style="color:#666666;">.</span><span style="color:#80A665;">readFileSync</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">/does/not/exist</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">ApolloServer</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">gql</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">require</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">apollo-server</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">typeDefs</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">gql</span><span style="color:#B56959AA;">`</span></span>
<span class="line"><span style="color:#B56959;">  type Query {</span></span>
<span class="line"><span style="color:#B56959;">    readError: String</span></span>
<span class="line"><span style="color:#B56959;">  }</span></span>
<span class="line"><span style="color:#B56959AA;">`</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resolvers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">Query</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">readError</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">parent</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">args</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">context</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B07D48;">fs</span><span style="color:#999999;">.</span><span style="color:#59873A;">readFileSync</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">/does/not/exist</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span></code></pre></div><p>响应结果如下： <img src="/assets/13.0b61b04f.png" alt="img"></p><p>要为生产禁用堆栈跟踪，请将 debug: false 传递给 Apollo Server 构造函数，或者将 NODE_ENV 环境变量设置为 &#39;production&#39; 或 &#39;test&#39;。请注意，这会使 stacktrace 对您的应用程序不可用。如果要记录堆栈跟踪信息，但不将其发送给客户端，请参阅下面的屏蔽和记录错误。</p><h4 id="错误代号" tabindex="-1">错误代号 <a class="header-anchor" href="#错误代号" aria-hidden="true">#</a></h4><p>除了堆栈跟踪外，Apollo Server 导出的错误还在扩展的代码字段中指定了人类可读的字符串，该字符串使客户端能够执行纠正措施。除了改善客户体验之外，代码字段还允许服务器对错误进行分类。例如，AuthenticationError 将代码设置为 UNAUTHENTICATED，这使客户端可以重新进行身份验证，通常会被视为服务器异常而被忽略。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">ApolloServer</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">gql</span><span style="color:#666666;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">AuthenticationError</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">require</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">apollo-server</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">typeDefs</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">gql</span><span style="color:#C98A7DAA;">`</span></span>
<span class="line"><span style="color:#C98A7D;">  type Query {</span></span>
<span class="line"><span style="color:#C98A7D;">    authenticationError: String</span></span>
<span class="line"><span style="color:#C98A7D;">  }</span></span>
<span class="line"><span style="color:#C98A7DAA;">`</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resolvers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">Query</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">authenticationError</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">parent</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">args</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">context</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">throw</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">AuthenticationError</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">must authenticate</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">ApolloServer</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">gql</span><span style="color:#999999;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">AuthenticationError</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">require</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">apollo-server</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">typeDefs</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">gql</span><span style="color:#B56959AA;">`</span></span>
<span class="line"><span style="color:#B56959;">  type Query {</span></span>
<span class="line"><span style="color:#B56959;">    authenticationError: String</span></span>
<span class="line"><span style="color:#B56959;">  }</span></span>
<span class="line"><span style="color:#B56959AA;">`</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resolvers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">Query</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">authenticationError</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">parent</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">args</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">context</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">throw</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">AuthenticationError</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">must authenticate</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span></code></pre></div><p>响应结果如下： <img src="/assets/14.bb8324d8.png" alt="img"></p><h4 id="扩大错误的详细信息" tabindex="-1">扩大错误的详细信息 <a class="header-anchor" href="#扩大错误的详细信息" aria-hidden="true">#</a></h4><p>当客户端提供错误的输入时，您可能希望针对无效的每个字段或参数返回其他信息，例如本地化消息。下面的示例演示如何使用 UserInputError 来添加更多详细信息来增加错误消息。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">ApolloServer</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">UserInputError</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">gql</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">require</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">apollo-server</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">typeDefs</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">gql</span><span style="color:#C98A7DAA;">`</span></span>
<span class="line"><span style="color:#C98A7D;">  type Mutation {</span></span>
<span class="line"><span style="color:#C98A7D;">    userInputError(input: String): String</span></span>
<span class="line"><span style="color:#C98A7D;">  }</span></span>
<span class="line"><span style="color:#C98A7DAA;">`</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resolvers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">Mutation</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">userInputError</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">parent</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">args</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">context</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">info</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">args</span><span style="color:#666666;">.</span><span style="color:#BD976A;">input</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">!==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">expected</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">throw</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">UserInputError</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Form Arguments invalid</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">          </span><span style="color:#B8A965;">invalidArgs</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Object</span><span style="color:#666666;">.</span><span style="color:#80A665;">keys</span><span style="color:#666666;">(</span><span style="color:#BD976A;">args</span><span style="color:#666666;">),</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">ApolloServer</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">UserInputError</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">gql</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">require</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">apollo-server</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">typeDefs</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">gql</span><span style="color:#B56959AA;">`</span></span>
<span class="line"><span style="color:#B56959;">  type Mutation {</span></span>
<span class="line"><span style="color:#B56959;">    userInputError(input: String): String</span></span>
<span class="line"><span style="color:#B56959;">  }</span></span>
<span class="line"><span style="color:#B56959AA;">`</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">resolvers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">Mutation</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">userInputError</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">parent</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">args</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">context</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">info</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">args</span><span style="color:#999999;">.</span><span style="color:#B07D48;">input</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">!==</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">expected</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">throw</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">UserInputError</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Form Arguments invalid</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#998418;">invalidArgs</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Object</span><span style="color:#999999;">.</span><span style="color:#59873A;">keys</span><span style="color:#999999;">(</span><span style="color:#B07D48;">args</span><span style="color:#999999;">),</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span></code></pre></div><p>响应将返回： <img src="/assets/15.8bc71c9d.png" alt="img"></p><h4 id="其它错误" tabindex="-1">其它错误 <a class="header-anchor" href="#其它错误" aria-hidden="true">#</a></h4><p>如果需要定义特定于您的应用程序的其他错误代码，则可以使用 ApolloError 基类。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">ApolloError</span><span style="color:#666666;">(</span><span style="color:#BD976A;">message</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">code</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">additionalProperties</span><span style="color:#666666;">);</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">ApolloError</span><span style="color:#999999;">(</span><span style="color:#B07D48;">message</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">code</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">additionalProperties</span><span style="color:#999999;">);</span></span>
<span class="line"></span></code></pre></div><h4 id="掩盖和记录错误" tabindex="-1">掩盖和记录错误 <a class="header-anchor" href="#掩盖和记录错误" aria-hidden="true">#</a></h4><p>对于客户端响应 Apollo Server 构造函数接受一个 formatError 函数，该函数在传递回客户端的每个错误上运行。这可用于掩盖错误以及记录日志。</p><blockquote><p>请注意，虽然这会更改发送到客户端的错误，但不会更改发送到 Apollo Studio 的错误。如果需要此行为，请参见下面的 For Apollo Studio 报告中的 rewriteError 函数。</p></blockquote><p>此示例演示当错误消息以 Database Error: 开头时抛出另一个错误：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">server</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">ApolloServer</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">typeDefs</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">resolvers</span><span style="color:#666666;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">formatError</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">err</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// Don&#39;t give the specific errors to the client.</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">err</span><span style="color:#666666;">.</span><span style="color:#BD976A;">message</span><span style="color:#666666;">.</span><span style="color:#80A665;">startsWith</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">Database Error: </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">))</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">Error</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Internal server error</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// Otherwise return the original error.  The error can also</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// be manipulated in other ways, so long as it&#39;s returned.</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">err</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BD976A;">server</span><span style="color:#666666;">.</span><span style="color:#80A665;">listen</span><span style="color:#666666;">().</span><span style="color:#80A665;">then</span><span style="color:#666666;">(({</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">url</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">`</span><span style="color:#C98A7D;">🚀 Server ready at </span><span style="color:#666666;">${</span><span style="color:#C98A7D;">url</span><span style="color:#666666;">}</span><span style="color:#C98A7DAA;">`</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">server</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">ApolloServer</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">typeDefs</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">resolvers</span><span style="color:#999999;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">formatError</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">err</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// Don&#39;t give the specific errors to the client.</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">err</span><span style="color:#999999;">.</span><span style="color:#B07D48;">message</span><span style="color:#999999;">.</span><span style="color:#59873A;">startsWith</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">Database Error: </span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">))</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">Error</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Internal server error</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// Otherwise return the original error.  The error can also</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// be manipulated in other ways, so long as it&#39;s returned.</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">err</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B07D48;">server</span><span style="color:#999999;">.</span><span style="color:#59873A;">listen</span><span style="color:#999999;">().</span><span style="color:#59873A;">then</span><span style="color:#999999;">(({</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">url</span><span style="color:#393A34;"> </span><span style="color:#999999;">})</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">`</span><span style="color:#B56959;">🚀 Server ready at </span><span style="color:#999999;">${</span><span style="color:#B56959;">url</span><span style="color:#999999;">}</span><span style="color:#B56959AA;">`</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span></code></pre></div><p>formatError（一个GraphQLError）接收到的错误实例包含一个 originalError 属性，该属性表示在解析器中引发的原始错误。这可以用于 instanceof 检查特定的错误类，例如 AuthenticationError，ValidationError 等：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;">/* ... */</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">formatError</span><span style="color:#666666;">(</span><span style="color:#BD976A;">err</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">err</span><span style="color:#666666;">.</span><span style="color:#BD976A;">originalError</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">instanceof</span><span style="color:#DBD7CAEE;"> </span><span style="color:#5DA9A7;">AuthenticationError</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">Error</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Different authentication error message!</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;">/* ... */</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#393A34;">  </span><span style="color:#A0ADA0;">/* ... */</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">formatError</span><span style="color:#999999;">(</span><span style="color:#B07D48;">err</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">err</span><span style="color:#999999;">.</span><span style="color:#B07D48;">originalError</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">instanceof</span><span style="color:#393A34;"> </span><span style="color:#2E808F;">AuthenticationError</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">Error</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Different authentication error message!</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#A0ADA0;">/* ... */</span></span>
<span class="line"></span></code></pre></div><blockquote><p>要针对 formatError 接收到的错误进行特定于上下文的调整（例如，本地化或个性化设置），请考虑使用 didEncounterErrors 生命周期挂钩将其他属性附加到错误，可以在 formatError 中访问和利用附加属性。</p></blockquote><h4 id="对于-apollo-studio-报告" tabindex="-1">对于 Apollo Studio 报告 <a class="header-anchor" href="#对于-apollo-studio-报告" aria-hidden="true">#</a></h4><h2 id="权限认证" tabindex="-1">权限认证 <a class="header-anchor" href="#权限认证" aria-hidden="true">#</a></h2><p>如何在 GraphQL API 中授权用户和权限控制。</p><p>在构建GraphQL端点时的某个时间点（可能很早），您可能不得不面对一个问题，即如何控制谁可以看到您的API中的数据并与之交互。</p><p>身份验证是确定用户是否已登录，然后确定某人是哪个用户。然后，授权将决定用户有权执行或查看的内容。</p><p>一旦知道用户尝试发出请求，本文将主要侧重于如何为您的 schema 设置授权，但是我们将通过一个身份验证示例来了解我们正在做的事情的背景。</p><h4 id="将用户信息放到-context-中" tabindex="-1">将用户信息放到 context 中 <a class="header-anchor" href="#将用户信息放到-context-中" aria-hidden="true">#</a></h4><p>在弄清楚用户权限之前，我们必须先弄清楚如何识别用户。从 HTTP 标头到 JSON Web Token，有多种方法可以处理用户身份验证，但是一旦拥有用户，控制访问就非常相似。</p><p>我们将以 HTTP 授权标头中的登录令牌为例。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// using apollo-server 2.x</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ApolloServer</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">require</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">apollo-server</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">server</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">ApolloServer</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">typeDefs</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">resolvers</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">context</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">({</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">req</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">   </span><span style="color:#758575DD;">// Note! This example uses the `req` object to access headers,</span></span>
<span class="line"><span style="color:#666666;">   </span><span style="color:#758575DD;">// but the arguments received by `context` vary by integration.</span></span>
<span class="line"><span style="color:#666666;">   </span><span style="color:#758575DD;">// This means they will vary for Express, Koa, Lambda, etc.!</span></span>
<span class="line"><span style="color:#666666;">   </span><span style="color:#758575DD;">//</span></span>
<span class="line"><span style="color:#666666;">   </span><span style="color:#758575DD;">// To find out the correct arguments for a specific integration,</span></span>
<span class="line"><span style="color:#666666;">   </span><span style="color:#758575DD;">// see the `context` option in the API reference for `apollo-server`:</span></span>
<span class="line"><span style="color:#666666;">   </span><span style="color:#758575DD;">// https://www.apollographql.com/docs/apollo-server/api/apollo-server/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">   </span><span style="color:#758575DD;">// Get the user token from the headers.</span></span>
<span class="line"><span style="color:#DBD7CAEE;">   </span><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">token</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">req</span><span style="color:#666666;">.</span><span style="color:#BD976A;">headers</span><span style="color:#666666;">.</span><span style="color:#BD976A;">authorization</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">||</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">   </span><span style="color:#758575DD;">// try to retrieve a user with the token</span></span>
<span class="line"><span style="color:#DBD7CAEE;">   </span><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">user</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">getUser</span><span style="color:#666666;">(</span><span style="color:#BD976A;">token</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#666666;">   </span><span style="color:#758575DD;">// add the user to the context</span></span>
<span class="line"><span style="color:#DBD7CAEE;">   </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">user</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BD976A;">server</span><span style="color:#666666;">.</span><span style="color:#80A665;">listen</span><span style="color:#666666;">().</span><span style="color:#80A665;">then</span><span style="color:#666666;">(({</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">url</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">})</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">`</span><span style="color:#C98A7D;">🚀 Server ready at </span><span style="color:#666666;">${</span><span style="color:#C98A7D;">url</span><span style="color:#666666;">}</span><span style="color:#C98A7DAA;">`</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// using apollo-server 2.x</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ApolloServer</span><span style="color:#393A34;"> </span><span style="color:#999999;">}</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">require</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">apollo-server</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">server</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">ApolloServer</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;"> </span><span style="color:#B07D48;">typeDefs</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;"> </span><span style="color:#B07D48;">resolvers</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;"> </span><span style="color:#59873A;">context</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">({</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">req</span><span style="color:#393A34;"> </span><span style="color:#999999;">})</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">   </span><span style="color:#A0ADA0;">// Note! This example uses the `req` object to access headers,</span></span>
<span class="line"><span style="color:#999999;">   </span><span style="color:#A0ADA0;">// but the arguments received by `context` vary by integration.</span></span>
<span class="line"><span style="color:#999999;">   </span><span style="color:#A0ADA0;">// This means they will vary for Express, Koa, Lambda, etc.!</span></span>
<span class="line"><span style="color:#999999;">   </span><span style="color:#A0ADA0;">//</span></span>
<span class="line"><span style="color:#999999;">   </span><span style="color:#A0ADA0;">// To find out the correct arguments for a specific integration,</span></span>
<span class="line"><span style="color:#999999;">   </span><span style="color:#A0ADA0;">// see the `context` option in the API reference for `apollo-server`:</span></span>
<span class="line"><span style="color:#999999;">   </span><span style="color:#A0ADA0;">// https://www.apollographql.com/docs/apollo-server/api/apollo-server/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">   </span><span style="color:#A0ADA0;">// Get the user token from the headers.</span></span>
<span class="line"><span style="color:#393A34;">   </span><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">token</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">req</span><span style="color:#999999;">.</span><span style="color:#B07D48;">headers</span><span style="color:#999999;">.</span><span style="color:#B07D48;">authorization</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">||</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">   </span><span style="color:#A0ADA0;">// try to retrieve a user with the token</span></span>
<span class="line"><span style="color:#393A34;">   </span><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">user</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">getUser</span><span style="color:#999999;">(</span><span style="color:#B07D48;">token</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;">   </span><span style="color:#A0ADA0;">// add the user to the context</span></span>
<span class="line"><span style="color:#393A34;">   </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">user</span><span style="color:#393A34;"> </span><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#393A34;"> </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B07D48;">server</span><span style="color:#999999;">.</span><span style="color:#59873A;">listen</span><span style="color:#999999;">().</span><span style="color:#59873A;">then</span><span style="color:#999999;">(({</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">url</span><span style="color:#393A34;"> </span><span style="color:#999999;">})</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;"> </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">`</span><span style="color:#B56959;">🚀 Server ready at </span><span style="color:#999999;">${</span><span style="color:#B56959;">url</span><span style="color:#999999;">}</span><span style="color:#B56959AA;">`</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span></code></pre></div><p>那么，这里到底发生了什么？此代码块使用 Apollo Server 2.0 设置新的 GraphQL 服务器。新版本的 Apollo Server 简化了用于创建新服务器的 API，并具有一些更智能的默认值。你可以在这里读更多关于它的内容！</p><p>在此构造函数中，我们将类型定义和解析器传递给构造函数以及用于构建上下文对象的函数。上下文对象是传递给每个级别的每个解析器的对象，因此我们可以在 schema 代码中的任何位置访问它。在这里我们可以存储数据提取程序，数据库连接以及（方便地）有关发出请求的用户的信息。</p><p>由于每次新请求都会重新生成上下文，因此我们不必担心在执行结束时清理用户数据。</p><p>这里的上下文函数查看请求标头，提取名为 authorization 的标头，并将其存储到变量中。然后，它将使用该令牌调用 getUser 函数，并期望在令牌有效的情况下返回用户。之后，它返回一个包含（潜在）用户的上下文对象，供我们所有的解析器使用。</p><p>对于每种身份验证方法，检索用户的细节将有所不同，但是最终部分每次都会看起来相同。您的 schema 需要的授权可能要求您仅在上下文中添加 <code>{ loggingIn: true }</code>，但可能还需要 ID 或角色，例如 <code>{user: {id: 12345，role: [&#39;user&#39;, &#39;admin&#39; ]}}</code>。</p><p>在下一节中，我们将探讨使用现在需要保护用户信息的用户信息的方法。</p><h4 id="schema-授权" tabindex="-1">Schema 授权 <a class="header-anchor" href="#schema-授权" aria-hidden="true">#</a></h4><h4 id="解析器中的授权" tabindex="-1">解析器中的授权 <a class="header-anchor" href="#解析器中的授权" aria-hidden="true">#</a></h4><h4 id="数据模型中的授权" tabindex="-1">数据模型中的授权 <a class="header-anchor" href="#数据模型中的授权" aria-hidden="true">#</a></h4><h4 id="通过自定义指令授权" tabindex="-1">通过自定义指令授权 <a class="header-anchor" href="#通过自定义指令授权" aria-hidden="true">#</a></h4><h4 id="graphql-之外的授权" tabindex="-1">GraphQL 之外的授权 <a class="header-anchor" href="#graphql-之外的授权" aria-hidden="true">#</a></h4><h2 id="apollo-client" tabindex="-1">Apollo Client <a class="header-anchor" href="#apollo-client" aria-hidden="true">#</a></h2><ul><li><a href="https://www.apollographql.com/docs/react/integrations/integrations/" target="_blank" rel="noreferrer">https://www.apollographql.com/docs/react/integrations/integrations/</a></li><li><a href="https://github.com/vuejs/vue-apollo" target="_blank" rel="noreferrer">https://github.com/vuejs/vue-apollo</a></li><li><a href="http://apollo.vuejs.org/" target="_blank" rel="noreferrer">http://apollo.vuejs.org/</a></li></ul><h2 id="graphql-综合案例" tabindex="-1">GraphQL 综合案例 <a class="header-anchor" href="#graphql-综合案例" aria-hidden="true">#</a></h2><ul><li><a href="https://github.com/attraction11/realworld-graphql" target="_blank" rel="noreferrer">https://github.com/attraction11/realworld-graphql</a></li></ul><h2 id="其它工具库" tabindex="-1">其它工具库 <a class="header-anchor" href="#其它工具库" aria-hidden="true">#</a></h2><ul><li><a href="https://github.com/MichalLytek/type-graphql" target="_blank" rel="noreferrer">TypeGraphQL</a> 使用类和装饰器，使用TypeScript创建GraphQL模式和解析器！</li><li><a href="https://github.com/tipeio/tipe" target="_blank" rel="noreferrer">Tipe</a> 面向开发人员的下一代 API 优先 CMS。使用脱机原型和内联编辑器从 GraphQL schema 生成 API 优先的 CMS。</li></ul><p>graphql-tools</p><ul><li>graphql-tools 是一个用于更快地开发 GraphQL schema 的实用工具库。 <ul><li>官方网站：<a href="https://www.graphql-tools.com/" target="_blank" rel="noreferrer">https://www.graphql-tools.com/</a></li><li>GitHub 仓库：<a href="https://github.com/ardatan/graphql-tools" target="_blank" rel="noreferrer">https://github.com/ardatan/graphql-tools</a></li></ul></li><li>GraphQL 优先 <ul><li>使用 GraphQL schema 语言来生成完全支持解析器、接口、联合类型和自定义标量的 schema</li><li>生成的 schema 与 GraphQL.js 完全兼容</li></ul></li><li>模拟 GraphQL API <ul><li>它不仅对构建服务器有用，它也可以在浏览器中使用，例如在开发或测试期间模拟后端</li><li>借助 GraphQL 工具，您可以使用细粒度的每个类型的模拟来模拟 GraphQL API，从而无需任何数据源即可进行快速原型制作。</li></ul></li><li>拼接多个 GraphQL schema <ul><li>以简单，快速和强大的方式将多个 schema 自动缝合到一个较大的 API 中</li></ul></li><li>它可以与任何一个 GraphQL-JS 架构一起使用，并且每个工具都可以单独使用</li></ul></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-97ada51d data-v-fec45cf1><!----><div class="prev-next" data-v-fec45cf1><div class="pager" data-v-fec45cf1><a class="pager-link prev" href="/FullStack/GraphQL/Type.html" data-v-fec45cf1><span class="desc" data-v-fec45cf1>Previous page</span><span class="title" data-v-fec45cf1>GraphQL 模式和类型</span></a></div><div class="has-prev pager" data-v-fec45cf1><a class="pager-link next" href="/FullStack/GraphQL/QA.html" data-v-fec45cf1><span class="desc" data-v-fec45cf1>Next page</span><span class="title" data-v-fec45cf1>QA 问答</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-04c1d245 data-v-e01008a6><div class="container" data-v-e01008a6><p class="message" data-v-e01008a6>Released under the MIT License.</p><p class="copyright" data-v-e01008a6>Copyright © 2022-present Attraction11</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"framework_react_cssinjs.md\":\"3b21a3b7\",\"framework_react_mobx6.md\":\"1f2c883b\",\"framework_react_qa.md\":\"37bd07c6\",\"framework_react_react.md\":\"bd67f700\",\"framework_react_react16code.md\":\"0a34ff69\",\"framework_react_react18_新特性.md\":\"10efc49b\",\"framework_react_reactdiff.md\":\"dc5bbb0f\",\"framework_react_reacthooks.md\":\"a691b198\",\"framework_react_reactoptimize.md\":\"9d1d66f4\",\"framework_react_reactredux.md\":\"9b99e5f8\",\"framework_react_reactrouter.md\":\"5406d92d\",\"framework_react_redux.md\":\"e074c1b5\",\"framework_react_reduxcode.md\":\"9b4b4a76\",\"framework_react_reduxormobx.md\":\"75425c68\",\"framework_render_nextjs.md\":\"e58b8875\",\"framework_render_nuxtbase.md\":\"f847b159\",\"framework_render_reactssr.md\":\"053f1f87\",\"framework_render_serverender.md\":\"72a5cb82\",\"framework_render_vuessr.md\":\"f46a3a50\",\"framework_render_index.md\":\"d6aec6f6\",\"framework_staticsite_gatsby.md\":\"d70dd340\",\"framework_staticsite_gridsome.md\":\"3f6c3842\",\"framework_vue_introduce.md\":\"68b714e1\",\"framework_vue_qa.md\":\"df7a3fde\",\"framework_vue_vuecore.md\":\"033d0b60\",\"framework_vue_vuerouter.md\":\"7a79f8f6\",\"framework_vue_vuex.md\":\"9a096e1b\",\"fullstack_docker_introduce.md\":\"97a11146\",\"fullstack_graphql_apollo.md\":\"fdb2018b\",\"fullstack_graphql_first.md\":\"5bb3704a\",\"fullstack_graphql_qa.md\":\"e11784fb\",\"fullstack_graphql_type.md\":\"d79824c0\",\"fullstack_graphql_index.md\":\"7f93a2f1\",\"fullstack_mongodb_introduce.md\":\"6112639d\",\"fullstack_nest_introduce.md\":\"f81fc580\",\"fullstack_nest_nestdev.md\":\"e07f55a8\",\"fullstack_nest_nestlesson.md\":\"93458952\",\"fullstack_nginx_index.md\":\"1ce03532\",\"fullstack_node_comparison.md\":\"33d37d74\",\"fullstack_node_eggdev.md\":\"0a69e413\",\"fullstack_node_expressdev.md\":\"bafcb5d1\",\"fullstack_node_fileopt.md\":\"f5b683b5\",\"fullstack_node_introduce.md\":\"111d1543\",\"fullstack_node_keepsession.md\":\"47300224\",\"fullstack_node_koadev.md\":\"49af9c31\",\"fullstack_node_module.md\":\"a612ba8b\",\"fullstack_node_nodebase.md\":\"67b6da53\",\"fullstack_node_nodecore.md\":\"978f7515\",\"fullstack_node_nodedev.md\":\"e9a8dc58\",\"fullstack_node_nodemessage.md\":\"f4c4bbfa\",\"fullstack_node_nodeqa.md\":\"e9f43f02\",\"fullstack_redis_crud.md\":\"eb433b19\",\"fullstack_redis_client.md\":\"c8a83f6d\",\"fullstack_redis_cluster.md\":\"1abb3c18\",\"fullstack_redis_config.md\":\"f1b94703\",\"fullstack_redis_connect.md\":\"570ba88b\",\"fullstack_redis_expire.md\":\"a47e2dfc\",\"fullstack_redis_introduce.md\":\"55f93500\",\"fullstack_redis_moredb.md\":\"29020467\",\"fullstack_redis_multi.md\":\"4d4b9a0b\",\"fullstack_redis_persistence.md\":\"a3253cd6\",\"fullstack_redis_setup.md\":\"01767e99\",\"fullstack_redis_softadmin.md\":\"79c792d9\",\"javascript_asynchronous_heap_stack.md\":\"2812e838\",\"javascript_asynchronous_index.md\":\"f42dd26b\",\"javascript_asynchronous_jsconcepts.md\":\"e110e6d8\",\"javascript_asynchronous_objectoriented.md\":\"350943b9\",\"javascript_asynchronous_promise.md\":\"43b34daa\",\"javascript_asynchronous_promisecode.md\":\"e7807bb5\",\"javascript_asynchronous_this.md\":\"b1e77870\",\"javascript_esfeatures_index.md\":\"1073e24d\",\"javascript_engineering_automate.md\":\"eea8ab6f\",\"javascript_engineering_codestandard.md\":\"ec08f3a1\",\"javascript_engineering_webpack.md\":\"38a8aacc\",\"javascript_engineering_webpack4v5.md\":\"39abbd05\",\"javascript_engineering_webpacktov5.md\":\"64f65fa9\",\"javascript_engineering_index.md\":\"d793e4ad\",\"javascript_functional_closure.md\":\"8d40925e\",\"javascript_functional_combination.md\":\"f372e377\",\"javascript_functional_currying.md\":\"09bdc8a9\",\"javascript_functional_index.md\":\"ea1c2ff2\",\"javascript_functional_purefunction.md\":\"809fe82e\",\"javascript_htmlcss_flex.md\":\"d8cc8944\",\"javascript_htmlcss_grid.md\":\"d01bc941\",\"javascript_htmlcss_index.md\":\"ba7bcd70\",\"javascript_htmlcss_layout.md\":\"e63b501d\",\"javascript_htmlcss_randomrecord.md\":\"ab138635\",\"javascript_htmlcss_skill.md\":\"d73836f3\",\"javascript_jscore_arrayapi.md\":\"8660b7a2\",\"javascript_jscore_arraycode.md\":\"aa441515\",\"javascript_jscore_arrayflat.md\":\"20223a11\",\"javascript_jscore_arraylike.md\":\"3dbe8b8e\",\"javascript_jscore_arraysort.md\":\"81ea9825\",\"javascript_jscore_call.md\":\"841e789c\",\"javascript_jscore_closure.md\":\"a8652836\",\"javascript_jscore_copy.md\":\"937cd4b8\",\"javascript_jscore_inherit.md\":\"d71cf74f\",\"javascript_jscore_stringify.md\":\"6d39e8ca\",\"javascript_jscore_theorysort.md\":\"cb7faf48\",\"javascript_jscore_demo_demo.md\":\"e109acac\",\"javascript_jscore_index.md\":\"aef86ac3\",\"javascript_leetcode_array.md\":\"67957c24\",\"javascript_leetcode_index.md\":\"b02faee1\",\"javascript_module_two.md\":\"1bfe01c4\",\"javascript_module_index.md\":\"cf0f7615\",\"javascript_performance_check.md\":\"f50c8ff4\",\"javascript_performance_execute.md\":\"7cfe2fca\",\"javascript_performance_optimize.md\":\"b51b4a60\",\"javascript_performance_overall.md\":\"45db8cce\",\"javascript_performance_index.md\":\"067a3a53\",\"javascript_typescript_tooltype.md\":\"1c762a8a\",\"javascript_typescript_index.md\":\"fb7e505a\",\"javascript_websafety_transfer.md\":\"caf5fceb\",\"javascript_websafety_index.md\":\"f81208dd\",\"panclient_aigc_index.md\":\"de00c3b0\",\"panclient_electron_application.md\":\"2afd95ed\",\"panclient_electron_index.md\":\"fd4f5c65\",\"panclient_rn_architecture.md\":\"3188abb9\",\"panclient_rn_component.md\":\"a34bcf18\",\"panclient_rn_projectdemo.md\":\"12fb9873\",\"panclient_rn_randomrecord.md\":\"7a9ee67d\",\"panclient_rn_router_nav.md\":\"aee5a36c\",\"panclient_rn_setup.md\":\"9a7a3cde\",\"panclient_rn_stylesheet.md\":\"a9856958\",\"panclient_rn_index.md\":\"9a6400db\",\"panclient_uniapp_projectdemo.md\":\"f6d953f8\",\"panclient_uniapp_index.md\":\"1d8bdd1d\",\"programtopics_businessscene_experience.md\":\"deb8468b\",\"programtopics_businessscene_lazy.md\":\"6952fe29\",\"programtopics_businessscene_login.md\":\"77e6d5f3\",\"programtopics_businessscene_qrcode.md\":\"99dcfdbe\",\"programtopics_businessscene_refresh.md\":\"0b03e3b3\",\"programtopics_datavisualization_webcli.md\":\"7fb41eff\",\"programtopics_interviewbible_check.md\":\"1ecf54a6\",\"programtopics_interviewbible_index.md\":\"ddd5efe5\",\"programtopics_microfrontend_webcli.md\":\"2b5bbb16\",\"programtopics_serverless_webcli.md\":\"cd155e70\",\"programtopics_testautomation_webcli.md\":\"35e278e7\",\"readme.md\":\"fe146012\",\"sites.md\":\"aa681171\",\"index.md\":\"66cd71bf\",\"notes_git常用操作.md\":\"9c03a220\",\"notes_linux基本命令.md\":\"03d41373\",\"notes_nginx基本使用.md\":\"1277dd57\",\"notes_regexp介绍与使用.md\":\"1625acf3\",\"notes_vscode插件开发.md\":\"33fa3528\",\"notes_力扣题记录.md\":\"e4b7c5dc\",\"notes_小程序开发记录.md\":\"b7aef09b\",\"notes_常用快捷键.md\":\"5a76a506\",\"notes_排序算法.md\":\"4e17ef0c\",\"notes_收录精选书籍.md\":\"70d4d094\",\"notes_最佳实践.md\":\"79b44d77\",\"notes_网络相关知识.md\":\"97733756\",\"notes_面试软技能.md\":\"391d07a3\"}")</script>
    <script type="module" async src="/assets/app.8a7326df.js"></script>
    
  </body>
</html>