import{_ as s,c as a,o as n,a as l}from"./app.e428d0c7.js";const d=JSON.parse('{"title":"React Fiber","description":"","frontmatter":{},"headers":[{"level":2,"title":"1. \u5F00\u53D1\u73AF\u5883\u914D\u7F6E","slug":"_1-\u5F00\u53D1\u73AF\u5883\u914D\u7F6E","link":"#_1-\u5F00\u53D1\u73AF\u5883\u914D\u7F6E","children":[]},{"level":2,"title":"2. requestIdleCallback","slug":"_2-requestidlecallback","link":"#_2-requestidlecallback","children":[]},{"level":2,"title":"3 Fiber","slug":"_3-fiber","link":"#_3-fiber","children":[]}],"relativePath":"Framework/React/ReactFilber.md"}'),p={name:"Framework/React/ReactFilber.md"},o=l(`<h1 id="react-fiber" tabindex="-1">React Fiber <a class="header-anchor" href="#react-fiber" aria-hidden="true">#</a></h1><h2 id="_1-\u5F00\u53D1\u73AF\u5883\u914D\u7F6E" tabindex="-1">1. \u5F00\u53D1\u73AF\u5883\u914D\u7F6E <a class="header-anchor" href="#_1-\u5F00\u53D1\u73AF\u5883\u914D\u7F6E" aria-hidden="true">#</a></h2><h4 id="_1-1-\u6587\u4EF6\u5939\u7ED3\u6784" tabindex="-1">1.1 \u6587\u4EF6\u5939\u7ED3\u6784 <a class="header-anchor" href="#_1-1-\u6587\u4EF6\u5939\u7ED3\u6784" aria-hidden="true">#</a></h4><table><thead><tr><th>\u6587\u4EF6 / \u6587\u4EF6\u5939</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td>src</td><td>\u5B58\u50A8\u6E90\u6587\u4EF6</td></tr><tr><td>dist</td><td>\u5B58\u50A8\u5BA2\u6237\u7AEF\u4EE3\u7801\u6253\u5305\u6587\u4EF6</td></tr><tr><td>build</td><td>\u5B58\u50A8\u670D\u52A1\u7AEF\u4EE3\u7801\u6253\u5305\u6587\u4EF6</td></tr><tr><td>server.js</td><td>\u5B58\u50A8\u670D\u52A1\u5668\u7AEF\u4EE3\u7801</td></tr><tr><td>webpack.config.server.js</td><td>\u670D\u52A1\u7AEF webpack \u914D\u7F6E\u6587\u4EF6</td></tr><tr><td>webpack.config.client.js</td><td>\u5BA2\u6237\u7AEF webpack \u914D\u7F6E\u6587\u4EF6</td></tr><tr><td>babel.config.json</td><td>babel \u914D\u7F6E\u6587\u4EF6</td></tr><tr><td>package.json</td><td>\u9879\u76EE\u5DE5\u7A0B\u6587\u4EF6</td></tr></tbody></table><p>\u521B\u5EFA package.json \u6587\u4EF6\uFF1A<code>npm init -y</code></p><h4 id="_1-2-\u5B89\u88C5\u9879\u76EE\u4F9D\u8D56" tabindex="-1">1.2 \u5B89\u88C5\u9879\u76EE\u4F9D\u8D56 <a class="header-anchor" href="#_1-2-\u5B89\u88C5\u9879\u76EE\u4F9D\u8D56" aria-hidden="true">#</a></h4><p>\u5F00\u53D1\u4F9D\u8D56\uFF1A<code>npm install webpack webpack-cli webpack-node-externals @babel/core @babel/preset-env @babel/preset-react babel-loader nodemon npm-run-all -D</code></p><p>\u9879\u76EE\u4F9D\u8D56\uFF1A<code>npm install express</code></p><table><thead><tr><th>\u4F9D\u8D56\u9879</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td>webpack</td><td>\u6A21\u5757\u6253\u5305\u5DE5\u5177</td></tr><tr><td>webpack-cli</td><td>\u6253\u5305\u547D\u4EE4</td></tr><tr><td>webpack-node-externals</td><td>\u6253\u5305\u670D\u52A1\u5668\u7AEF\u6A21\u5757\u65F6\u5254\u9664 node_modules \u6587\u4EF6\u5939\u4E2D\u7684\u6A21\u5757</td></tr><tr><td>@babel/core</td><td>JavaScript \u4EE3\u7801\u8F6C\u6362\u5DE5\u5177</td></tr><tr><td>@babel/preset-env</td><td>babel \u9884\u7F6E\uFF0C\u8F6C\u6362\u9AD8\u7EA7 JavaScript \u8BED\u6CD5</td></tr><tr><td>@babel/preset-react</td><td>babel \u9884\u7F6E\uFF0C\u8F6C\u6362 JSX \u8BED\u6CD5</td></tr><tr><td>babel-loader</td><td>webpack \u4E2D\u7684 babel \u5DE5\u5177\u52A0\u8F7D\u5668</td></tr><tr><td>nodemon</td><td>\u76D1\u63A7\u670D\u52A1\u7AEF\u6587\u4EF6\u53D8\u5316\uFF0C\u91CD\u542F\u5E94\u7528</td></tr><tr><td>npm-run-all</td><td>\u547D\u4EE4\u884C\u5DE5\u5177\uFF0C\u53EF\u4EE5\u540C\u65F6\u6267\u884C\u591A\u4E2A\u547D\u4EE4</td></tr><tr><td>express</td><td>\u57FA\u4E8E node \u5E73\u53F0\u7684 web \u5F00\u53D1\u6846\u67B6</td></tr></tbody></table><h4 id="_1-3-\u73AF\u5883\u914D\u7F6E" tabindex="-1">1.3 \u73AF\u5883\u914D\u7F6E <a class="header-anchor" href="#_1-3-\u73AF\u5883\u914D\u7F6E" aria-hidden="true">#</a></h4><h5 id="_1-3-1-\u521B\u5EFA-web-\u670D\u52A1\u5668" tabindex="-1">1.3.1 \u521B\u5EFA web \u670D\u52A1\u5668 <a class="header-anchor" href="#_1-3-1-\u521B\u5EFA-web-\u670D\u52A1\u5668" aria-hidden="true">#</a></h5><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// server.js</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">express</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">express</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">app</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">express</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#BD976A;">app</span><span style="color:#666666;">.</span><span style="color:#80A665;">use</span><span style="color:#666666;">(</span><span style="color:#BD976A;">express</span><span style="color:#666666;">.</span><span style="color:#80A665;">static</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">dist</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">));</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">template</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">\`</span></span>
<span class="line"><span style="color:#C98A7D;">  &lt;html&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">    &lt;head&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">      &lt;title&gt;React Fiber&lt;/title&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">    &lt;/head&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">    &lt;body&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">      &lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">			&lt;script src=&quot;bundle.js&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">    &lt;/body&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">  &lt;/html&gt;</span></span>
<span class="line"><span style="color:#C98A7DAA;">\`</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#BD976A;">app</span><span style="color:#666666;">.</span><span style="color:#80A665;">get</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">*</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">req</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">res</span><span style="color:#666666;">.</span><span style="color:#80A665;">send</span><span style="color:#666666;">(</span><span style="color:#BD976A;">template</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#BD976A;">app</span><span style="color:#666666;">.</span><span style="color:#80A665;">listen</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">3000</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">server is running</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">));</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// server.js</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">express</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">express</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">app</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">express</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#B07D48;">app</span><span style="color:#999999;">.</span><span style="color:#59873A;">use</span><span style="color:#999999;">(</span><span style="color:#B07D48;">express</span><span style="color:#999999;">.</span><span style="color:#59873A;">static</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">dist</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">));</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">template</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">\`</span></span>
<span class="line"><span style="color:#B56959;">  &lt;html&gt;</span></span>
<span class="line"><span style="color:#B56959;">    &lt;head&gt;</span></span>
<span class="line"><span style="color:#B56959;">      &lt;title&gt;React Fiber&lt;/title&gt;</span></span>
<span class="line"><span style="color:#B56959;">    &lt;/head&gt;</span></span>
<span class="line"><span style="color:#B56959;">    &lt;body&gt;</span></span>
<span class="line"><span style="color:#B56959;">      &lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</span></span>
<span class="line"><span style="color:#B56959;">			&lt;script src=&quot;bundle.js&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span style="color:#B56959;">    &lt;/body&gt;</span></span>
<span class="line"><span style="color:#B56959;">  &lt;/html&gt;</span></span>
<span class="line"><span style="color:#B56959AA;">\`</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#B07D48;">app</span><span style="color:#999999;">.</span><span style="color:#59873A;">get</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">*</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">req</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">res</span><span style="color:#999999;">.</span><span style="color:#59873A;">send</span><span style="color:#999999;">(</span><span style="color:#B07D48;">template</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#B07D48;">app</span><span style="color:#999999;">.</span><span style="color:#59873A;">listen</span><span style="color:#999999;">(</span><span style="color:#2F798A;">3000</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">server is running</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">));</span></span>
<span class="line"></span></code></pre></div><h5 id="_1-3-2-\u670D\u52A1\u7AEF-webpack-\u914D\u7F6E" tabindex="-1">1.3.2 \u670D\u52A1\u7AEF webpack \u914D\u7F6E <a class="header-anchor" href="#_1-3-2-\u670D\u52A1\u7AEF-webpack-\u914D\u7F6E" aria-hidden="true">#</a></h5><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// webpack.config.server.js</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">path</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">require</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">path</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">nodeExternals</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">require</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">webpack-node-externals</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B8A965;">module</span><span style="color:#666666;">.</span><span style="color:#B8A965;">exports</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">target</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">node</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">mode</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">development</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">entry</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">./server.js</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">output</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">filename</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">server.js</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">path</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">path</span><span style="color:#666666;">.</span><span style="color:#80A665;">resolve</span><span style="color:#666666;">(</span><span style="color:#BD976A;">__dirname</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">build</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">),</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">module</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">rules</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">test</span><span style="color:#666666;">:</span><span style="color:#C4704F;"> </span><span style="color:#C98A7DAA;">/</span><span style="color:#E6CC77;">\\.</span><span style="color:#C4704F;">js</span><span style="color:#4D9375;">$</span><span style="color:#C98A7DAA;">/</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">exclude</span><span style="color:#666666;">:</span><span style="color:#C4704F;"> </span><span style="color:#C98A7DAA;">/</span><span style="color:#C4704F;">node_modules</span><span style="color:#C98A7DAA;">/</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">use</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">loader</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">babel-loader</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">],</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">externals</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#80A665;">nodeExternals</span><span style="color:#666666;">()],</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// webpack.config.server.js</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">path</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">require</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">path</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">nodeExternals</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">require</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">webpack-node-externals</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#998418;">module</span><span style="color:#999999;">.</span><span style="color:#998418;">exports</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">target</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">node</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">mode</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">development</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">entry</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">./server.js</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">output</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">filename</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">server.js</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">path</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">path</span><span style="color:#999999;">.</span><span style="color:#59873A;">resolve</span><span style="color:#999999;">(</span><span style="color:#B07D48;">__dirname</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">build</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">),</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">module</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">rules</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">test</span><span style="color:#999999;">:</span><span style="color:#AB5E3F;"> </span><span style="color:#B56959AA;">/</span><span style="color:#BDA437;">\\.</span><span style="color:#AB5E3F;">js</span><span style="color:#1E754F;">$</span><span style="color:#B56959AA;">/</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">exclude</span><span style="color:#999999;">:</span><span style="color:#AB5E3F;"> </span><span style="color:#B56959AA;">/</span><span style="color:#AB5E3F;">node_modules</span><span style="color:#B56959AA;">/</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">use</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">loader</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">babel-loader</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">],</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">externals</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#59873A;">nodeExternals</span><span style="color:#999999;">()],</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span></code></pre></div><h5 id="_1-3-3-babel-\u914D\u7F6E" tabindex="-1">1.3.3 babel \u914D\u7F6E <a class="header-anchor" href="#_1-3-3-babel-\u914D\u7F6E" aria-hidden="true">#</a></h5><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">presets</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;">: </span><span style="color:#666666;">[</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">@babel/preset-env</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">@babel/preset-react</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">presets</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;">: </span><span style="color:#999999;">[</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">@babel/preset-env</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">@babel/preset-react</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span></code></pre></div><h5 id="_1-3-4-\u5BA2\u6237\u7AEF-webpack-\u914D\u7F6E" tabindex="-1">1.3.4 \u5BA2\u6237\u7AEF webpack \u914D\u7F6E <a class="header-anchor" href="#_1-3-4-\u5BA2\u6237\u7AEF-webpack-\u914D\u7F6E" aria-hidden="true">#</a></h5><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">path</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">require</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">path</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B8A965;">module</span><span style="color:#666666;">.</span><span style="color:#B8A965;">exports</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">target</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">web</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">mode</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">development</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">entry</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">./src/index.js</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">output</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">filename</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">bundle.js</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">path</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">path</span><span style="color:#666666;">.</span><span style="color:#80A665;">resolve</span><span style="color:#666666;">(</span><span style="color:#BD976A;">__dirname</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">dist</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">),</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">devtool</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">source-map</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">module</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">rules</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">test</span><span style="color:#666666;">:</span><span style="color:#C4704F;"> </span><span style="color:#C98A7DAA;">/</span><span style="color:#E6CC77;">\\.</span><span style="color:#C4704F;">js</span><span style="color:#4D9375;">$</span><span style="color:#C98A7DAA;">/</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">exclude</span><span style="color:#666666;">:</span><span style="color:#C4704F;"> </span><span style="color:#C98A7DAA;">/</span><span style="color:#C4704F;">node_modules</span><span style="color:#C98A7DAA;">/</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#B8A965;">use</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#B8A965;">loader</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">babel-loader</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#666666;">],</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">path</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#59873A;">require</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">path</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#998418;">module</span><span style="color:#999999;">.</span><span style="color:#998418;">exports</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">target</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">web</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">mode</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">development</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">entry</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">./src/index.js</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">output</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">filename</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">bundle.js</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">path</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">path</span><span style="color:#999999;">.</span><span style="color:#59873A;">resolve</span><span style="color:#999999;">(</span><span style="color:#B07D48;">__dirname</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">dist</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">),</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">devtool</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">source-map</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">module</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">rules</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">test</span><span style="color:#999999;">:</span><span style="color:#AB5E3F;"> </span><span style="color:#B56959AA;">/</span><span style="color:#BDA437;">\\.</span><span style="color:#AB5E3F;">js</span><span style="color:#1E754F;">$</span><span style="color:#B56959AA;">/</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">exclude</span><span style="color:#999999;">:</span><span style="color:#AB5E3F;"> </span><span style="color:#B56959AA;">/</span><span style="color:#AB5E3F;">node_modules</span><span style="color:#B56959AA;">/</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#998418;">use</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#998418;">loader</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">babel-loader</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#999999;">],</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span></code></pre></div><h5 id="_1-3-5-\u542F\u52A8\u547D\u4EE4" tabindex="-1">1.3.5 \u542F\u52A8\u547D\u4EE4 <a class="header-anchor" href="#_1-3-5-\u542F\u52A8\u547D\u4EE4" aria-hidden="true">#</a></h5><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">scripts</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;">: </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">start</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">npm-run-all --parallel dev:*</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">dev:server-compile</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">webpack --config webpack.config.server.js --watch</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">dev:server</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">nodemon ./build/server.js</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965AA;">&quot;</span><span style="color:#B8A965;">dev:client-compile</span><span style="color:#B8A965AA;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">webpack --config webpack.config.client.js --watch</span><span style="color:#C98A7DAA;">&quot;</span></span>
<span class="line"><span style="color:#666666;">}</span><span style="color:#DBD7CAEE;">,</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">scripts</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;">: </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">start</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">npm-run-all --parallel dev:*</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">dev:server-compile</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">webpack --config webpack.config.server.js --watch</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">dev:server</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">nodemon ./build/server.js</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418AA;">&quot;</span><span style="color:#998418;">dev:client-compile</span><span style="color:#998418AA;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">webpack --config webpack.config.client.js --watch</span><span style="color:#B56959AA;">&quot;</span></span>
<span class="line"><span style="color:#999999;">}</span><span style="color:#393A34;">,</span></span>
<span class="line"></span></code></pre></div><h2 id="_2-requestidlecallback" tabindex="-1">2. requestIdleCallback <a class="header-anchor" href="#_2-requestidlecallback" aria-hidden="true">#</a></h2><h4 id="_2-1-\u6838\u5FC3-api-\u529F\u80FD\u4ECB\u7ECD" tabindex="-1">2.1 \u6838\u5FC3 API \u529F\u80FD\u4ECB\u7ECD <a class="header-anchor" href="#_2-1-\u6838\u5FC3-api-\u529F\u80FD\u4ECB\u7ECD" aria-hidden="true">#</a></h4><p>\u5229\u7528\u6D4F\u89C8\u5668\u7684\u7A7A\u4F59\u65F6\u95F4\u6267\u884C\u4EFB\u52A1\uFF0C\u5982\u679C\u6709\u66F4\u9AD8\u4F18\u5148\u7EA7\u7684\u4EFB\u52A1\u8981\u6267\u884C\u65F6\uFF0C\u5F53\u524D\u6267\u884C\u7684\u4EFB\u52A1\u53EF\u4EE5\u88AB\u7EC8\u6B62\uFF0C\u4F18\u5148\u6267\u884C\u9AD8\u7EA7\u522B\u4EFB\u52A1\u3002</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#80A665;">requestIdleCallback</span><span style="color:#666666;">(</span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">deadline</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#666666;">    </span><span style="color:#758575DD;">// deadline.timeRemaining() \u83B7\u53D6\u6D4F\u89C8\u5668\u7684\u7A7A\u4F59\u65F6\u95F4</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#59873A;">requestIdleCallback</span><span style="color:#999999;">(</span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">deadline</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#999999;">    </span><span style="color:#A0ADA0;">// deadline.timeRemaining() \u83B7\u53D6\u6D4F\u89C8\u5668\u7684\u7A7A\u4F59\u65F6\u95F4</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span></code></pre></div><h4 id="_2-2-\u6D4F\u89C8\u5668\u7A7A\u4F59\u65F6\u95F4" tabindex="-1">2.2 \u6D4F\u89C8\u5668\u7A7A\u4F59\u65F6\u95F4 <a class="header-anchor" href="#_2-2-\u6D4F\u89C8\u5668\u7A7A\u4F59\u65F6\u95F4" aria-hidden="true">#</a></h4><p>\u9875\u9762\u662F\u4E00\u5E27\u4E00\u5E27\u7ED8\u5236\u51FA\u6765\u7684\uFF0C\u5F53\u6BCF\u79D2\u7ED8\u5236\u7684\u5E27\u6570\u8FBE\u5230 60 \u65F6\uFF0C\u9875\u9762\u662F\u6D41\u7545\u7684\uFF0C\u5C0F\u4E8E\u8FD9\u4E2A\u503C\u65F6\uFF0C \u7528\u6237\u4F1A\u611F\u89C9\u5230\u5361\u987F</p><p>1s 60 \u5E27\uFF0C\u6BCF\u4E00\u5E27\u5206\u5230\u7684\u65F6\u95F4\u662F 1000/60 \u2248 16 ms\uFF0C\u5982\u679C\u6BCF\u4E00\u5E27\u6267\u884C\u7684\u65F6\u95F4\u5C0F\u4E8E 16ms\uFF0C\u5C31\u8BF4\u660E\u6D4F\u89C8\u5668\u6709\u7A7A\u4F59\u65F6\u95F4</p><p>\u5982\u679C\u4EFB\u52A1\u5728\u5269\u4F59\u7684\u65F6\u95F4\u5185\u6CA1\u6709\u5B8C\u6210\u5219\u4F1A\u505C\u6B62\u4EFB\u52A1\u6267\u884C\uFF0C\u7EE7\u7EED\u4F18\u5148\u6267\u884C\u4E3B\u4EFB\u52A1\uFF0C\u4E5F\u5C31\u662F\u8BF4 requestIdleCallback \u603B\u662F\u5229\u7528\u6D4F\u89C8\u5668\u7684\u7A7A\u4F59\u65F6\u95F4\u6267\u884C\u4EFB\u52A1</p><h4 id="_2-3-api-\u529F\u80FD\u4F53\u9A8C" tabindex="-1">2.3 API \u529F\u80FD\u4F53\u9A8C <a class="header-anchor" href="#_2-3-api-\u529F\u80FD\u4F53\u9A8C" aria-hidden="true">#</a></h4><p>\u9875\u9762\u4E2D\u6709\u4E24\u4E2A\u6309\u94AE\u548C\u4E00\u4E2A DIV\uFF0C\u70B9\u51FB\u7B2C\u4E00\u4E2A\u6309\u94AE\u6267\u884C\u4E00\u9879\u6602\u8D35\u7684\u8BA1\u7B97\uFF0C\u4F7F\u5176\u957F\u671F\u5360\u7528\u4E3B\u7EBF\u7A0B\uFF0C\u5F53\u8BA1\u7B97\u4EFB\u52A1\u6267\u884C\u7684\u65F6\u5019\u53BB\u70B9\u51FB\u7B2C\u4E8C\u4E2A\u6309\u94AE\u66F4\u6539\u9875\u9762\u4E2D DIV \u7684\u80CC\u666F\u989C\u8272\u3002</p><p>\u4F7F\u7528 requestIdleCallback \u5C31\u53EF\u4EE5\u5B8C\u7F8E\u89E3\u51B3\u8FD9\u4E2A\u5361\u987F\u95EE\u9898\u3002</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">div</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">class</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">playground</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">id</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">play</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">playground</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">div</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">button</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">id</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">work</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">start work</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">button</span><span style="color:#666666;">&gt;</span></span>
<span class="line"><span style="color:#666666;">&lt;</span><span style="color:#4D9375;">button</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">id</span><span style="color:#666666;">=</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#C98A7D;">interaction</span><span style="color:#C98A7DAA;">&quot;</span><span style="color:#666666;">&gt;</span><span style="color:#DBD7CAEE;">handle some user interaction</span><span style="color:#666666;">&lt;/</span><span style="color:#4D9375;">button</span><span style="color:#666666;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">div</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">class</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">playground</span><span style="color:#B56959AA;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">id</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">play</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">playground</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">div</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">button</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">id</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">work</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">start work</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">button</span><span style="color:#999999;">&gt;</span></span>
<span class="line"><span style="color:#999999;">&lt;</span><span style="color:#1E754F;">button</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">id</span><span style="color:#999999;">=</span><span style="color:#B56959AA;">&quot;</span><span style="color:#B56959;">interaction</span><span style="color:#B56959AA;">&quot;</span><span style="color:#999999;">&gt;</span><span style="color:#393A34;">handle some user interaction</span><span style="color:#999999;">&lt;/</span><span style="color:#1E754F;">button</span><span style="color:#999999;">&gt;</span></span>
<span class="line"></span></code></pre></div><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">&lt;</span><span style="color:#4D9375;">style</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">.</span><span style="color:#BD976A;">playground</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">background</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C99076;">palevioletred</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">padding</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">20</span><span style="color:#CB7676;">px</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">margin-bottom</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">10</span><span style="color:#CB7676;">px</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">&lt;/</span><span style="color:#4D9375;">style</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#393A34;">&lt;</span><span style="color:#1E754F;">style</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">.</span><span style="color:#B07D48;">playground</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">background</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">palevioletred</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">padding</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">20</span><span style="color:#AB5959;">px</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">margin-bottom</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">10</span><span style="color:#AB5959;">px</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">&lt;/</span><span style="color:#1E754F;">style</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"></span></code></pre></div><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#CB7676;">var</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">play</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">document</span><span style="color:#666666;">.</span><span style="color:#80A665;">getElementById</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">play</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#CB7676;">var</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">workBtn</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">document</span><span style="color:#666666;">.</span><span style="color:#80A665;">getElementById</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">work</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#CB7676;">var</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">interactionBtn</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">document</span><span style="color:#666666;">.</span><span style="color:#80A665;">getElementById</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">interaction</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#CB7676;">var</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">iterationCount</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">100000000</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#CB7676;">var</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">value</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">var</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">expensiveCalculation</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">IdleDeadline</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">while</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">iterationCount</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">&amp;&amp;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">IdleDeadline</span><span style="color:#666666;">.</span><span style="color:#80A665;">timeRemaining</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#BD976A;">value</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#BD976A;">Math</span><span style="color:#666666;">.</span><span style="color:#80A665;">random</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0.5</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">?</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">value</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Math</span><span style="color:#666666;">.</span><span style="color:#80A665;">random</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">value</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Math</span><span style="color:#666666;">.</span><span style="color:#80A665;">random</span><span style="color:#666666;">();</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#BD976A;">iterationCount</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">iterationCount</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">-</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">requestIdleCallback</span><span style="color:#666666;">(</span><span style="color:#BD976A;">expensiveCalculation</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BD976A;">workBtn</span><span style="color:#666666;">.</span><span style="color:#80A665;">addEventListener</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">click</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">requestIdleCallback</span><span style="color:#666666;">(</span><span style="color:#BD976A;">expensiveCalculation</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BD976A;">interactionBtn</span><span style="color:#666666;">.</span><span style="color:#80A665;">addEventListener</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">click</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">play</span><span style="color:#666666;">.</span><span style="color:#BD976A;">style</span><span style="color:#666666;">.</span><span style="color:#BD976A;">background</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">palegreen</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#AB5959;">var</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">play</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">document</span><span style="color:#999999;">.</span><span style="color:#59873A;">getElementById</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">play</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#AB5959;">var</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">workBtn</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">document</span><span style="color:#999999;">.</span><span style="color:#59873A;">getElementById</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">work</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#AB5959;">var</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">interactionBtn</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">document</span><span style="color:#999999;">.</span><span style="color:#59873A;">getElementById</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">interaction</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#AB5959;">var</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">iterationCount</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">100000000</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#AB5959;">var</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">value</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">var</span><span style="color:#393A34;"> </span><span style="color:#59873A;">expensiveCalculation</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">IdleDeadline</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">while</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">iterationCount</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&amp;&amp;</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">IdleDeadline</span><span style="color:#999999;">.</span><span style="color:#59873A;">timeRemaining</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B07D48;">value</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#B07D48;">Math</span><span style="color:#999999;">.</span><span style="color:#59873A;">random</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0.5</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">?</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">value</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Math</span><span style="color:#999999;">.</span><span style="color:#59873A;">random</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">value</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Math</span><span style="color:#999999;">.</span><span style="color:#59873A;">random</span><span style="color:#999999;">();</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B07D48;">iterationCount</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">iterationCount</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">-</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">requestIdleCallback</span><span style="color:#999999;">(</span><span style="color:#B07D48;">expensiveCalculation</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B07D48;">workBtn</span><span style="color:#999999;">.</span><span style="color:#59873A;">addEventListener</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">click</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">requestIdleCallback</span><span style="color:#999999;">(</span><span style="color:#B07D48;">expensiveCalculation</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B07D48;">interactionBtn</span><span style="color:#999999;">.</span><span style="color:#59873A;">addEventListener</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">click</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">play</span><span style="color:#999999;">.</span><span style="color:#B07D48;">style</span><span style="color:#999999;">.</span><span style="color:#B07D48;">background</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">palegreen</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span></code></pre></div><h2 id="_3-fiber" tabindex="-1">3 Fiber <a class="header-anchor" href="#_3-fiber" aria-hidden="true">#</a></h2><h4 id="_3-1-\u95EE\u9898" tabindex="-1">3.1 \u95EE\u9898 <a class="header-anchor" href="#_3-1-\u95EE\u9898" aria-hidden="true">#</a></h4><p>React 16 \u4E4B\u524D\u7684\u7248\u672C\u6BD4\u5BF9\u66F4\u65B0 VirtualDOM \u7684\u8FC7\u7A0B\u662F\u91C7\u7528\u5FAA\u73AF\u52A0\u9012\u5F52\u5B9E\u73B0\u7684\uFF0C\u8FD9\u79CD\u6BD4\u5BF9\u65B9\u5F0F\u6709\u4E00\u4E2A\u95EE\u9898\uFF0C\u5C31\u662F\u4E00\u65E6\u4EFB\u52A1\u5F00\u59CB\u8FDB\u884C\u5C31\u65E0\u6CD5\u4E2D\u65AD\uFF0C\u5982\u679C\u5E94\u7528\u4E2D\u7EC4\u4EF6\u6570\u91CF\u5E9E\u5927\uFF0C\u4E3B\u7EBF\u7A0B\u88AB\u957F\u671F\u5360\u7528\uFF0C\u76F4\u5230\u6574\u68F5 VirtualDOM \u6811\u6BD4\u5BF9\u66F4\u65B0\u5B8C\u6210\u4E4B\u540E\u4E3B\u7EBF\u7A0B\u624D\u80FD\u88AB\u91CA\u653E\uFF0C\u4E3B\u7EBF\u7A0B\u624D\u80FD\u6267\u884C\u5176\u4ED6\u4EFB\u52A1\u3002\u8FD9\u5C31\u4F1A\u5BFC\u81F4\u4E00\u4E9B\u7528\u6237\u4EA4\u4E92\uFF0C\u52A8\u753B\u7B49\u4EFB\u52A1\u65E0\u6CD5\u7ACB\u5373\u5F97\u5230\u6267\u884C\uFF0C\u9875\u9762\u5C31\u4F1A\u4EA7\u751F\u5361\u987F, \u975E\u5E38\u7684\u5F71\u54CD\u7528\u6237\u4F53\u9A8C\u3002</p><p>\u6838\u5FC3\u95EE\u9898\uFF1A\u9012\u5F52\u65E0\u6CD5\u4E2D\u65AD\uFF0C\u6267\u884C\u91CD\u4EFB\u52A1\u8017\u65F6\u957F\u3002 JavaScript \u53C8\u662F\u5355\u7EBF\u7A0B\uFF0C\u65E0\u6CD5\u540C\u65F6\u6267\u884C\u5176\u4ED6\u4EFB\u52A1\uFF0C\u5BFC\u81F4\u4EFB\u52A1\u5EF6\u8FDF\u9875\u9762\u5361\u987F\uFF0C\u7528\u6237\u4F53\u9A8C\u5DEE\u3002</p><h4 id="_3-2-\u89E3\u51B3\u65B9\u6848" tabindex="-1">3.2 \u89E3\u51B3\u65B9\u6848 <a class="header-anchor" href="#_3-2-\u89E3\u51B3\u65B9\u6848" aria-hidden="true">#</a></h4><ol><li>\u5229\u7528\u6D4F\u89C8\u5668\u7A7A\u95F2\u65F6\u95F4\u6267\u884C\u4EFB\u52A1\uFF0C\u62D2\u7EDD\u957F\u65F6\u95F4\u5360\u7528\u4E3B\u7EBF\u7A0B</li><li>\u653E\u5F03\u9012\u5F52\u53EA\u91C7\u7528\u5FAA\u73AF\uFF0C\u56E0\u4E3A\u5FAA\u73AF\u53EF\u4EE5\u88AB\u4E2D\u65AD</li><li>\u4EFB\u52A1\u62C6\u5206\uFF0C\u5C06\u4EFB\u52A1\u62C6\u5206\u6210\u4E00\u4E2A\u4E2A\u7684\u5C0F\u4EFB\u52A1</li></ol><h4 id="_3-3-\u5B9E\u73B0\u601D\u8DEF" tabindex="-1">3.3 \u5B9E\u73B0\u601D\u8DEF <a class="header-anchor" href="#_3-3-\u5B9E\u73B0\u601D\u8DEF" aria-hidden="true">#</a></h4><p>\u5728 Fiber \u65B9\u6848\u4E2D\uFF0C\u4E3A\u4E86\u5B9E\u73B0\u4EFB\u52A1\u7684\u7EC8\u6B62\u518D\u7EE7\u7EED\uFF0CDOM \u6BD4\u5BF9\u7B97\u6CD5\u88AB\u5206\u6210\u4E86\u4E24\u90E8\u5206\uFF1A</p><ol><li>\u6784\u5EFA Fiber (\u53EF\u4E2D\u65AD)</li><li>\u63D0\u4EA4 Commit (\u4E0D\u53EF\u4E2D\u65AD)</li></ol><p>DOM \u521D\u59CB\u6E32\u67D3: virtualDOM -&gt; Fiber -&gt; Fiber[] -&gt; DOM</p><p>DOM \u66F4\u65B0\u64CD\u4F5C: newFiber vs oldFiber -&gt; Fiber[] -&gt; DOM</p><h4 id="_3-4-fiber-\u5BF9\u8C61" tabindex="-1">3.4 Fiber \u5BF9\u8C61 <a class="header-anchor" href="#_3-4-fiber-\u5BF9\u8C61" aria-hidden="true">#</a></h4><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">{</span></span>
<span class="line"><span style="color:#dbd7caee;">  type         \u8282\u70B9\u7C7B\u578B (\u5143\u7D20, \u6587\u672C, \u7EC4\u4EF6)(\u5177\u4F53\u7684\u7C7B\u578B)</span></span>
<span class="line"><span style="color:#dbd7caee;">  props        \u8282\u70B9\u5C5E\u6027</span></span>
<span class="line"><span style="color:#dbd7caee;">  stateNode    \u8282\u70B9 DOM \u5BF9\u8C61 | \u7EC4\u4EF6\u5B9E\u4F8B\u5BF9\u8C61</span></span>
<span class="line"><span style="color:#dbd7caee;">  tag          \u8282\u70B9\u6807\u8BB0 (\u5BF9\u5177\u4F53\u7C7B\u578B\u7684\u5206\u7C7B hostRoot || hostComponent || classComponent || functionComponent)</span></span>
<span class="line"><span style="color:#dbd7caee;">  effects      \u6570\u7EC4, \u5B58\u50A8\u9700\u8981\u66F4\u6539\u7684 fiber \u5BF9\u8C61</span></span>
<span class="line"><span style="color:#dbd7caee;">  effectTag    \u5F53\u524D Fiber \u8981\u88AB\u6267\u884C\u7684\u64CD\u4F5C (\u65B0\u589E, \u5220\u9664, \u4FEE\u6539)</span></span>
<span class="line"><span style="color:#dbd7caee;">  parent       \u5F53\u524D Fiber \u7684\u7236\u7EA7 Fiber</span></span>
<span class="line"><span style="color:#dbd7caee;">  child        \u5F53\u524D Fiber \u7684\u5B50\u7EA7 Fiber</span></span>
<span class="line"><span style="color:#dbd7caee;">  sibling      \u5F53\u524D Fiber \u7684\u4E0B\u4E00\u4E2A\u5144\u5F1F Fiber</span></span>
<span class="line"><span style="color:#dbd7caee;">  alternate    Fiber \u5907\u4EFD fiber \u6BD4\u5BF9\u65F6\u4F7F\u7528</span></span>
<span class="line"><span style="color:#dbd7caee;">}</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#393a34;">{</span></span>
<span class="line"><span style="color:#393a34;">  type         \u8282\u70B9\u7C7B\u578B (\u5143\u7D20, \u6587\u672C, \u7EC4\u4EF6)(\u5177\u4F53\u7684\u7C7B\u578B)</span></span>
<span class="line"><span style="color:#393a34;">  props        \u8282\u70B9\u5C5E\u6027</span></span>
<span class="line"><span style="color:#393a34;">  stateNode    \u8282\u70B9 DOM \u5BF9\u8C61 | \u7EC4\u4EF6\u5B9E\u4F8B\u5BF9\u8C61</span></span>
<span class="line"><span style="color:#393a34;">  tag          \u8282\u70B9\u6807\u8BB0 (\u5BF9\u5177\u4F53\u7C7B\u578B\u7684\u5206\u7C7B hostRoot || hostComponent || classComponent || functionComponent)</span></span>
<span class="line"><span style="color:#393a34;">  effects      \u6570\u7EC4, \u5B58\u50A8\u9700\u8981\u66F4\u6539\u7684 fiber \u5BF9\u8C61</span></span>
<span class="line"><span style="color:#393a34;">  effectTag    \u5F53\u524D Fiber \u8981\u88AB\u6267\u884C\u7684\u64CD\u4F5C (\u65B0\u589E, \u5220\u9664, \u4FEE\u6539)</span></span>
<span class="line"><span style="color:#393a34;">  parent       \u5F53\u524D Fiber \u7684\u7236\u7EA7 Fiber</span></span>
<span class="line"><span style="color:#393a34;">  child        \u5F53\u524D Fiber \u7684\u5B50\u7EA7 Fiber</span></span>
<span class="line"><span style="color:#393a34;">  sibling      \u5F53\u524D Fiber \u7684\u4E0B\u4E00\u4E2A\u5144\u5F1F Fiber</span></span>
<span class="line"><span style="color:#393a34;">  alternate    Fiber \u5907\u4EFD fiber \u6BD4\u5BF9\u65F6\u4F7F\u7528</span></span>
<span class="line"><span style="color:#393a34;">}</span></span>
<span class="line"><span style="color:#393a34;"></span></span></code></pre></div><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0914cb8035214f16b8450f32e581f8cc~tplv-k3u1fbpfcp-watermark.image?" alt="3.png"></p>`,48),e=[o];function t(c,r,y,A,i,D){return n(),a("div",null,e)}const C=s(p,[["render",t]]);export{d as __pageData,C as default};
